!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.base=t():e.base=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=43)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ON_BLE_EVENT_NAME",function(){return r}),n.d(t,"BLE_RET",function(){return a}),n.d(t,"FRAME_TYPE",function(){return i}),n.d(t,"DEVICE_TYPE",function(){return o}),n.d(t,"MUSIC_TYPE",function(){return s}),n.d(t,"LightMode",function(){return c}),n.d(t,"OPERATION_TYPE",function(){return u});var r={ADAPTER_OPEN_CHANGED:"__onBluetoothAdapterStateChangeCallback",CONNECTION_CHANGED:"__onBLEConnectionStateChangeCallback",DEVICE_DISCOVERY:"__onBluetoothDeviceFoundCallback",CHARACTERISTIC_VALUE_CHANGED:"__onCharacteristicValueChangeCallback",POST_MSG_CALLBACK:"__postMsgHandlerCallback"},a={Boolean:{True:1,False:0},status:{suc:0,fail:1,timeout:9009,cancel:9010},bleStatus:{available:0,close:1,unauthorized:2,unsupported:3,uninitialized:4},platform:{android:0,ios:1},connection:{connected:!0,disconnected:!1}},i={ACK:0,POST:1,Request:2,Response:3};t.default={ON_BLE_EVENT_NAME:r,BLE_RET:a,DEVICE_TYPE:o};var o={DEVICE_TYPE_RESTON_Z1:1,DEVICE_TYPE_RESTON_Z2:9,DEVICE_TYPE_RESONT_Z400:19,DEVICE_TYPE_RESTON_Z400T:22,DEVICE_TYPE_RESONT_Z4TWB:26,DEVICE_TYPE_RESONT_Z4TWP:27,DEVICE_TYPE_RESONT_Z4TWP2:37,DEVICE_TYPE_RESTON_Z300:4,DEVICE_TYPE_BINOTONE:33,DEVICE_TYPE_P300:34,DEVICE_TYPE_PILLOW:3,DEVICE_TYPE_GP300:36,DEVICE_TYPE_BLE_BRIGE:35,BRIGE:50,DEVICE_TYPE_NOX_SA1001:23,DEVICE_TYPE_NOX_SA1001_2:24,NOX_SA1001_5:55,DEVICE_TYPE_NOX_SA1001_4:25,DEVICE_TYPE_EW201W:30,DEVICE_TYPE_EW201B:29,DEVICE_TYPE_EW202W:53,DEVICE_TYPE_SN913:40,DEVICE_TYPE_SN913A:41,DEVICE_TYPE_BLE_BINOTONE:42,DEVICE_TYPE_SN913E:44,DEVICE_TYPE_SN923A:45,DEVICE_TYPE_NOX_2W:12,DEVICE_TYPE_NOX_2B:11,DEVICE_TYPE_SLEEPDOT_502T:17,DEVICE_TYPE_SLEEPDOT_502:16,DEVICE_TYPE_SLEEPDOT:10,DEVICE_TYPE_NOX_PRO:2,DEVICE_TYPE_M800:38,DEVICE_TYPE_P200A:46,ZP100:20482,PHP100:20487,DEVICE_TYPE_Z400T2:47,DEVICE_TYPE_M871W:52,DEVICE_TYPE_BM8701:32777,DEVICE_TYPE_BM8701_2:49,DEVICE_TYPE_EB100:20485,DEVICE_TYPE_Z400TWP3:20489,DEVICE_TYPE_P401M:20490,DEVICE_TYPE_P102T:20491},s={INVALID:255,LOCAL:0,OUTSITE:1,XMLY_ALBUM:2,XMLY_SIGLE:3,SLEEPACE_ALBUM:4,SLEEPACE_SINGLE:5,CUSTOMIZEDXMLY_ALBUM:6,CUSTOMIZED_LOCAL_ALBUM:7},c={White:0,Color:1,Fixed_stream:2},u={GET:0,SET:1}},function(e,t,n){"use strict";function r(e,t){if(t){var n=e.toArray().findIndex(function(e){return 0===e});e=e.slice(0,n)}return String.fromCharCode.apply(null,new Uint8Array(e))}function a(e){var t=r(e);return JSON.parse(JSON.stringify(t).replace(/\\u\d{4}/g,""))}function i(e){for(var t=new ArrayBuffer(e.length),n=new Int8Array(t),r=0,a=e.length;r<a;r++)n[r]=e.charCodeAt(r);return t}function o(e,t){var n=[];if(!e||!e instanceof ArrayBuffer||e.byteLength<1)return n;for(var r=new DataView(e),a=0;a<r.byteLength;a++)n.push(r[t?"getUint8":"getInt8"](a));return n}function s(e){for(var t=new ArrayBuffer(e.length),n=new DataView(t),r=0;r<e.length;r++)n.setInt8(r,e[r]);return n.buffer}function c(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function u(e){for(var t=new DataView(e),n="",r=0;r<t.byteLength;r++){var a=t.getUint8(r);a=a.toString(16),a.length<2&&(a="0"+a),n=n.concat([a])}return n}function f(e){var t="";if(!(t=e)||t.length<2||t.length%2!=0)return new ArrayBuffer(0);for(var n=new DataView(new ArrayBuffer(t.length/2)),r=0,a=0;a<t.length;a+=2){var e=(t.substr(a,2),parseInt(t.substr(a,2),16));n.setUint8(r,e),r++}return n.buffer}function l(e,t){for(var n=[],r=0;r<e.byteLength;r++)n[r]=e.getUint8(r);var a=t?t+":":"notip:";console.log("logMsg "+a+"["+n+"] bytelen: "+e.byteLength)}function p(){for(var e="",t=0;t<arguments.length;t++)0!==t&&(e+="_"),e+=arguments[t];return e}function d(e,t){var n=[],r=o(e);if(r.length>=t.length){for(var a=0,i=0;i<r.length;i++)if(i>2)if(g(r,i,t)){var c=r.slice(a,i-1);n.push(s(c)),a=i-1,i===r.length-1&&n.push(s(r.slice(a)))}else i===r.length-1&&n.push(s(r.slice(a)))}else n.push(e);return n}function g(e,t,n){return e[t]===n[3]&&e[t-1]===n[2]&&e[t-2]===n[1]&&e[t-3]===n[0]}Object.defineProperty(t,"__esModule",{value:!0}),String.prototype.endwith=function(e){return!(null==e||""==e||0==this.length||e.length>this.length)&&this.substring(this.length-e.length)==e},String.prototype.startwith=function(e){return!(null==e||""==e||0==this.length||e.length>this.length)&&this.substr(0,e.length)==e},Array.prototype.removeItem=function(e){if(e)for(var t=this.length,n=0;n<t;n++){var r=this[n];if(r===e){this.splice(n,1);break}}},Array.prototype.triggerEach=function(e){for(var t=this.length,n=0;n<t;n++){var r=this[n];e&&e(r)}};var h=function(e){for(var t=Array.prototype.map.call(new Uint8Array(e),function(e){return e}),n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n},y=function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)}).join("")};ArrayBuffer.prototype.split=function(e){for(var t=this,n=t.byteLength,r=Math.floor(n/e)+1,a=n%e,i=[],o=0,s=0;s<r;s++){var c=o*e,u=0;u=o+1>=r?c+a:c+e,o++;var f=t.slice(c,u);f.byteLength>0&&i.push(f)}return i},ArrayBuffer.prototype.append=function(e){if(!e||0==e.byteLength)return this;if(0==this.byteLength)return e;for(var t=new DataView(new ArrayBuffer(this.byteLength+e.byteLength)),n=new DataView(this),r=new DataView(e),a=0;a<t.byteLength;a++)a<this.byteLength?t.setInt8(a,n.getInt8(a)):t.setInt8(a,r.getInt8(a-n.byteLength));return t.buffer},ArrayBuffer.prototype.mergeBuffer=function(){for(var e=this.toArray(),t=[],n=0;n<arguments.length;n++)t.push(arguments[n].toArray());return e=e.concat.apply(e,t),this.fromArray(e)},ArrayBuffer.prototype.toArray=function(e){return o(this,e)},ArrayBuffer.prototype.fromArray=function(e){return s(e)},DataView.prototype.position=0,DataView.prototype.next=function(e){e?this.position+=e:this.position++},DataView.prototype.set1x=function(e){return this.setInt8(this.position,e),this.position++,this},DataView.prototype.set2x=function(e){return this.setInt16(this.position,e),this.position+=2,this},DataView.prototype.set4x=function(e){return this.setInt32(this.position,e),this.position+=4,this},DataView.prototype.set8x=function(e){return this.setInt32(this.position,0),this.position+=4,this.setUint32(this.position,e),this.position+=4,this},DataView.prototype.setStr=function(e,t,n){for(var r=this.position,a=0;a<e.length;a++){var i=e.charCodeAt(a);if(i<0||i>127)for(var o=encodeURI(e[a]),s=o.split("%"),c=0;c<s.length;c++)""!=s[c]&&this.set1x(parseInt(s[c],16));else this.set1x(i)}var u=this.position-r;if(t&&t>u){var f=t-u;for(a=0;a<f;a++)this.set1x(0)}return this},DataView.NO_SIGNED=1,DataView.prototype.get1x=function(e){var t=e===DataView.NO_SIGNED?this.getUint8(this.position):this.getInt8(this.position);return this.position+=1,t},DataView.prototype.get2x=function(e){var t=e===DataView.NO_SIGNED?this.getUint16(this.position):this.getInt16(this.position);return this.position+=2,t},DataView.prototype.get4x=function(e){var t=e===DataView.NO_SIGNED?this.getUint32(this.position):this.getInt32(this.position);return this.position+=4,t},DataView.prototype.get8x=function(e){var t=e===DataView.NO_SIGNED?this.getUint32(this.position+4):this.getInt32(this.position+4);return this.position+=8,t},DataView.prototype.getStr=function(e,t){for(var n,r=this.buffer.slice(this.position,this.position+e),a=new DataView(r),i=a.byteLength-1;i>=0;i--)if(0!=a.getInt8(i)){n=i+1;break}var o=r.slice(0,n);if(!t){var s=String.fromCharCode.apply(null,new Uint8Array(o));return this.position+=e,s}var c=1,u=t.toLowerCase().replace("-","");"gbk"==u?c=2:"utf8"==u&&(c=3);var f=new DataView(o);if(2==c){for(var l="",i=0;i<f.byteLength;i++){var p=f.getUint8(i),d="";d=p<0||p>=127?String.fromCharCode(f.get2x()):String.fromCharCode(f.get1x()),l+=d}return l}if(3==c){for(var g="",i=0;i<f.byteLength;i++){var p=f.getUint8(i),d="";d=p<0||p>=127?"%"+p.toString(16):String.fromCharCode(p),g+=d}return decodeURI(g)}},t.default={str2ab:i,ab2str:r,ab2string:a,buf2hex:y,buf2string:h,hashCode:c,buffer2Arr:o,arr2Buffer:s,hex2buffer:f,buffer2hex:u,logMsg:l,buildKey:p,splitBufferBySeparator:d}},function(e,t,n){"use strict";function r(e,t){i.setLogConfig(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"log",function(){return i}),t.setLogConfig=r;var a=n(19),i=new a.a({all:!1,remoteAll:!1},{log:{local:!1,remote:{available:!1,url:"ws://192.168.197.100:6010"}}})},function(e,t,n){"use strict";var r={RET:{Succeed:0,Network_Disable:1,Socket_Disconnect:2,Failed:3,Timeout:255},NetWorkStatus:{None:0,WWAN:1,Wifi:2},socketState:{connected:0,disconnect:1},FrameType:{ACK:0,POST:1,Request:2,Response:3},ProResCode:{OK:0,SERVER_ERROR:1,LOGIN_OUT:2,NOT_BOUND:3,SENSOR_NOT_BOUND:4,SENSOR_IS_BOUND:5,NOT_ONLINE:6,APP_ONT_ONLINE:7,SERSOR_NOT_ONLINE:8,NOT_FOUND:9,NO_ACCESS:10,OPERATION_FAIL:11,SENSOR_NOT_FOUND:12,SENSOR_CONN_FAIL:13,BLE_BUSY:14,UPDATING:15,ERROR:255},timeout:1e4,separator:[36,95,64,45],specialId:5e4};t.a=r},function(e,t,n){"use strict";function r(e,t){var n=t-e,r=Math.random();return e+Math.round(r*n)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e=e.toString(),e.length<t&&(e=new Array(t-e.length+1).join(n)+e),e}function i(e){return e.replace(/[^\u4e00-\u9fa5\w]/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.randomNum=r,t.padStart=a,t.rtrim=i},function(e,t,n){"use strict";function r(e){e&&(this.socketClient=e,this.protocol=new f.b,e.setProtocol(this.protocol))}function a(e,t){for(var n=0;n<e.length;n++){var r=e[n];switch(r.musicType){case c.MUSIC_TYPE.LOCAL:t.set2x(r.musicId);break;case c.MUSIC_TYPE.XMLY_ALBUM:case c.MUSIC_TYPE.XMLY_SIGLE:case c.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case c.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t.set4x(r.musicId)}}return t.buffer}Object.defineProperty(t,"__esModule",{value:!0}),t.SocketClientApi2=r;var i=n(2),o=n(3),s=n(1),c=n(0),u=n(9),f=n(10),l=n(4),p="tcp-common-api-2";r.prototype.TCP_Consts=o.a,r.prototype.callback=function(e,t){i.log.i(p,"通用监听",JSON.stringify(e.toArray()),"o:",JSON.stringify(t))},r.prototype.getIP=function(e){try{i.log.i(p,"getIP-start",e),e.frameType=o.a.FrameType.Request,e.msgType=1028,e.subVersion=0;var t=new DataView(new ArrayBuffer(15));t.set1x(1).setStr(e.deviceId,14),this.sendMsg(e,t.buffer,function(t,n,r){if(i.log.i(p,"get ip back-----",t,n,r),t===o.a.RET.Succeed){var a=n.get1x(DataView.NO_SIGNED),s=n.get1x(DataView.NO_SIGNED),c=n.get1x(DataView.NO_SIGNED),u=n.get1x(DataView.NO_SIGNED),f=a+"."+s+"."+c+"."+u,l=n.get2x(DataView.NO_SIGNED);e.handler(t,{ip:f,port:l})}else e.handler(t,{})})}catch(e){i.log.i(p,"getIP",e)}},r.prototype.syncTime=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=513,e.subVersion=0;var t=new Date,n=e.timestamp,r=void 0===n?(t.valueOf()/1e3).toFixed(0)-0:n,a=e.timeOffset,s=void 0===a?-60*t.getTimezoneOffset():a,c=e.season,u=e.seasonOffset,f=e.timeMode,l=new ArrayBuffer(14),d=new DataView(l);d.set4x(r).set4x(s).set1x(c).set4x(u).set1x(f),e.content=d.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"syncTime",e)}},r.prototype.syncLang=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=515,e.subVersion=0;var t=new ArrayBuffer(16),n=new DataView(t);n.setStr(e.lang,16),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"syncLang",e)}},r.prototype.getSystemInfo=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=514,e.subVersion=0;var t=new ArrayBuffer(16),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=void 0,i=void 0,c=void 0,u=void 0,f=void 0,l=void 0;a=s.default.ab2string(n.buffer.slice(2,16)),n.position=16,i=n.get2x(1),c=n.get2x(1),u=n.get2x(1),f=n.get4x(1),l=n.get2x(1),e.handler&&e.handler(t,{deviceId:a,deviceType:i,currVersion:c,facVersion:u,facTime:f,manufacCode:l})}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getSystemInfo",e)}},r.prototype.getDeviceInfo=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=518,e.subVersion=0;var t=new ArrayBuffer(16),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=void 0,i=void 0,c=void 0,u=void 0,f=void 0,l=void 0,p=void 0,d=void 0,g=void 0;a=s.default.ab2string(n.buffer.slice(2,16)),i=s.default.ab2string(n.buffer.slice(16,30)),n.position=30,c=n.get2x(1),u=n.get2x(1),f=n.get2x(1),l=n.get4x(1),p=n.get2x(1),d=n.get2x(1),g=n.get2x(1),e.handler&&e.handler(t,{deviceName:a,deviceId:i,deviceType:c,currVersion:u,facVersion:f,facTime:l,manufacCode:p,coopCode:d,pcbVersion:g})}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getSystemInfo",e)}},r.prototype.getDeviceOnlineStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1025,e.subVersion=0;for(var t=new ArrayBuffer(16),n=new DataView(t),r=s.default.str2ab(e.deviceId),a=new DataView(r),c=0;c<14;c++)c<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.deviceType),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=u.a.onlineStatusParse(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getDeviceCollectStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1026,e.subVersion=null==e.subVersion?0:e.subVersion;for(var t=e.target||{deviceId:e.deviceId,deviceType:e.deviceType},n=new ArrayBuffer(16),r=new DataView(n),a=s.default.str2ab(t.deviceId),c=new DataView(a),f=0;f<14;f++)f<a.byteLength?r.set1x(c.get1x()):r.set1x(0);r.set2x(t.deviceType),e.content=r.buffer.slice(0,r.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=u.a.collectStatusParse(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getWorkMode=function(e){e.frameType=o.a.FrameType.Request,e.msgType=1044,e.subVersion=1,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=u.a.workModeParse(n,e.deviceType);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.getPower=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1027,e.subVersion=0;for(var t=new ArrayBuffer(14),n=new DataView(t),r=s.default.str2ab(e.deviceId),a=new DataView(r),c=0;c<14;c++)c<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=s.default.ab2str(c.buffer.slice(0,13)),a.chargeStatus=n.get1x(),a.battery=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getSleepAidStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1029,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a={};a.sleepAidStatus=n.get1x(),a.sleepAidLeave=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getBleDeviceList=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1030,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a=[],i=n.get1x(),c=0;c<i;c++){var u={};u.macAddress=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),u.RSSI=n.get1x(),u.blueDeviceNameLenght=n.get1x();for(var f=new ArrayBuffer(20),l=new DataView(f),p=0;p<20;p++)l.set1x(n.get1x());u.deviceName=s.default.ab2str(l.buffer.slice(0,u.blueDeviceNameLenght)),u.selfBroadcastLenght=n.get1x(),u.selfBroadcastContent=[];for(var d=0;d<30;d++)u.selfBroadcastContent.push(n.get1x());a.push(u)}e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getAlarmStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1033,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a={};a.alarmStatus=n.get1x(),a.alarmId=n.get8x(),a.lazyStatus=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getWifiInfo=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1042,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(33),c=new DataView(i),u=0;u<33;u++)c.set1x(n.get1x());a.apName=s.default.ab2str(deviceIdDv.buffer),a.encrypType=n.get1x();for(var f=new ArrayBuffer(65),p=new DataView(f),d=0;d<65;d++)p.set1x(n.get1x());a.plainPassword=s.default.ab2str(p.buffer),a.ipType=n.get1x(),a.mask=n.get4x(),a.gateWay=n.get4x(),a.dns1=n.get4x(),a.dns2=n.get4x(),a.macAddress=[n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1)].map(function(e){return Object(l.padStart)(e.toString(16))}).join(":"),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.getHistoryDataTime=function(e){e.frameType=o.a.FrameType.Request,e.msgType=4609,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.setStr(e.deviceId,14),n.set4x(e.userId),e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=u.a.parseHistoryDataTime(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.getTemperatureAndHumidity=function(e){e.frameType=o.a.FrameType.Request,e.msgType=4611,e.subVersion=null==e.subVersion?0:e.subVersion;var t=e.target||{deviceId:e.deviceId,deviceType:e.deviceType},n=new ArrayBuffer(16),r=new DataView(n);r.setStr(t.deviceId,14),r.set2x(t.deviceType),e.content=n,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=u.a.parseTemperatureAndHumidity(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.connectBleDevice=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1872,e.subVersion=0;for(var t=new ArrayBuffer(17),n=new DataView(t),r=s.default.str2ab(e.deviceName),a=new DataView(r),c=0;c<14;c++)c<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.deviceType),n.set1x(e.connectTimeout),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),f=0;f<14;f++)c.set1x(n.get1x());a.deviceName=s.default.ab2str(c.buffer.slice(0,13));for(var l=new ArrayBuffer(14),p=new DataView(l),d=0;d<14;d++)p.set1x(n.get1x());a.deviceId=s.default.ab2str(p.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x(),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(),a.busineesCooperationNumber=n.get2x(),a.pcbVersion=n.get2x(),a.rssi=n.get1x(),a.macAddress=u.a.decToHex(n.get1x(DataView.NO_SIGNED))+":"+u.a.decToHex(n.get1x(DataView.NO_SIGNED))+":"+u.a.decToHex(n.get1x(DataView.NO_SIGNED))+":"+u.a.decToHex(n.get1x(DataView.NO_SIGNED))+":"+u.a.decToHex(n.get1x(DataView.NO_SIGNED))+":"+u.a.decToHex(n.get1x(DataView.NO_SIGNED)),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getDeviceOnlineStatus",e)}},r.prototype.startCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=null==e.subVersion?0:e.subVersion;var t=e.target||{deviceId:e.deviceId,deviceType:e.deviceType},n=new ArrayBuffer(26),r=new DataView(n);r.set2x(9),r.setStr(t.deviceId,14),r.set2x(t.deviceType),r.set4x(e.userId),r.set4x(e.timestamp),e.content=r.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"startCollect",e)}},r.prototype.stopCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=null==e.subVersion?0:e.subVersion;var t=e.target||{deviceId:e.deviceId,deviceType:e.deviceType},n=new ArrayBuffer(26),r=new DataView(n);r.set2x(10).setStr(t.deviceId,14).set2x(t.deviceType).set4x(e.userId).set4x(e.timestamp),e.content=r.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"stopCollect",e)}},r.prototype.startRawData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(15),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"startRawData",e)}},r.prototype.stopRawData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(16),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"stopRawData",e)}},r.prototype.startRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(7),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"startRawData",e)}},r.prototype.stopRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(8),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"stopRealData",e)}},r.prototype.sceneOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=new ArrayBuffer(17),n=new DataView(t);n.set2x(81),n.set1x(e.operationCode),n.set8x(e.sceneId),n.set1x(255),n.set1x(255),n.set1x(255),n.set1x(0),n.set1x(void 0==e.lightFlag?255:e.lightFlag),n.set1x(void 0==e.musicFlag?255:e.musicFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.lightOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set2x(82);var r=e.light,a=r.operationCode;e.mode&&(a|=e.mode<<4),n.set1x(a),r.lightBrightness&&(n.set1x(r.lightBrightness),n.set1x(r.lightMode),r.lightMode==c.LightMode.White||r.lightMode==c.LightMode.Color?(n.set1x(r.r),n.set1x(r.g),n.set1x(r.b),n.set1x(r.w)):n.set1x(r.fixed_stream_id)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.alarmOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set2x(83),n.set1x(e.operationCode),n.set8x(e.alarmId),3==e.operationCode&&(n.set1x(e.volume),n.set1x(e.lightBrightness),n.set1x(e.aromatherapySpeed),n.set1x(0),n.set2x(e.musicId)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.musicOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=e.operationCode,n=e.volume,r=e.musicType,a=e.musicId,s=e.circleMode,c=new ArrayBuffer(8),u=new DataView(c);u.set2x(84);var f=t;f|=e.mode<<4,u.set1x(f),0!=e.operationCode&&2!=e.operationCode&&(u.set1x(n),u.set1x(null!=r?0:r),u.set2x(a),u.set1x(s||0)),e.content=u.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.sceneConfig=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=817,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.count);for(var r=e.sleepSceneConfigs,a=0;a<r.length;a++){var c=r[a];n.set8x(c.sceneId||100),n.set1x(c.flag||1),n.set1x(c.sceneType||0),n.set1x(c.monitorFlag||1),n.set2x(c.monitorDeviceType);for(var u=s.default.str2ab(c.monitorDeviceName||""),f=new DataView(u),l=0;l<14;l++)l<u.byteLength?n.set1x(f.get1x()):n.set1x(0);for(var d=s.default.str2ab(c.monitorDeviceId||""),g=new DataView(d),h=0;h<14;h++)h<d.byteLength?n.set1x(g.get1x()):n.set1x(0);n.set1x(c.sleepAidDeviceFlag||1),n.set1x(c.sleepAidFlag||1);var y=0;1==c.musicFlag&&(y|=1),1==c.lightFlag&&(y|=2),n.set1x(y),n.set1x(c.volume),n.set1x(c.lightBrightness),n.set1x(c.lightColorR),n.set1x(c.lightColorG),n.set1x(c.lightColorB),n.set1x(c.lightColorW),n.set1x(c.smartStop),n.set1x(c.sleepAidTime),n.set1x(c.smartAlarm)}e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneConfig",e)}},r.prototype.alarmConfig=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=819,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.count);for(var r=e.alarms,a=0;a<r.length;a++){var s=r[a];n.set8x(s.alarmId),n.set1x(s.flag||1),n.set1x(s.smartFlag||1),n.set1x(s.smartOffset||20),n.set1x(s.hour),n.set1x(s.minute),n.set1x(s.weekday),n.set1x(s.lazyCount||0),n.set1x(s.lazyTime||0),n.set1x(s.volume),n.set1x(s.lightBrightness),n.set1x(s.vibratorFlag||0),n.set1x(s.musicType||0),s.musicType==c.MUSIC_TYPE.LOCAL||s.musicType==c.MUSIC_TYPE.OUTSITE?n.set2x(s.musicId):s.musicType==c.MUSIC_TYPE.SLEEPACE_SINGLE?(n.set1x(s.singleType),n.set4x(s.musicId)):s.musicType!=c.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM&&s.musicType!=c.MUSIC_TYPE.SLEEPACE_ALBUM&&s.musicType!=c.MUSIC_TYPE.XMLY_ALBUM&&s.musicType!=c.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM||(n.set4x(s.albumId),n.set4x(s.musicId),n.set2x(s.currentIndex),n.set1x(s.playMode)),n.set1x(s.cycleMode),n.set4x(s.timestamp||0)}e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.smallNightConfig=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=813,e.subVersion=1;var t=new ArrayBuffer(10),n=new DataView(t);n.set1x(e.flag),n.set1x(e.lightBrightness),n.set1x(e.lightColorR),n.set1x(e.lightColorG),n.set1x(e.lightColorB),n.set1x(e.lightColorW),n.set1x(e.startHour),n.set1x(e.startMinute),n.set2x(e.continueTime),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.albumMusicConfig=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=815,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t),r=e.music;n.set1x(r.albumType||c.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM),n.set4x(r.albumId),n.set2x(r.count);a(r.musicList,n),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"sceneOperation",e)}},r.prototype.sleepAidOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(5),n=new DataView(t);n.set2x(55),n.set1x(e.operationType),n.set1x(e.lightFlag),n.set1x(e.musicFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"startRawData",e)}},r.prototype.startConfig=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=e.subVersion||0;var t=new ArrayBuffer(3),n=new DataView(t);n.set2x(56),n.set1x(e.configMode),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"startConfig",e)}},r.prototype.stopConfig=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=e.subVersion||0;var t=new ArrayBuffer(4),n=new DataView(t);n.set2x(57),n.set1x(e.configMode),n.set1x(e.operationCode),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"stopConfig",e)}},r.prototype.attendDeviceNetwork=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(66),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"attendDeviceNetwork",e)}},r.prototype.updateFirmware=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=void 0==e.subVersion?1:e.subVersion;var t=new ArrayBuffer(21),n=new DataView(t);n.set2x(32),n.setStr(e.upgradeDeviceId,14),n.set2x(e.upgradeDeviceType),n.set1x(e.hardType),n.set2x(e.hardVersion),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"updateFireware",e)}},r.prototype.updateFireware=function(){this.updateFirmware.apply(this,arguments)},r.prototype.updateFirmwareX1000=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||c.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=void 0==e.subVersion?0:e.subVersion;var t=new ArrayBuffer(23);new DataView(t).set2x(4624).setStr(e.upgradeDeviceId,14).set2x(e.upgradeDeviceType).set2x(e.currentVersion).set2x(e.newVersion).set1x(e.upgradeMode);var n=new ArrayBuffer(e.fileUrl.length+2);new DataView(n).setStr(e.fileUrl),e.content=t.mergeBuffer(n),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"updateFirmwareX1000",e)}},r.prototype.uploadEnvironmentHistory=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(30),n=new DataView(t);n.set2x(67),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set4x(e.userId),n.set4x(e.startTime),n.set4x(e.count),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"attendDeviceNetwork",e)}},r.prototype.setAutostartClock=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=802,e.subVersion=0;var t=new ArrayBuffer(20),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType);var r=e.autoStartClock;n.set1x(r.flag),n.set1x(r.hour),n.set1x(r.minute),n.set1x(r.weekday),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"setAutostartClock",e)}},r.prototype.getAutostartClock=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=803,e.subVersion=0;var t=new ArrayBuffer(16),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=s.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x(),a.autoStartClock={flag:n.get1x(),hour:n.get1x(),minute:n.get1x(),weekday:n.get1x()},e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"getAutostartClock",e)}},r.prototype.setClockSleep=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=806,e.subVersion=0;var t=new ArrayBuffer(21),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType);var r=e.clockSleep;n.set1x(r.flag),n.set1x(r.startHour),n.set1x(r.startMinute),n.set1x(r.endHour),n.set1x(r.endMinute),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(p,"setAutostartClock",e)}},r.prototype.getClockSleep=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=807,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=s.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x();var f={};f.flag=n.get1x(),f.startHour=n.get1x(),f.startMinute=n.get1x(),f.endHour=n.get1x(),f.endMinute=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(p,"setAutostartClock",e)}},r.prototype.registerWorkModeCallback=function(e,t){return this.socketClient.onPostMsg(1044,function(n,r,a){var i=new DataView(n),o=u.a.workModeParse(i,t);e&&e(o,a)})},r.prototype.unregisterWorkModeCallback=function(e){this.socketClient.removePostMsgListener(1044,e)},r.prototype.registerRealDataCallback=function(e){return this.socketClient.onPostMsg(1280,function(t,n,r){var a=new DataView(t),i=u.a.realDataParse(a);e&&e(i,r)})},r.prototype.unregisterRealDataCallback=function(e){this.unregisterListener("REAL_DATA",e)},r.prototype.registerDeviceStatusFlagCallback=function(e){return this.socketClient.onPostMsg(4612,function(t,n,r){console.log("registerDeviceStatusFlagCallback-------",t);var a=new DataView(t),i=u.a.wakeUpFlagParse(a);e&&e(i,r)})},r.prototype.unRegisterDeviceStatusFlagCallback=function(e){this.unregisterListener("WAKE_UP_FLAG",e)},r.prototype.registerRawDataCallback=function(e){return this.socketClient.onPostMsg(1286,function(t,n,r){var a=new DataView(t),i=u.a.rawDataParse(a);e&&e(i,r)})},r.prototype.unregisterListener=function(e,t){var n=void 0;switch(e){case"REAL_DATA":n=1280;break;case"RAW_DATA":n=1286;break;case"WAKE_UP_FLAG":n=4612}null!==t&&this.socketClient.removePostMsgListener(n,t)},r.prototype.registerHistoryUploadOverCallback=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(34==a.get2x()){var i=a.get4x();e&&e(i,r)}})},r.prototype.unregisterHistoryUploadOverCallback=function(e){this.socketClient.removePostMsgListener(256,e)},r.prototype.registerUpdateCallback=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(33==a.get2x()){for(var i={},o=new ArrayBuffer(14),c=new DataView(o),u=0;u<14;u++)c.set1x(a.get1x());i.deviceId=s.default.ab2str(c.buffer.slice(0,13)),i.deviceType=a.get2x(),i.updateStatus=a.get1x(),i.progress=a.get1x(),e&&e(i,r)}})},r.prototype.unregisterUpdateCallback=function(e){this.socketClient.removePostMsgListener(256,e)},r.prototype.registerHistoryUploadStatusCallback=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(80==a.get2x()){var i={};i.status=a.get1x();for(var o=new ArrayBuffer(14),c=new DataView(o),u=0;u<14;u++)c.set1x(a.get1x());i.deviceId=s.default.ab2str(c.buffer.slice(0,13)),i.deviceType=a.get2x(),i.timestamp=a.get4x(),e&&e(i,r)}})},r.prototype.unregisterHistoryUploadStatusCallback=function(e){this.socketClient.removePostMsgListener(256,e)},r.prototype.registerAlarmClockCallback=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(87==a.get2x()){var i={};i.alarmId=a.get8x(),i.timestamp=a.get4x(),e&&e(i,r)}})},r.prototype.unregisterAlarmClockCallback=function(e){this.socketClient.removePostMsgListener(256,e)},r.prototype.registerSleepAidStopCallback=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(88==a.get2x()){var i=a.get4x();e&&e(i,r)}})},r.prototype.unregisterSleepAidStopCallback=function(e){this.socketClient.removePostMsgListener(256,e)},r.prototype.registerLowBatteryCallbak=function(e){return this.socketClient.onPostMsg(256,function(t,n,r){var a=new DataView(t);if(11==a.get2x()){for(var i={},o=new ArrayBuffer(14),c=new DataView(o),u=0;u<14;u++)c.set1x(a.get1x());i.deviceId=s.default.ab2str(c.buffer.slice(0,13)),i.battery=a.get1x(),e&&e(i,r)}})},r.prototype.registerOnlineStatusCallback=function(e){return this.socketClient.onPostMsg(1025,function(t,n,r){var a=new DataView(t),i=u.a.onlineStatusParse(a);e&&e(i,r)})},r.prototype.unregisterOnlineStatusCallback=function(e){this.socketClient.removePostMsgListener(1025,e)},r.prototype.registerCollectStatusCallback=function(e){return this.socketClient.onPostMsg(1026,function(t,n,r){var a=new DataView(t),i=u.a.collectStatusParse(a);e&&e(i,r)})},r.prototype.unregisterCollectStatusCallback=function(e){this.socketClient.removePostMsgListener(1026,e)},r.prototype.sendMsg=function(e,t,n){i.log.i(p,"sendMsg-start",e,s.default.buffer2Arr(t),this),e.deviceType=void 0==e.deviceType?c.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO:e.deviceType;try{this.socketClient.sendPacket({frameType:e.frameType,deviceType:e.deviceType,msgType:e.msgType,content:t,subVersion:e.subVersion,timeout:e.timeout||o.a.timeout,networkDeviceId:e.networkDeviceId,handler:function(t,r,a){if(i.log.i(p,"tcp back ----",t,r,a),t===o.a.RET.Succeed&&r&&r.byteLength>0){var s=new DataView(r),c=s.get2x(),u=0===c?o.a.RET.Succeed:c;i.log.i(p,"sendPacket_status",c,"msgType:",e.msgType,"resCode: ",u),n?n(u,s,a):e.handler&&e.handler(u)}else i.log.i(p,"sendPacket_status","msgType:",e.msgType),n?n(o.a.RET.Timeout):e.handler&&e.handler(o.a.RET.Timeout)}})}catch(e){i.log.e(p,"sendMsg",e)}}},function(e,t,n){"use strict";function r(){this.container={},this.put=function(e,t){this.container[e]=t},this.get=function(e){var t=this.container[e];return void 0==t?null:t},this.showMap=function(){var e=[];for(var t in this.container)e.push("{"+t+":"+this.container[t]+"}")},this.remove=function(e){var t=this.container[e];return delete this.container[e],void 0==t?null:t},this.clear=function(){for(var e in this.container)delete this.container[e]},this.containsKey=function(e){for(var t in this.container)if(t==e)return!0;return!1},this.containsValue=function(e){for(var t in this.container)if(this.container[t]==e)return!0;return!1},this.keySet=function(){var e=[];for(var t in this.container)e.push(t);return e},this.values=function(){var e=[];for(var t in this.container)e.push(this.container[t]);return e},this.size=function(){var e=0;for(var t in this.container)e++;return e},this.putAll=function(e){for(var t in e.container)this.put(t,e.container[t])}}Object.defineProperty(t,"__esModule",{value:!0}),t.Map=r,r.prototype.forEach=function(e){for(var t in this.container)e(this.container[t],t)},t.default={Map:r}},function(e,t,n){"use strict";function r(){return E>=127&&(E=0),E++}function a(e,t){for(var n=[],r=new DataView(t),a=0;a<r.byteLength;){var i=r.getUint8(a),o=r.getUint8(a+1);if(a+i+1>31)break;if(0==i)break;if(e==o){for(var s=0;s<i-1;s++)n.push(r.getInt8(a+2+s));break}a+=i+1}r=new DataView(new ArrayBuffer(n.length));for(var s=0;s<n.length;s++)r.setInt8(s,n[s]);return r.buffer}function i(e){var t=e,n=void 0;return t&&t.byteLength>0&&(n=l.default.ab2str(a(255,t))),n}function o(){this.resp=!0,this.key=!0,this.callStatusMap=new p.Map,this.respDv=new DataView(new ArrayBuffer(4096)),this.respBufIndex=0,this.BUF_SEPARATOR_ARR=[36,95,64,45],this.buildMsg=function(e){var t=r(),n=e.content||new ArrayBuffer(0),a=new DataView(new ArrayBuffer(16+n.byteLength));this.buildHeader(t,1,0,e.deviceType,a),a.position=7,a.set1x(e.msgType);for(var i=this.buildCallkey(e.deviceType,e.msgType,t),o=new DataView(n),s=0;s<n.byteLength;s++)a.set1x(o.get1x());return this.buildEnder(a,n.byteLength),{key:i,buffer:a.buffer}},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,a=0,i=setInterval(function(){a++;var o=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(o=!0,n.callStatusMap.remove(e.key)):o=!0,(o||a>=r)&&(clearInterval(i),t(o,a))},5)},this.handleResp=function(e,t){if(d.log.i(T,"handleResp-start",l.default.buffer2Arr(e)),e&&!(e.byteLength<=0))for(var n=e.byteLength,r=new DataView(e),a=0;a<n;a++){this.respDv.setInt8(this.respBufIndex,r.getInt8(a));var i=this.isEndMsg(this.respDv,this.respBufIndex);if(this.respBufIndex++,i){var o=new DataView(this.respDv.buffer.slice(0,this.respBufIndex));if(d.log.i(T,"handleResp-newDv",l.default.buffer2Arr(o.buffer)),o.byteLength<16)this.respBufIndex=0;else{var s=u.default.crc32buf(o.buffer.slice(0,o.byteLength-8)),c=o.getInt32(o.byteLength-8);if(s===c){var f=o.getInt8(1),p=(o.getInt8(2),o.getInt8(3));this.respBufIndex=0;var g=o.getInt16(5),h=o.getInt8(7),y=o.getInt8(4);if(1===f){var v=this.buildCallkey(g,h);t({isPost:!0,key:v,buffer:o.buffer,deviceType:g,msgType:h,frameType:f,frameSeq:p})}else if(3===f){var E=this.buildCallkey(g,h,y),_=this.callStatusMap.get(E);_&&(_.resp=!0,_.respTime=(new Date).getTime(),this.callStatusMap.put(E,_)),t({isPost:!1,key:E,buffer:o.buffer,deviceType:g,msgType:h,frameType:f})}else d.log.i(T,"handleResp-unexpected-frameType",f,l.default.buffer2Arr(o.buffer))}else this.respBufIndex=0}}}},this.buildHeader=function(e,t,n,r,a){a.setInt8(0,0),a.setInt8(1,2),a.setInt8(2,t),a.setInt8(3,n),a.setInt8(4,e),a.setInt16(5,r)},this.buildEnder=function(e,t){var n=u.default.crc32buf(e.buffer.slice(0,8+t));e.position=8+t,e.set4x(n);for(var r=0;r<this.BUF_SEPARATOR_ARR.length;r++)e.set1x(this.BUF_SEPARATOR_ARR[r])},this.buildCallkey=function(e,t,n){return void 0===n?e+"_"+t:e+"_"+t+"_"+n},this.isEndMsg=function(e,t){return!(t<3)&&(e.getUint8(t)===this.BUF_SEPARATOR_ARR[3]&&e.getUint8(t-1)===this.BUF_SEPARATOR_ARR[2]&&e.getUint8(t-2)===this.BUF_SEPARATOR_ARR[1]&&e.getUint8(t-3)===this.BUF_SEPARATOR_ARR[0])}}function s(){this.resp=!0,this.key=!0,this.callStatusMap=new p.Map,this.respDv=new DataView(new ArrayBuffer(8192)),this.respBufIndex=0,this.MSG_SUB_ARR=[18,239],this.MSG_LEN=0,this.MSG_START=0,this.POST_MSGTYPE_TEM=-1,this.buildMsg=function(e){if(e.frameType===g.FRAME_TYPE.ACK)return this.buildAckMsg(e);var t=r(),n=t,a=e.content||new ArrayBuffer(0),i=new DataView(new ArrayBuffer(15+a.byteLength));this.buildHeader(n,t,e.msgType,e.frameType,i);for(var o=this.buildCallkey(e.deviceType,e.msgType,t),s=new DataView(a),c=0;c<a.byteLength;c++)i.set1x(s.get1x());return this.buildEnder(i,a.byteLength),d.log.i(T,"buildMsg",l.default.buffer2Arr(i.buffer)),{key:o,buffer:i.buffer}},this.buildAckMsg=function(e){var t=new DataView(new ArrayBuffer(13)),n="ACK_"+this.buildCallkey(e.deviceType,e.msgType);return this.buildHeader(e.frameSeq,e.msgSeq,e.msgType,e.frameType,t),t.set1x(e.resCode),this.buildEnder(t,1,8),{key:n,buffer:t.buffer}},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,a=0,i=setInterval(function(){a++;var o=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(o=!0,n.callStatusMap.remove(e.key)):o=!0,(o||a>=r)&&(clearInterval(i),t(o,a))},5)},this.handleResp=function(e,t,n){try{if(d.log.i(T,"handleResp-start",l.default.buffer2Arr(e)),!e||e.byteLength<=0)return;for(var r=e.byteLength,a=new DataView(e),i=0;i<r;i++)if(this.respDv.setInt8(this.respBufIndex,a.getInt8(i)),this.isSubMsg(this.respDv,this.respBufIndex)&&(a.byteLength>=i+1?this.MSG_LEN=a.getUint16(i+1):this.respBufIndex=0,this.MSG_START=this.respBufIndex-1),this.respBufIndex-this.MSG_START+1===this.MSG_LEN){var o=new DataView(this.respDv.buffer.slice(this.MSG_START,this.respBufIndex+1));this.respBufIndex=0,this.MSG_LEN=0,this.MSG_START=0,this.handleRespData(o,t,n)}else this.respBufIndex++}catch(e){d.log.e(T,"handleResp",e)}},this.buildHeader=function(e,t,n,r,a){switch(a.set1x(18),a.set1x(239),a.set2x(a.byteLength),a.set1x(0),r){case g.FRAME_TYPE.POST:case g.FRAME_TYPE.Request:case g.FRAME_TYPE.ACK:a.set1x(r);break;default:a.set1x(g.FRAME_TYPE.Request)}a.set1x(e);var i=Object(f.crc8buf)(a.buffer.slice(0,7));a.set1x(i),r!==g.FRAME_TYPE.ACK&&(a.set1x(n),a.set2x(t))},this.buildCallkey=function(e,t,n){return e+"_"+n},this.buildEnder=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:11,r=u.default.crc32buf(e.buffer.slice(0,n+t));e.position=n+t,e.set4x(r)},this.isSubMsg=function(e,t){return!(t<1)&&(e.getUint8(t)===this.MSG_SUB_ARR[1]&&e.getUint8(t-1)===this.MSG_SUB_ARR[0])},this.handleRespData=function(e,t,n){d.log.i(T,"handleRespData",l.default.buffer2Arr(e.buffer));try{if(!e||e.byteLength<=9)return;var r=e.getInt8(5),a=e.getUint8(6),i=e.getInt8(8),o=e.getInt16(9);if(0===r&&(i=this.POST_MSGTYPE_TEM,o=e.getInt8(6)),1===r){t({isPost:!0,key:this.buildCallkey(n,i),buffer:e.buffer,deviceType:n,msgType:i,frameType:r,frameSeq:a})}else if(3===r||0===r){var s=this.buildCallkey(n,i,o),c=this.callStatusMap.get(s);c&&(c.resp=!0,c.respTime=(new Date).getTime(),this.callStatusMap.put(s,c)),t({isPost:!1,key:s,buffer:e.buffer,deviceType:n,msgType:i,frameType:r})}else d.log.i(T,"handleRespData","unexpected-frameType:",r)}catch(e){d.log.e(T,"handleRespData",e)}}}function c(){this.resp=!0,this.callStatusMap=new p.Map,this.p=new y.a,this.buildMsg=function(e){var t=new h.a;t.frameType=e.frameType,t.deviceType=e.deviceType,t.messageType=e.msgType,t.content=e.content,t.subVersion=e.subVersion,t.frameSequence=r(2),t.channelCode=this.hashCode(e.networkDeviceId);var n=t.data();return{key:l.default.buildKey(t.deviceType,t.messageType,t.frameSequence),buffer:n}},this.hashCode=function(e){e=e||"";for(var t=0,n=e.length,r=0;r<n;r++)(t=31*t+e.charCodeAt(r))>2147483647&&(t%=2147483648);return t},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,a=0,i=setInterval(function(){a++;var o=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(o=!0,n.callStatusMap.remove(e.key)):o=!0,(o||a>=r)&&(clearInterval(i),t(o,a))},5)},this.handleResp=function(e,t,n){try{var r=this.p.appendData(e);if(r&&r.length>0)for(var a=0;a<r.length;a++){var i=l.default.buildKey(n,r[a].messageType,r[a].frameSequence);if(r[a].frameType===v.a.FrameType.POST)t({isPost:!0,key:i,buffer:r[a].content,deviceType:n,frameType:r[a].frameType});else if(r[a].frameType===v.a.FrameType.ACK||r[a].frameType===v.a.FrameType.Response){var o=this.callStatusMap.get(i);o&&(o.resp=!0,o.respTime=(new Date).getTime(),this.callStatusMap.put(i,o)),t({isPost:!1,key:i,buffer:r[a].content,deviceType:n,frameType:r[a].frameType})}}}catch(e){d.log.e(T,"handleRespData",e)}},this.buildCallkey=function(e,t,n){return e+"_"+n},this.handleRespData=function(e,t,n){d.log.i(T,"handleRespData",l.default.buffer2Arr(e.buffer));try{if(!e||e.byteLength<=9)return;var r=e.getInt8(5),a=e.getInt8(8),i=e.getInt16(9);if(0===r&&(a=this.POST_MSGTYPE_TEM,i=e.getInt8(6)),1===r){t({isPost:!0,key:this.buildCallkey(n,a),buffer:e.buffer,deviceType:n,msgType:a,frameType:r})}else if(3===r||0===r){var o=this.buildCallkey(n,a,i),s=this.callStatusMap.get(o);s&&(s.resp=!0,s.respTime=(new Date).getTime(),this.callStatusMap.put(o,s)),t({isPost:!1,key:o,buffer:e.buffer,deviceType:n,msgType:a,frameType:r})}else d.log.i(T,"handleRespData","unexpected-frameType:",r)}catch(e){d.log.e(T,"handleRespData",e)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.MedicaProtocol1=o,t.MedicaProtocol2=s,t.MedicaProtocol3=c;var u=n(14),f=n(15),l=n(1),p=n(6),d=n(2),g=n(0),h=n(21),y=n(27),v=n(3),T="bleProtocol",E=0;t.default={getSNFromAdvertisData:i}},function(e,t,n){"use strict";function r(){this.conf=g}function a(e){var t={},n=new DataView(e);return t.alarmId=n.get8x(1),t.alarmFlag=n.get1x(1),t.smartFl=n.get1x(1),t.smartOffset=n.get1x(1),t.hour=n.get1x(1),t.minute=n.get1x(1),t.week=n.get1x(1),t.lazyCount=n.get1x(1),t.lazyTime=n.get1x(1),t.volume=n.get1x(1),t.brightness=n.get1x(1),t.aromaRate=n.get1x(1),t.oscillatorFlag=n.get1x(1),t}function i(e,t){var n=e.get1x(1),r=void 0;switch(n){case 0:case 1:r=e.get2x(1);break;case 3:r=e.get4x(1);break;case 2:case 6:case 7:t.albumId=e.get4x(1),r=e.get4x(1),t.currentIndex=e.get2x(1),t.playMode=e.get1x(1)}t.cycle=e.get1x(1),t.musicType=n,t.musicId=r}function o(e,t,n){switch(e){case 2:n.fluxaySeqid=t.get1x(1);break;case 0:case 1:n.r=t.get1x(1),n.g=t.get1x(1),n.b=t.get1x(1),n.w=t.get1x(1)}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"AromaScheduleOperation",function(){return d}),n.d(t,"bleConf1",function(){return g}),t.BleCommon1=r;var s=n(11),c=n(7),u=n(2),f=n(1),l=n(0),p=n(4),d={Invalid:0,DeleteAll:1,DeleteSingle:2,ModifyList:3,SetList:4,Enalbe:5,Disable:6},g=s.MedicaBle.getBleDefaultConfig();g.protocol=new c.MedicaProtocol1,r.prototype=new s.MedicaBle,r.prototype.checkTime=function(e){var t=new DataView(new ArrayBuffer(13));t.set4x(e.timestamp),t.set4x(e.timezoneOffset),t.set1x(e.season),t.set4x(e.seasonOffset),e.content=t.buffer,this.sendMsgOperation(16,l.FRAME_TYPE.Request,e)},r.prototype.getSystemInfo=function(e){this.sendMsgOperation(17,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};n.deviceName=f.default.buf2string(t.buffer.slice(9,22)),n.deviceId=f.default.buf2string(t.buffer.slice(23,36)),n.deviceType=t.getUint16(37),n.currVersion=t.getUint16(39),n.currVersion=Object(p.padStart)(parseInt(n.currVersion/100),1,0)+"."+Object(p.padStart)(parseInt(n.currVersion%100)),n.facVersion=t.getUint16(41),n.facVersion=Object(p.padStart)(parseInt(n.facVersion/100),1,0)+"."+Object(p.padStart)(parseInt(n.facVersion%100)),n.facTime=t.getUint32(43),n.manufacCode=t.getUint16(47),n.coopCode=t.getUint16(49),n.pcbVersion=t.getUint8(51)+"."+t.getUint8(52);var r=53;t.byteLength>=73&&(n.wifiMac=[t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++)].map(function(e){return Object(p.padStart)(e.toString(16))}).join(":"));var a=t.getUint8(r++),i=t.getUint8(r++),o=t.getUint8(r++),s=t.getUint8(r++),c=t.getUint8(r++),u=t.getUint8(r++),l=[u,c,s,o,i,a].map(function(e){return Object(p.padStart)(e.toString(16))}).join(":").toUpperCase();return n.deviceMac=l,n})},r.prototype.getSystemVersion=function(e){this.sendMsgOperation(18,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return t.position=9,n.currVersion1=t.get1x(1),n.currVersion2=t.get1x(1),n.currVersion=n.currVersion1+"."+n.currVersion2,n})},r.prototype.retSystemInfo=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(19,l.FRAME_TYPE.Request,e)},r.prototype.userInfo=function(e){var t=new DataView(new ArrayBuffer(6));t.set1x(1),t.set4x(e.userId),t.set1x(e.language),e.content=t.buffer,this.sendMsgOperation(32,l.FRAME_TYPE.Request,e)},r.prototype.sceneConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.number),e.content=t.buffer.append(e.sceneData),this.sendMsgOperation(33,l.FRAME_TYPE.Request,e)},r.prototype.sleepSceneContentData=function(e){var t=new DataView(new ArrayBuffer(13));t.set8x(e.sceneId),t.set1x(e.enable),t.set1x(e.sceneType),t.set1x(e.monitorSwitch),t.set2x(e.monitorType);for(var n=f.default.str2ab(e.monitorDeviceId),r=n.byteLength,a=r;a<14;a++){var i=new DataView(new ArrayBuffer(1));i.set1x(0),n=n.append(i.buffer)}var o=t.buffer.append(n),s=new DataView(new ArrayBuffer(1));s.set1x(e.assistSwitch);var c=o.append(s.buffer),u=c.append(e.sleepAssistModel.contentData),l=new DataView(new ArrayBuffer(1));return l.set1x(e.alarmSwitch),u.append(l.buffer)},r.prototype.sleepAssistModel=function(e){var t=e.lightSwitch,n=e.musicSwitch,r=e.aromaSwitch,a=0;n&&(a|=1),t&&(a|=2),r&&(a|=4);var i=new DataView(new ArrayBuffer(11));i.set1x(e.sleepSwitch),i.set1x(a),i.set1x(e.volume),i.set1x(e.brightness),i.set1x(e.r),i.set1x(e.g),i.set1x(e.b),i.set1x(e.w),i.set1x(e.rate),i.set1x(e.smartStop),i.set1x(e.aidingTime);var o={};return o.contentData=i.buffer,o},r.prototype.colockConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.number);for(var n=t.buffer,r=0;r<e.alarmListData.length;r++){var a=e.alarmListData[r];n=n.append(a.content)}e.content=n,this.sendMsgOperation(35,l.FRAME_TYPE.Request,e)},r.prototype.getClockConfig=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(35,l.FRAME_TYPE.Request,e,function(e){var t=new Array,n=new DataView(e);n.position=9;for(var r=(n.get1x(1),n.get1x(1)),o=0;o<r;o++){var s=n.position,c=s+20,u=a(n.buffer.slice(s,c));n.position=c,i(n,u),u.timestamp=n.get4x(1),t.push(u)}return t})},r.prototype.alarmContentData=function(e){var t=this.musicData(e),n=new DataView(new ArrayBuffer(20));n.set8x(e.alarmId),n.set1x(e.alarmFlag),n.set1x(e.smartFlag),n.set1x(e.smartOffset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.week),n.set1x(e.lazyCount),n.set1x(e.lazyTime),n.set1x(e.volume),n.set1x(e.brightness),n.set1x(e.aromaRate),n.set1x(e.oscillatorFlag);var r=n.buffer.append(t),a=new DataView(new ArrayBuffer(4));return a.set4x(e.timestamp),e.content=r.append(a.buffer),e},r.prototype.musicData=function(e){var t;switch(e.musicType){case l.MUSIC_TYPE.LOCAL:case l.MUSIC_TYPE.OUTSITE:t=new DataView(new ArrayBuffer(4)),t.set1x(e.musicType),t.set2x(e.musicId),t.set1x(e.cycle);break;case l.MUSIC_TYPE.XMLY_SIGLE:t=new DataView(new ArrayBuffer(6)),t.set1x(e.musicType),t.set4x(e.musicId),t.set1x(e.cycle);case l.MUSIC_TYPE.XMLY_ALBUM:case l.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case l.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t=new DataView(new ArrayBuffer(13)),t.set1x(e.musicType),t.set4x(e.albumId),t.set4x(e.musicId),t.set2x(e.currentIndex),t.set1x(e.playMode),t.set1x(e.cycle)}return t.buffer},r.prototype.lightConfig=function(e){var t=new DataView(new ArrayBuffer(8));t.set1x(1),t.set1x(e.lightness),t.set1x(e.r),t.set1x(e.g),t.set1x(e.b),t.set1x(e.w),t.set2x(e.duration),e.content=t.buffer,this.sendMsgOperation(38,l.FRAME_TYPE.Request,e)},r.prototype.albumConfig=function(e){var t=new DataView(new ArrayBuffer(8));t.set1x(1),t.set1x(e.musicType),t.set4x(e.albumId),t.set2x(e.voiceNumber),e.content=t.buffer.append(e.endData),this.sendMsgOperation(39,l.FRAME_TYPE.Request,e)},r.prototype.musicListData=function(e){for(var t=new DataView(new ArrayBuffer(4*e.length)),n=0;n<e.length;n++){var r=e[n];switch(r.musicType){case l.MUSIC_TYPE.LOCAL:t.set2x(r.musicId);break;case l.MUSIC_TYPE.XMLY_ALBUM:case l.MUSIC_TYPE.XMLY_SIGLE:case l.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case l.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t.set4x(r.musicId)}}return t.buffer},r.prototype.centerFuntionSet=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(null==e.operation?1:e.operation),t.set1x(e.lightSwitch),t.set1x(e.musicSwitch),t.set1x(e.fragranceSwitch),e.content=t.buffer,this.sendMsgOperation(44,l.FRAME_TYPE.Request,e,function(t){if(0===e.operation){var n=new DataView(t);return n.position=10,{light:n.get1x(1),music:n.get1x(1),aroma:n.get1x(1)}}})},r.prototype.timingSwitchConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.operation),e.content=t.buffer.append(e.endData),this.sendMsgOperation(45,l.FRAME_TYPE.Request,e)},r.prototype.timingData=function(e,t){var n=new DataView(new ArrayBuffer(0));switch(t){case d.Invalid:n=new DataView(new ArrayBuffer(0));break;case d.DeleteSingle:case d.Enalbe:case d.Disable:n=new DataView(new ArrayBuffer(8)),n.set8x(e.seqId);break;case d.ModifyList:n=new DataView(new ArrayBuffer(16)),n.set1x(1),n.set8x(e.seqId),n.set1x(e.isOpen),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.week),n.set2x(e.duration),n.set1x(e.rate)}return n.buffer},r.prototype.pinSet=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.on),e.content=t.buffer,this.sendMsgOperation(46,l.FRAME_TYPE.Request,e)},r.prototype.ligthSwitchOpertaion=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(3));n.set1x(t),n.set1x(Math.min(e.brightness,100)),n.set1x(e.lightMode),0==e.operation&&(e.endData=new ArrayBuffer(0)),e.content=n.buffer.append(e.endData),this.sendMsgOperation(48,l.FRAME_TYPE.Request,e)},r.prototype.lightData=function(e,t){switch(e){case 2:var n=new DataView(new ArrayBuffer(1));return n.set1x(t.fluxaySeqid),n.buffer;case 0:case 1:var n=new DataView(new ArrayBuffer(4));return n.set1x(t.r),n.set1x(t.g),n.set1x(t.b),n.set1x(t.w),n.buffer}},r.prototype.musicOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=void 0;switch(e.operation){case 1:case 3:case 4:var r=new DataView(new ArrayBuffer(2));r.set1x(t),r.set1x(e.volume),n=r.buffer.append(e.endData);break;case 5:var r=new DataView(new ArrayBuffer(1));r.set1x(t),n=r.buffer.append(e.endData);break;default:var r=new DataView(new ArrayBuffer(1));r.set1x(t)}e.content=n,this.sendMsgOperation(49,l.FRAME_TYPE.Request,e)},r.prototype.fragranceOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(2));n.set1x(t),n.set1x(e.rate),e.content=n.buffer,this.sendMsgOperation(55,l.FRAME_TYPE.Request,e)},r.prototype.oneKeySwitchOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(1));n.set1x(t),e.content=n.buffer.append(e.endData),this.sendMsgOperation(56,l.FRAME_TYPE.Request,e)},r.prototype.sceneOperation=function(e){var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set8x(e.sceneNumber),e.content=t.buffer.append(e.endData),this.sendMsgOperation(50,l.FRAME_TYPE.Request,e)},r.prototype.sceneOperationData=function(e,t){var n,r=f.default.buffer2Arr(this.musicData(t));switch(e){case 1:case 2:n=new DataView(new ArrayBuffer(3)),n.set1x(t.lightSwitch),n.set1x(t.musicSwitch),n.set1x(t.fragranceSwitch),r=r.concat(f.default.buffer2Arr(n.buffer))}return f.default.arr2Buffer(r)},r.prototype.asistSleepOperation=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(e.request),t.set1x(e.lightSwitch),t.set1x(e.musicSwitch),t.set1x(e.fragranceSwitch),e.content=t.buffer,this.sendMsgOperation(51,l.FRAME_TYPE.Request,e)},r.prototype.clockOperation=function(e){var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set8x(e.alarmSeqid),e.content=e.endData.byteLength>0?t.buffer.append(e.endData):t.buffer,this.sendMsgOperation(52,l.FRAME_TYPE.Request,e)},r.prototype.alarmData=function(e,t){var n,r=new ArrayBuffer(0);switch(e){case 3:var a=this.musicData(t);n=new DataView(new ArrayBuffer(3)),n.set1x(t.volume),n.set1x(t.brightness),n.set1x(t.aromaRate),r=n.buffer.append(a)}return r},r.prototype.previewOperation=function(e){var t=new DataView(new ArrayBuffer(3));t.set1x(e.request),t.set1x(e.exit),t.set1x(e.reset),e.content=t.buffer,this.sendMsgOperation(53,l.FRAME_TYPE.Request,e)},r.prototype.queryStatus=function(e){this.sendMsgOperation(64,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return t.position=9,n.status=t.get1x(1),n})},r.prototype.queryWorkMode=function(e){var t=this;this.sendMsgOperation(65,l.FRAME_TYPE.Request,e,function(e){return Object.assign(t.fillWithResponseAndPostData({msgType:65,buffer:e,isPost:!1}))})},r.prototype.queryMusicList=function(e){this.sendMsgOperation(66,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;for(var n=t.get1x(1),r={},a=new Array,i=0;i<n;i++)a.push(t.get1x(1));return r.musicList=a,r})},r.prototype.queryPlayProgress=function(e){this.sendMsgOperation(69,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.status=t.get1x(1),n.duration=t.get2x(1),n.volume=t.get1x(1),i(t,n),n})},r.prototype.queryUpgradeProgress=function(e){this.sendMsgOperation(79,l.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return n.status=t.getUint8(9),n.version=t.getUint16(10),n.progress=t.getUint32(12),n})},r.prototype.uploadUpgradeInfo=function(e){var t=new DataView(new ArrayBuffer(5+e.urlAddress.length));t.set2x(e.currentVersion),t.set2x(e.upgradeVersion),t.set1x(e.type),t.setStr(e.urlAddress,e.urlAddress.length),e.content=t.buffer,this.sendMsgOperation(81,l.FRAME_TYPE.Request,e)},r.prototype.netSet=function(e){var t=new ArrayBuffer(100),n=new DataView(t);n.set1x(1),n.set1x(e.controlType);for(var r=f.default.str2ab(e.socketIp),a=new DataView(r),i=r.byteLength,o=0;o<32;o++)o<i?n.set1x(a.getUint8(o)):n.set1x(0);n.set2x(e.port);for(var s=f.default.str2ab(e.httpIp),c=new DataView(s),u=s.byteLength,p=0;p<64;p++)p<u?n.set1x(c.getUint8(p)):n.set1x(0);e.content=n.buffer,this.sendMsgOperation(46,l.FRAME_TYPE.Request,e)},r.prototype.wifiConfig=function(e){var t=new ArrayBuffer(121),n=new DataView(t);n.set1x(1);var r=null;if(e.ssidRaw){var a=null;a=e.ssidRaw.constructor==Array?e.ssidRaw:JSON.parse(e.ssidRaw),r=f.default.arr2Buffer(a)}else r=f.default.str2ab(e.SSID);for(var i=new DataView(r),o=0;o<33;o++)o<r.byteLength?n.set1x(i.get1x()):n.set1x(0);n.set1x(e.pswMode);for(var s=f.default.str2ab(e.psw),c=new DataView(s),u=e.psw?e.psw.length:0,p=0;p<65;p++)p<u?n.set1x(c.get1x()):n.set1x(0);n.set1x(e.ipMode);for(var d=e.staticIp,g=d?d.length:0,h=0;h<4;h++)h<g?n.set1x(d[h]):n.set1x(0);for(var y=e.subNetMask,v=y?y.length:0,T=0;T<4;T++)T<v?n.set1x(y[T]):n.set1x(0);for(var E=e.gateWay,_=E?E.length:0,m=0;m<4;m++)m<_?n.set1x(E[m]):n.set1x(0);for(var w=e.dns1,x=w?w.length:0,D=0;D<4;D++)D<x?n.set1x(w[D]):n.set1x(0);for(var b=e.dns2,A=b?b.length:0,C=0;C<4;C++)C<A?n.set1x(b[C]):n.set1x(0);e.content=n.buffer,this.sendMsgOperation(37,l.FRAME_TYPE.Request,e)},r.prototype.queryWifiStatus=function(e){this.sendMsgOperation(67,l.FRAME_TYPE.Request,e,function(e){return new DataView(e).getUint8(9)})},r.prototype.sendMsgOperation=function(e,t,n,r){var a=n._retryTimes||1,i=n._retryInterval,o=this,s={content:n.content||new ArrayBuffer(0),timeout:n.timeout||1e4,msgType:e,frameType:t,handler:function(e,t,c){var f;if(e!=l.BLE_RET.status.suc)a--,a<1||!o.DEVICE_CONNECTION_STATE?n.handler&&n.handler(e):setTimeout(function(){u.log.i("bleCommonApi1","sendMsgOperation retry",e,a,i),o.sendPacket(s)},i>0?i:0);else if(n.handler){null==t&&(t=new ArrayBuffer(0));var p=void 0;if(c.frameType==l.FRAME_TYPE.Response&&t.byteLength>12){var d=new DataView(t);p=d.getInt8(8)}r?(f=r(t),n.handler(l.BLE_RET.status.suc,f,p)):n.handler(l.BLE_RET.status.suc,void 0,p)}}};this.sendPacket(s)},r.prototype.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=8:n.position=9,e.msgType){case 65:t.mode=n.get1x(1),t.sceneNumbers=n.get1x(1),t.sceneNumbers>0&&(t.sceneId=n.get8x(1),t.sceneType=n.get1x(1)),t.sleepAssistStatus=n.get1x(1),t.sleepAssistLeftTime=n.get1x(1),t.alarmStatus=n.get1x(1),t.alarmId=n.get8x(1),t.lightStatus=n.get1x(1),t.lightBrightness=n.get1x(1),t.lightMode=n.get1x(1),o(t.lightMode,n,t),t.aromaStatus=n.get1x(1),t.musicStatus=n.get1x(1),t.volume=n.get1x(1),i(n,t),u.log.i("===work ==:",f.default.buffer2Arr(n.buffer));break;case 20:t.status=n.get1x(1)}return t},r.prototype.sendUpgradeSummary=function(e){var t=new ArrayBuffer(14),n=new DataView(t);n.set2x(e.version),n.set4x(e.length),e.crcDes&&n.set4x(e.crcDes),e.crcBin&&n.set4x(e.crcBin),e.content=n.buffer,this.sendMsgOperation(e.msgType,l.FRAME_TYPE.Request,e)},r.prototype.sendUpgradeDetail=function(e){var t=new ArrayBuffer(6+e.content.length),n=new DataView(t);n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.content.length;r++)n.set1x(e.content[r]);e.content=n.buffer,this.sendMsgOperation(e.msgType,l.FRAME_TYPE.Request,e)}},function(e,t,n){"use strict";function r(e,t){switch(e.lightMode){case w.LightMode.White:case w.LightMode.Color:t.set1x(e.lightMode),t.set1x(e.lightColorR),t.set1x(e.lightColorG),t.set1x(e.lightColorB),t.set1x(e.lightColorW);break;case w.LightMode.Fixed_stream:t.set1x(e.lightMode),t.set1x(e.fixed_steam_id)}}function a(e){var t={};switch(t.lightMode=e.get1x(),t.lightMode){case w.LightMode.White:case w.LightMode.Color:t.lightColorR=e.get1x(DataView.NO_SIGNED),t.lightColorG=e.get1x(DataView.NO_SIGNED),t.lightColorB=e.get1x(DataView.NO_SIGNED),t.lightColorW=e.get1x(DataView.NO_SIGNED);break;case w.LightMode.Fixed_stream:t.fixed_steam_id=e.get1x(DataView.NO_SIGNED)}return t}function i(e,t){switch(e.musicType){case w.MUSIC_TYPE.LOCAL:case w.MUSIC_TYPE.OUTSITE:t.set1x(e.musicType),t.set2x(e.musicId);break;case w.MUSIC_TYPE.SLEEPACE_SINGLE:t.set1x(e.musicType),t.set1x(0|e.singleType),t.set4x(e.musicId);break;case w.MUSIC_TYPE.XMLY_SIGLE:case w.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:t.set1x(e.musicType),t.set4x(e.musicId);case w.MUSIC_TYPE.XMLY_ALBUM:case w.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:case w.MUSIC_TYPE.SLEEPACE_ALBUM:t.set1x(e.musicType),t.set4x(e.albumId),t.set4x(e.musicId),t.set2x(e.currentIndex),t.set1x(e.playMode)}t.set1x(e.cycleMode||0)}function o(e){var t={};switch(t.musicType=e.get1x(),t.musicType){case w.MUSIC_TYPE.LOCAL:case w.MUSIC_TYPE.OUTSITE:t.musicId=e.get2x();break;case w.MUSIC_TYPE.SLEEPACE_SINGLE:t.singleType=e.get1x(),t.musicId=e.get4x();break;case w.MUSIC_TYPE.XMLY_SIGLE:t.musicId=e.get4x();break;case w.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:case w.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case w.MUSIC_TYPE.XMLY_ALBUM:case w.MUSIC_TYPE.SLEEPACE_ALBUM:t.albumId=e.get4x(),t.musicId=e.get4x(),t.currentIndex=e.get2x(),t.playMode=e.get1x()}return t.cycleMode=e.get1x(),t}function s(e,t){t.set1x(e.length);for(var n=0;n<e.length;n++){var r=e[n];t.set8x(r.id),t.set1x(r.flag),t.set1x(r.hour),t.set1x(r.minute),t.set1x(r.weekday),t.set2x(r.continueTime),t.set1x(r.aromatherapySpeed)}}function c(e){return e==w.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001||e==w.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001_2||e==w.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001_4}function u(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=x.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x(),t.num=e.get1x(),t.connectState=e.get1x(),t}function f(e){var t={};t.deviceId=x.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.count=e.get1x(),t.realDataList=[];for(var n=0;n<t.count;n++){var r={};r.timestamp=e.get4x(),r.heartRate=e.get1x(DataView.NO_SIGNED),r.breathRate=e.get1x(DataView.NO_SIGNED),r.status=e.get1x(DataView.NO_SIGNED),r.statusValue=e.get2x(DataView.NO_SIGNED),r.eTemp=e.get2x(),r.eWet=e.get1x(),r.eLight=e.get2x(),r.eCo2=e.get2x(),r.eNoise=e.get1x(),r.bedTemp=e.get2x(),r.bedWet=e.get1x(),t.realDataList.push(r)}return t}function l(e){var t={};return t.deviceId=x.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.sleepAidFlag=e.get1x(),t.musicFlag=e.get1x(),t.lightFlag=e.get1x(),t.aromaFlag=e.get1x(),t.alarmFlag=e.get1x(),t}function p(e){var t={},n=DataView.NO_SIGNED;t.deviceId=x.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.orderNumber=e.get4x(n),t.interval=e.get2x(n),t.rawData=[];for(var r=e.get2x(),a=0;r&&a<r;a++)t.rawData.push(e.get2x());return t}function d(e){var t={};t.deviceId=x.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.serialNumber=e.get1x(),t.count=e.get1x(),t.realDataList=[];for(var n=0;n<t.count;n++){var r={};r.timestamp=e.get4x(),r.heartRate=e.get1x(DataView.NO_SIGNED),r.breathRate=e.get1x(DataView.NO_SIGNED),r.status=e.get1x(DataView.NO_SIGNED),r.statusValue=e.get2x(DataView.NO_SIGNED),r.asleepFlag=e.get1x(),r.wakeupFlag=e.get1x(),r.eTemp=e.get1x(),r.eWet=e.get1x(),t.realDataList.push(r)}return t}function g(e){var t={};t.deviceId=x.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.serialNumber=e.get1x(),t.count=e.get1x(),t.realDataList=[];for(var n=0;n<t.count;n++){var r={};r.timestamp=e.get4x(),r.heartRate=e.get1x(DataView.NO_SIGNED),r.breathRate=e.get1x(DataView.NO_SIGNED),r.status=e.get1x(DataView.NO_SIGNED),r.statusValue=e.get2x(DataView.NO_SIGNED),r.asleepFlag=e.get1x(),r.wakeupFlag=e.get1x(),t.realDataList.push(r)}return t}function h(e,t){switch(t){case w.DEVICE_TYPE.DEVICE_TYPE_SN913:case w.DEVICE_TYPE.DEVICE_TYPE_SN913A:case w.DEVICE_TYPE.DEVICE_TYPE_SN923A:case w.DEVICE_TYPE.DEVICE_TYPE_SN913E:return y(e)}var n={};if(n.mode=e.get1x(),n.sceneCount=e.get1x(),n.scenes=[],n.sceneCount>0)for(var r=0;r<n.sceneCount;r++){var i={};i.sceneId=e.get8x(),i.sceneType=e.get1x(),n.scenes.push(i)}n.sleepAidStatus=e.get1x(),n.sleepAidLeave=e.get1x(),n.alarmStatus=e.get1x(),n.alarmId=e.get8x();var s=e.get1x(),u=e.get1x();n.light=a(e),n.light.lightStatus=s,n.light.lightBrightness=u,c(t)&&(n.aromatherapySpeed=e.get1x());var f=e.get1x(),l=e.get1x();return n.music=o(e),n.music.musicStatus=f,n.music.volume=l,t!=w.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001&&t!=w.DEVICE_TYPE.DEVICE_TYPE_NOX_2W||(n.music.soundLightFlag=e.get1x()),n}function y(e){return{mode:e.get1x(1),lightStatus:e.get1x(1),light:{BRI:e.get1x(1),colorId:e.get1x(1),blinkMode:e.get1x(1),r:e.get1x(1),g:e.get1x(1),b:e.get1x(1),w:e.get1x(1)},alarmStatus:e.get1x(1),alarm1:e.get1x(1),alarm2:e.get1x(1),timeMode:e.get1x(1),wifiEnable:e.get1x(1),timeSync:e.get1x(1),musicStatus:e.get1x(1),musicId:e.get2x(1),volume:e.get1x(1),channelCode:e.get4x()}}function v(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=x.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x(),t.onlineStatus=e.get1x(),t}function T(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=x.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x(),t.collectStatus=e.get1x(),t.timestamp=e.get4x(),t}function E(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}function _(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=x.default.ab2str(r.buffer.slice(0,13)),t.userId=e.get4x(),t.timestamp=e.get4x(),t.step=e.get2x(),t.recordCount=e.get4x(),t}function m(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());t.deviceId=x.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x();var i=e.get2x(),o=e.get2x();return t.temperature=i/100,t.humidity=o/100,t}var w=n(0),x=n(1);t.a={workModeParse:h,aromatherapyTimerListConfig:s,musicConfigFill:i,musicConfigParse:o,lightConfigFill:r,lightConfigParse:a,realDataParse:f,rawDataParse:p,onlineStatusParse:v,collectStatusParse:T,decToHex:E,parseHistoryDataTime:_,parseTemperatureAndHumidity:m,m800RealDataParse:d,m8701wRealDataParse:g,sensorParse:u,wakeUpFlagParse:l}},function(e,t,n){"use strict";function r(e){return g>=(1===e?127:16129)&&(g=0),g++}function a(e){e=e||"";var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function i(){this.callStatusMap=new u.Map,this.protocolConfig={connectionTimeout:3e3,keepAlive:!0,keepAliveInterval:3e4,reconnectInterval:4e4,keepAliveFailedTimesReport:1,autoRespACK:!0},this.buildMsg=function(e){var t=new s.a;t.frameType=e.frameType,t.deviceType=e.deviceType,t.messageType=e.msgType,t.content=e.content,t.subVersion=e.subVersion,t.frameSequence=r(2),t.channelCode=a(e.networkDeviceId),d.log.i(h,"哈希code",t.channelCode);var n=t.data();return{key:f.default.buildKey(t.messageType,t.frameSequence),buffer:n}},this.handleResp=function(e,t){var n=new c.a,r=n.appendData(e);if(r&&r.length>0)for(var a=0;a<r.length;a++){var i=f.default.buildKey(r[a].messageType,r[a].frameType===l.a.FrameType.POST?0:r[a].frameSequence);t({key:i,buffer:r[a].content,dataObj:r[a],frameType:r[a].frameType,channelCode:r[a].channelCode})}},this.buildKeepAlive=function(e){},this.buildACK=function(e){var t=e;if(t)return t.frameType=l.a.FrameType.ACK,t.content=new ArrayBuffer(0),{key:"",buffer:f.default.buffer2Arr(e.data())}}}function o(){this.callStatusMap=new u.Map,this.respDv=new DataView(new ArrayBuffer(3072)),this.respBufIndex=0,this.protocolConfig={connectionTimeout:3e3,keepAlive:!0,keepAliveInterval:3e4,reconnectInterval:4e4,keepAliveFailedTimesReport:1,autoRespACK:!0},this.buildMsg=function(e){try{for(var t=r(1),n=f.default.buildKey(e.msgType,t),a=e.content||new ArrayBuffer(0),i=f.default.splitBufferBySeparator(a,y),s=new ArrayBuffer(0),c=0;c<i.length;c++){var u=new DataView(new ArrayBuffer(16+i[c].byteLength));o.buildHeader(t,i.length,c,e.deviceType,u),u.position=7,u.set1x(e.msgType);for(var l=new DataView(i[c]),p=0;p<i[c].byteLength;p++)u.set1x(l.get1x());o.buildEnder(u,i[c].byteLength),s=s.append(u.buffer)}return{key:n,buffer:s}}catch(e){d.log.e(h,"MedicaLANProtocol.buildMsg",e)}},this.handleResp=function(e,t){if(d.log.i(h,"handleResp-start",f.default.buffer2Arr(e)),e&&!(e.byteLength<=0))for(var n=e.byteLength,r=new DataView(e),a=0;a<n;a++){this.respDv.setInt8(this.respBufIndex,r.getInt8(a));var i=o.isEndMsg(this.respDv,this.respBufIndex);if(this.respBufIndex++,i){var s=new DataView(this.respDv.buffer.slice(0,this.respBufIndex));d.log.i(h,"handleResp-newDv",f.default.buffer2Arr(s.buffer));var c=s.getInt8(1),u=s.getInt8(2),g=s.getInt8(3);if(u>1&&g<u-1)d.log.i(h,"frameCount>1",u,g);else if(s.byteLength<16)this.respBufIndex=0;else{var y=p.default.crc32buf(s.buffer.slice(0,s.byteLength-8)),v=s.getInt32(s.byteLength-8);if(y===v){this.respBufIndex=0;var T=s.getInt16(5),E=s.getInt8(7),_=s.getInt8(4),m=f.default.buildKey(E,c===l.a.FrameType.POST?0:_),w=s.buffer.slice(7,s.byteLength-8);t({key:m,buffer:w,dataObj:{deviceType:T,frameType:c,frameCount:u,frameSeq:g,msgType:E,msgSeq:_,buffer:s.buffer},frameType:c})}else this.respBufIndex=0}}}},this.buildKeepAlive=function(e){},this.buildACK=function(e){var t=JSON.parse(JSON.stringify(e));if(t){t.frameType=l.a.FrameType.ACK;var n=new DataView(new ArrayBuffer(0));return o.buildHeader(t.msgSeq,1,0,t.deviceType,n),o.buildEnder(n,0),{key:"",buffer:n.buffer}}}}t.c=a,t.b=i,t.a=o;var s=n(21),c=n(27),u=n(6),f=n(1),l=n(3),p=n(14),d=n(2),g=1,h="tcpProtocol",y=[36,95,64,45];o.buildHeader=function(e,t,n,r,a){a.setInt8(0,0),a.setInt8(1,2),a.setInt8(2,t),a.setInt8(3,n),a.setInt8(4,e),a.setInt16(5,r)},o.buildEnder=function(e,t){var n=p.default.crc32buf(e.buffer.slice(0,8+t));e.position=8+t,e.set4x(n);for(var r=0;r<y.length;r++)e.set1x(y[r])},o.isEndMsg=function(e,t){return!(t<3)&&(e.getUint8(t)===y[3]&&e.getUint8(t-1)===y[2]&&e.getUint8(t-2)===y[1]&&e.getUint8(t-3)===y[0])}},function(module,__webpack_exports__,__webpack_require__){"use strict";function MedicaBle(config){this.conf=config||MedicaBle.getBleDefaultConfig(),this.DEVICE_CONNECTION_STATE=!1,this.waitSendQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingFlag=!1,this.invoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!0),this.sendInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!1),this.deviceType=void 0,this.deviceId=void 0,this.setMtuEnable=!1,this.mtu=20,this.maxMtu=503,this.defaultMtu=20,this.setConf=function(e){this.conf=e,this.baseBle=e.nativeBle,this.setMtuEnable=void 0!==e.connection.setMtu&&e.connection.setMtu},this.initBle=function(e,t,n){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-start",arguments),e=e||this.baseBle||Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)(),this.updateBaseBLE(e,t,n)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"initBle",arguments),MedicaBle.initFlag=!1,n&&n()}},this.openBluetoothAdapter=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-start"),"medica"===this.baseBle.$nativeName&&BLE_RET.platform.android===this.baseBle.getPlatform()&&this.baseBle.openBluetoothAdapter(function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-callback")}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-end")},this.onBluetoothAdapterStateChange=function(e,t){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothAdapterStateChange-start"),t&&(listenerInvoker.clear(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED),MedicaBle.registerBluetoothListeners(this.baseBle));var n=listenerInvoker.init(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,{ignoreTimeout:!0,handler:e});return __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothAdapterStateChange-end",n),n}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBluetoothAdapterStateChange",e)}},this.removeBluetoothAdapterStateListener=function(e){listenerInvoker.clearSingle(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,e),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"removeBluetoothAdapterStateListener-end",e)},this.onBLEConnectionStateChange=function(e,t){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-start",e);var n=listenerInvoker.init(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,e),{ignoreTimeout:!0,handler:t});return __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-end"),n}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBLEConnectionStateChange",e)}},this.removeConnectionStateListener=function(e,t){listenerInvoker.clearSingle(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,e),t),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"removeConnectionStateListener-end",t)},this.onBluetoothDeviceFound=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound-start"),this.invoker.clear(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY),this.invoker.init(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY,{ignoreTimeout:!0,handler:function(r){var a=r;if("string"==typeof r&&(a=JSON.parse(r)),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"discoveryCall-res",a),a)for(var i=0;i<a.length;i++){var o=parseDeviceInfo(a[i]);if(t&&"function"==typeof t){var s=t(o);if(s){n.stopBluetoothDevicesDiscovery();break}}if(e){var c=e(o);if(c){n.stopBluetoothDevicesDiscovery(),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound","stop-ret",c);break}}}}}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBluetoothDeviceFound",e)}},this.getBluetoothAdapterState=function(e){this.baseBle.getBluetoothAdapterState(function(t){MedicaBle.prototype.bleStatus=t,MedicaBle.prototype.bleEnable=t===BLE_RET.bleStatus.available,e&&e(t)})};var stopBleDiscoveryTimeout=null;this.startBluetoothDevicesDiscovery=function(e,t,n,r){this.stopBluetoothDevicesDiscovery();var a=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"startBluetoothDevicesDiscovery-start"),a.baseBle.startBluetoothDevicesDiscovery(e||this.conf.uuids.advertisServiceUUIDs,t,n||this.conf.discovery.interval),stopBleDiscoveryTimeout=setTimeout(function(){a.stopBluetoothDevicesDiscovery()},r||this.conf.discovery.timeout),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"startBluetoothDevicesDiscovery-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"startBluetoothDevicesDiscovery",e)}},this.scanBleDevices=function(e,t,n){var r=this;this.closeAllConnection(),this.baseBle.onBluetoothDeviceFound(function(e){r.invoker.invoke(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY,e)}),r.onBluetoothDeviceFound(n),setTimeout(function(){r.startBluetoothDevicesDiscovery(void 0,t,200,e)},100)},this.stopBluetoothDevicesDiscovery=function(){return stopBleDiscoveryTimeout&&(clearTimeout(stopBleDiscoveryTimeout),stopBleDiscoveryTimeout=null),this.baseBle.stopBluetoothDevicesDiscovery()},this.createBond=function(e,t,n,r){this.baseBle.createBond(e,t,n,r)},this.sendDataByTraditionalBT=function(e,t,n,r,a){this.baseBle.sendDataByTraditionalBT(e,t,n,r,a)},this.filterInit=function(e){this.baseBle.filterInit(e)},this.filterEnd=function(e){this.baseBle.filterEnd(e)},this.filterParse=function(e,t,n){this.baseBle.filterParse(e,t,n)},this.createBLEConnection=function(e,t,n){var r=this;try{var a="__createBLEConnectionCallback"+e;this.invoker.init(a,{timeout:t,handler:n}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-start",e,t);r.deviceId=e,r.baseBle.onBLEConnectionStateChange(function(t){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-callback",t);var n=t.deviceId,i=t.connected;MedicaBle.notifyConnectionState(r.deviceId,n,i),n===e&&(r.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,i,e),r.DEVICE_CONNECTION_STATE=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-invoke-end",i,e),i===BLE_RET.Boolean.True?(connPool.put(n,r),r.discoverServicesIfNeed(e,n)):(r.invoker.invoke(a,BLE_RET.connection.disconnected,n),r.DEVICE_CONNECTION_STATE=!1,connPool.remove(n)))}),setTimeout(function(){r.baseBle.createBLEConnection(e,t-180)},50),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"createBLEConnection",e)}},this.discoverServicesIfNeed=function(e,t){this.connectServerAndCharacteristic(e,t)},this.connectServerAndCharacteristic=function(deviceId,_deviceId){var that=this,key="__createBLEConnectionCallback"+deviceId;that.baseBle.discoverBLEServerAndCharacteristic(deviceId,that.conf.uuids.writeServiceUUID,that.conf.uuids.writeCharacteristUUID,function(){that.baseBle.discoverBLEServerAndCharacteristic(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,function(){that.baseBle.notifyBLECharacteristicValueChange(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,BLE_RET.Boolean.True,function(){that.baseBle.onBLECharacteristicValueChange(function(json){if(deviceId===json.deviceId){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLECharacteristicValueChange-arr",json.value);var _arr=[];"string"==typeof json.value?_arr=eval(json.value):json.value instanceof Array&&(_arr=json.value),that.handleCharacteristicValue(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(_arr))}}),that.setMtuEnable?setTimeout(function(){that.setMtu(function(){setTimeout(function(){that.invoker.invoke(key,BLE_RET.connection.connected,_deviceId)},20)})},200):setTimeout(function(){that.invoker.invoke(key,BLE_RET.connection.connected,_deviceId)},100)})})})},this.registerConnectionListener=function(deviceId){var that=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerConnectionListener-start",deviceId),that.deviceId=deviceId,MedicaBle.registerBluetoothListeners(that.baseBle),that.baseBle.onBLEConnectionStateChange(function(retObj){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-callback",retObj);var _deviceId=retObj.deviceId,_connected=retObj.connected;MedicaBle.notifyConnectionState(that.deviceId,_deviceId,_connected),_deviceId===deviceId&&(that.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,_connected,deviceId),that.DEVICE_CONNECTION_STATE=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-invoke-end",_connected,deviceId),_connected===BLE_RET.Boolean.True?(connPool.put(_deviceId,that),that.baseBle.notifyBLECharacteristicValueChange(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,BLE_RET.Boolean.True,function(){that.baseBle.onBLECharacteristicValueChange(function(json){if(deviceId===json.deviceId){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLECharacteristicValueChange-arr",json.value);var _arr=[];"string"==typeof json.value?_arr=eval(json.value):json.value instanceof Array&&(_arr=json.value),that.handleCharacteristicValue(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(_arr))}})})):(that.DEVICE_CONNECTION_STATE=!1,connPool.remove(_deviceId)))}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerConnectionListener-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"registerConnectionListener",e)}},this.connectDeviceOnce=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDeviceOnce-start",e,t);var r=1;t&&(r=t+1);var a="__connectDevice"+e;if(n.DEVICE_CONNECTION_STATE)return n.invoker.invoke(a,BLE_RET.connection.connected,e),null;n.createBLEConnection(e,n.conf.connection.oneTryTimeout||1e4,function(t){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-callback",t),t===BLE_RET.connection.connected?n.invoker.invoke(a,BLE_RET.connection.connected,e):n.invoker.getData(a)&&setTimeout(function(){n.connectDeviceOnce(e,r)},500)}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDeviceOnce-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"connectDeviceOnce",e)}},this.connectDevice=function(e,t,n,r){var a=this;try{if(r&&""!==r&&0!==r&&(this.deviceType=r),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-start",e,t),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-conf",this.deviceType,this.conf),e===this.deviceId&&this.DEVICE_CONNECTION_STATE)return n(BLE_RET.connection.connected,e),null;this.closeAllConnection(),this.setCurrentConnectionInstance(this);var i={deviceId:e,timeout:t||this.conf.connection.timeout,handler:n};a.deviceId=e;var o="__connectDevice"+e,s=a.invoker.getData(o);if(a.invoker.init(o,i),s)return null;a.connectDeviceOnce(e,0),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"connectDevice",e)}},this.sendOnePacket=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket-start",__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buffer2Arr(e),t);var r=1;t&&(r=t+1),n.baseBle.writeBLECharacteristicValue(this.deviceId,this.conf.uuids.writeServiceUUID,this.conf.uuids.writeCharacteristUUID,this.conf.write.writeResponse,__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buffer2Arr(e),function(t){"medica"===n.baseBle.$nativeName&&n.baseBle.getPlatform()===BLE_RET.platform.android&&t!==BLE_RET.status.suc&&r<=3&&setTimeout(function(){n.sendOnePacket(e,r)},100)}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendOnePacket",e)}},this.handleCharacteristicValue=function(e){var t=this;try{this.conf.protocol.handleResp(e,function(e){t.conf.protocol.resp&&(e.isPost?t.handlePostMsg(e):(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handleCharacteristicValue-invoke",e.key,BLE_RET.status.suc,e.buffer,e),t.sendInvoker.invoke(e.key,BLE_RET.status.suc,e.buffer,e)))},t.deviceType),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handleCharacteristicValue-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"handleCharacteristicValue",e)}},this.handlePostMsg=function(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handlePostMsg-data",e),this.invoker.invoke(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK,e)},this.sendPacket=function(e){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-start",e),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-conf",this.conf,this.deviceType,e),e.deviceType||(e.deviceType=this.deviceType);var t=this.conf.protocol.buildMsg(e);t.key&&this.sendInvoker.init(t.key,{handler:e.handler,timeout:e.timeout||this.conf.write.timeout}),e.mtu&&e.mtu>0&&(this.mtu=e.mtu),t.bufLen=t.buffer.byteLength,t.sentIndex=-1,t.tryTimes=0,t.bufArr=t.buffer.split(this.mtu),this.waitSendQueue.enqueue(t),this.sendAllQueue(!1),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-end",t)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendPacket",e)}},this.sendAllQueue=function(e){var t=this;try{if(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-start",arguments),!t.sendingFlag||e){if(t.sendingFlag=!0,t.waitSendQueue.count()<=0&&t.sendingQueue.count()<=0)return void(t.sendingFlag=!1);var n=t.waitSendQueue.front();t.sendingQueue.enqueue(n),t.waitSendQueue.dequeue(),t.sendOneMsg()}else __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-skin",t.sendingFlag,e);__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendAllQueue",e)}},this.sendOneMsg=function(){var e=this;try{if(e.sendingQueue.count()<=0)return void __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","count=0");var t=e.sendingQueue.front();__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","start",t);var n=t.bufArr;if(t.waitResp);else{var r=void 0;if("medica"===e.baseBle.$nativeName&&e.baseBle.getPlatform()===BLE_RET.platform.ios)r=3;else{n[0].byteLength;r=10}__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","_timeout",r);var a=0,i=setInterval(function(){var r=n.length;__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket",a),e.sendOnePacket(n[a++],0),a===r&&(e.handleSentMsg(t),clearInterval(i))},r)}__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendOneMsg",e)}},this.handleSentMsg=function(e){var t=this;this.conf.protocol.nextMsg(e,function(e){t.sendingQueue.dequeue(),t.sendAllQueue(!0)})},this.requestMtuOne=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"requestMtuOne-start",e);var r=0;null!=e&&(r=e+1);var a=!1;n.baseBle.setMTUSize.call(this,this.maxMtu,function(e){e.status===BLE_RET.Boolean.True&&e.mtu&&e.mtu>0?(n.mtu=e.mtu,t(BLE_RET.status.suc,e.mtu),a=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"setMTUSize-callback",e)):n.requestMtuOne(r,t)}),setTimeout(function(){a||(r>=4?t(BLE_RET.status.fail,n.defaultMtu):n.requestMtuOne(r,t))},1e3)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"requestMtuOne",e)}},this.setMtu=function(e){this.requestMtuOne(0,e)},this.registerPostMsgHanlder=function(e){this.invoker.clear(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK),this.invoker.init(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK,{ignoreTimeout:!0,handler:e})},this.closeConnection=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeConnection-start",this.deviceId,this.DEVICE_CONNECTION_STATE),this.deviceId&&(this.baseBle.closeBLEConnection(this.deviceId),this.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,BLE_RET.Boolean.False,this.deviceId)),this.sendInvoker.invokeAll(BLE_RET.status.timeout),this.DEVICE_CONNECTION_STATE=!1,this.waitSendQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingFlag=!1,this.sendInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!1),this.mtu=this.defaultMtu,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeConnection-end")},this.getConnectionState=function(){return this.DEVICE_CONNECTION_STATE},this.closeBluetoothAdapter=function(){this.baseBle.closeBluetoothAdapter()},this.getConnectionStateAsynchr=function(e,t){var n=this;this.deviceId=e,this.baseBle.getConnectedBluetoothDevices(function(e){for(var r=!1,a=0;a<e.length;a++)if(e[a].deviceId===n.deviceId){r=!0;break}n.DEVICE_CONNECTION_STATE=r,t(r)})}}function parseDeviceInfo(e){return e=JSON.parse(JSON.stringify(e)),e.advertisData&&e.advertisData instanceof Array&&e.advertisData.length>0?e.advertisData=__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(e.advertisData):e.advertisData=new ArrayBuffer(0),e.serviceData&&e.serviceData instanceof Array&&e.serviceData.length>0?e.serviceData=__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(e.serviceData):e.serviceData=new ArrayBuffer(0),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"parse-device-info",e),e}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_require__.d(__webpack_exports__,"BLE_RET",function(){return BLE_RET}),__webpack_require__.d(__webpack_exports__,"connPool",function(){return connPool}),__webpack_require__.d(__webpack_exports__,"currentConnectionInstance",function(){return currentConnectionInstance}),__webpack_exports__.MedicaBle=MedicaBle;var __WEBPACK_IMPORTED_MODULE_0__InvokerManager__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_1__bufUtil__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_2__queue__=__webpack_require__(20),__WEBPACK_IMPORTED_MODULE_3__medica_ble_protocol__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_4__log_config__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_5__Constants__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_6__map__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_7__init_ble_native__=__webpack_require__(28),logTip="bleWrap",DEFAULT_BLE_CONFIG={nativeBle:void 0,discovery:{allowDuplicatesKey:!1,interval:100,timeout:3e4},connection:{timeout:3e4,oneTryTimeout:1e4,setMtu:!1},write:{timeout:3e3,writeResponse:!1},uuids:{writeServiceUUID:"0000ffe5-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyServiceUUID:"0000ffe0-0000-1000-8000-00805f9b34fb".toUpperCase(),writeCharacteristUUID:"0000ffe9-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyCharacteristUUID:"0000ffe4-0000-1000-8000-00805f9b34fb".toUpperCase(),advertisServiceUUIDs:["0000fff0-0000-1000-8000-00805f9b34fb".toUpperCase(),"0000ffb0-0000-1000-8000-00805f9b34fb".toUpperCase()]},protocol:void 0},ON_BLE_EVENT_NAME=__WEBPACK_IMPORTED_MODULE_5__Constants__.default.ON_BLE_EVENT_NAME,BLE_RET=__WEBPACK_IMPORTED_MODULE_5__Constants__.default.BLE_RET,connPool=new __WEBPACK_IMPORTED_MODULE_6__map__.Map,currentConnectionInstance=void 0;MedicaBle.prototype.baseBle=null,MedicaBle.prototype.updateBaseBLE=function(e,t,n){this.baseBle!==e?(MedicaBle.prototype.baseBle=e,MedicaBle.initBle(e,!0,n)):t?MedicaBle.initBle(e,!0,n):n&&n(MedicaBle.prototype.bleStatus)},MedicaBle.prototype.getConnectedDeviceId=function(){for(var e=connPool.keySet(),t=0;t<e.length;t++){var n=connPool.get(e[t]);if(n&&n.DEVICE_CONNECTION_STATE)return n.deviceId}},MedicaBle.prototype.closeAllConnection=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeAllConnection-start");for(var e=connPool.keySet(),t=0;t<e.length;t++){var n=e[t];connPool.get(n).closeConnection(),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeAllConnection",n)}},MedicaBle.prototype.getCurrentConnectionInstance=function(){return currentConnectionInstance},MedicaBle.prototype.setCurrentConnectionInstance=function(e){currentConnectionInstance=e||this},MedicaBle.getBleDefaultConfig=function(e){var t=JSON.parse(JSON.stringify(DEFAULT_BLE_CONFIG));return t.protocol=new __WEBPACK_IMPORTED_MODULE_3__medica_ble_protocol__.MedicaProtocol1,t.nativeBle=Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)(),t},MedicaBle.defaultBleNative=Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)();var listenerInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!0);MedicaBle.registerBluetoothListeners=function(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerBluetoothListeners-start",e),e.onBluetoothAdapterStateChange(function(e){var t=e===BLE_RET.Boolean.True,n=t!==MedicaBle.prototype.bleEnable;MedicaBle.prototype.bleStatus=t?0:1,MedicaBle.prototype.bleEnable=t,t||connPool.forEach(function(e){e&&(e.DEVICE_CONNECTION_STATE=!1)}),n&&listenerInvoker.invoke(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,t)})},MedicaBle.notifyConnectionState=function(e,t,n){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"notifyConnectionState",e,t,n,__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,t));var r=n===BLE_RET.Boolean.True;if(listenerInvoker.invoke(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,t),r),e&&t&&e!==t){var a=connPool.get(t);if(a){a.DEVICE_CONNECTION_STATE=r;var i="__createBLEConnectionCallback"+t;a.invoker.invoke(i,r,t),r||connPool.remove(t)}}},MedicaBle.initFlag=!1,MedicaBle.initBle=function(e,t,n){try{if(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-start"),!t&&MedicaBle.initFlag)return void e.getBluetoothAdapterState(function(e){MedicaBle.prototype.bleStatus=e,MedicaBle.prototype.bleEnable=e===BLE_RET.bleStatus.available,n&&n(e)});MedicaBle.initFlag=!0,MedicaBle.registerBluetoothListeners(e),e.initializeBluetoothAdapter(function(){e.getBluetoothAdapterState(function(e){MedicaBle.prototype.bleStatus=e,MedicaBle.prototype.bleEnable=e===BLE_RET.bleStatus.available,n&&n(e)})}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"initBle",e)}}},function(e,t,n){"use strict";function r(e,t){this.timeoutCode=9009,this.cache=new a.default.Map,this.defaultTimeout=e||5e3,this.enableMulti=t||!1,this.init=function(e,t){var n=t,r=void 0;n.createTime=(new Date).getTime(),i.log.i("invoker.init.createTime:",e,this.enableMulti,n.createTime);var s=this.cache.get(e);s||(s=new a.default.Map);var c=e+"_"+Object(o.randomNum)(1e6,9999999);return s.put(c,n),this.cache.put(e,s),r=c,i.log.i("InvokerManager","init",r),r},this.invoke=function(){try{for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=this.cache.get(r);if(i.log.i("InvokerManager.invoke.start:",t[0],this.cache,this.cache.containsKey(r)),a&&a.size()>0){var o=a.keySet();for(var c in o){var u=a.get(o[c]);if(u&&u.handler)try{u.handler.apply(null,t.length>1?t.slice(1):[]),i.log.i(s,"invoke-end:",r,o[c],u.createTime)}catch(e){console.error(s,"_data.handler.invoker.invoke:",e)}u&&u.ignoreTimeout||(a.remove(o[c]),this.cache.put(r,a))}}else i.log.i("InvokerManager","not find the handler by ",r),this.cache.remove(r)}catch(e){console.error("InvokerManager","invoker.ERROR:",e)}},this.invokeSingle=function(){try{for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=this.cache.get(r);if(o&&o.size()>0){for(var c=o.keySet(),u=0;u<c.length;u++)if(c[u]===a){var f=o.get(c[u]);if(f&&f.handler)try{f.handler.apply(null,t.length>2?t.slice(2):[]),i.log.i(s,"invokeSingle-end:",r,c[u],f.createTime)}catch(e){console.error(s,"_data.handler.invoker.invoke:",e)}if(f&&f.ignoreTimeout)continue;o.remove(c[u]),this.cache.put(r,o)}}else this.cache.remove(r)}catch(e){console.error("InvokerManager","invoker.ERROR:",e)}},this.invokeAll=function(){for(var e=this.cache.keySet(),t=[],n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];for(var i=0;i<r.length;i++)t.push(r[i]);for(var o=0;o<e.length;o++){var s=e[o];t.unshift(s),this.invoke(t)}},this.getData=function(e){var t=this.getDatas(e);if(t&&t.size()>0)return t.values()[0]},this.getDatas=function(e){return this.cache.get(e)},this.existData=function(e){return!this.cache.get(e)},this.clear=function(e){e?this.cache.remove(e):this.cache=new a.default.Map},this.clearSingle=function(e,t){i.log.i(s,"clearSingle",e);var n=this.cache.get(e);n&&(n.remove(t),i.log.i(s,"clearSingle-end",t))},this.size=function(e){if(e){var t=this.cache.get(e);return t?t.size():0}return this.cache.size()},this.invokeTimeout=function(){var e=this;setInterval(function(){for(var t=e.cache.keySet(),n=0;n<t.length;n++){var r=t[n],a=e.cache.get(r);if(a&&a.size()>0)for(var o=a.keySet(),c=0;c<o.length;c++){var u=o[c],f=a.get(u);if((!f||!f.ignoreTimeout)&&(f&&f.handler)){var l=f.timeout?f.timeout:e.defaultTimeout,p=f.createTime;if((new Date).getTime()-p>=l){try{var d=f.tryTimes?f.tryTimes+1:1;f.tryTimes=d,i.log.i(s,"timeout-invoke",u,f),f.handler(e.timeoutCode,f)}catch(e){i.log.e(s,"timeout-invoke-err",e)}a.remove(u),e.cache.put(r,a)}}}else e.cache.remove(r)}},500)},this.invokeTimeout()}Object.defineProperty(t,"__esModule",{value:!0}),t.InvokerManager=r;var a=n(6),i=n(2),o=n(4),s="InvokerManager"},function(e,t,n){"use strict";function r(){this.conf=_,this.invoker=new f.InvokerManager(3e3,!0)}t.a=r;var a=n(11),i=n(7),o=n(2),s=n(1),c=n(0),u=n(4),f=n(12),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=[],d=[],g=[],h=[],y=[],v=[],T=[],E="bleCommonApi2",_=a.MedicaBle.getBleDefaultConfig();_.protocol=new i.MedicaProtocol2,r.prototype=new a.MedicaBle,r.prototype.getDeviceInfo=function(e){this.getDeviceSystemInfo(e)},r.prototype.parsePost=function(e){if(e){var t=s.default.buffer2Arr(e.buffer);o.log.i(E,"parsePost msgType:"+e.msgType+", buffer:",e.buffer);var n=!1;switch(e.msgType){case 26:var r=t[0],a=-1;if(0==r&&(a=t[1]),p)for(var i=0,c=p.length;i<c;i++)p[i]?p[i](r,a):(p.splice(i,1),i--,c=p.length);break;case 28:var u=new DataView(e.buffer.slice(11,e.buffer.byteLength)),f=u.get1x(),l=u.get1x();if(g)for(var _=0,m=g.length;_<m;_++)if(g[_]){var w=g[_](f,l);n=w||n}else g.splice(_,1),_--,m=g.length;break;case 7:for(var x=new DataView(e.buffer.slice(11,e.buffer.byteLength)),D=(x.get4x(),x.get2x(),255&x.get2x()),b=255&x.get1x(),A=new Array,C=0;C<b;C++){A[C]=new Array;for(var S=0;S<2;S++)A[C][S]=x.get1x()}for(var B=new Array,I=0;I<D;I++){B[I]=new Array;for(var M=0;M<b;M++)switch(A[M][1]){case 1:B[I][M]=255&x.get1x();break;case 2:B[I][M]=65535&x.get2x();break;case 4:B[I][M]=x.get4x()}}for(var O=new Array,V=0,R=B.length;V<R;V++){for(var P={},N=0;N<B[V].length;N++)switch(A[N][0]){case 0:P.breathRate=B[V][N];break;case 1:P.heartRate=B[V][N];break;case 2:P.status=B[V][N];break;case 3:P.statusValue=B[V][N];break;case 48:case 49:case 50:break;case 5:P.sleepFlag=B[V][N];break;case 6:P.wakeFlag=B[V][N];break;case 16:P.temp=100*B[V][N];break;case 17:P.humidity=B[V][N]}O[V]=P}var k=s.default.buildKey(e.msgType,0);if(this.invoker.invoke(k,O),d)for(var L=0,U=d.length;L<U;L++)d[L]?d[L](O):(d.splice(L,1),L--,U=d.length);break;case 5:for(var F=new DataView(e.buffer.slice(11,e.buffer.byteLength)),Y=F.get1x(1),q=[],W=0;W<Y;W++)q[W]={},q[W].status=F.get1x(1),q[W].Value=F.get1x(1);if(h)for(var G=0,j=h.length;G<j;G++)if(h[G]){var K=h[G](q);n=K||n}else h.splice(G,1),G--,j=h.length;o.log.i(E,"resACK",n,e);break;case 29:for(var H=new DataView(e.buffer.slice(11,e.buffer.byteLength)),X=(H.get4x(),H.get2x(),255&H.get2x()),z=new Array,Z=0;Z<X;Z++)z.push(H.get2x());if(y)for(var J=0,Q=y.length;J<Q;J++)y[J]?y[J](z):(y.splice(J,1),J--,Q=y.length);break;case 64:for(var $=new DataView(e.buffer.slice(11,e.buffer.byteLength)),ee=$.get1x(),te=[],ne=0;ne<ee;ne++){var re={id:$.get1x(1),enable:$.get1x(1),smartOpen:$.get1x(1),smartOffset:$.get1x(1),hour:$.get1x(1),minute:$.get1x(1),repeat:$.get1x(1),snoozeCount:$.get1x(1),snoozeLength:$.get1x(1),volume:$.get1x(1),brightness:$.get1x(1),musicId:$.get2x(1),timestamp:$.get4x(1),invalid:$.get1x(1)};1==re.invalid&&te.push(re)}if(console.log("alarmStatusCallback---------",T.length),T)for(var ae=0,ie=T.length;ae<ie;ae++)T[ae]?T[ae](te):(T.splice(ae,1),ae--,ie=T.length);break;case 68:var oe=new DataView(e.buffer.slice(11,e.buffer.byteLength)),se={};if(se.alarmStatus=oe.get1x(1),se.sleepAidStatus=oe.get1x(1),se.sleepAidMusictStatus=oe.get1x(1),se.sleepAidVolume=oe.get1x(1),se.sleepAidMusicId=oe.get2x(1),se.sleepAidLeave=oe.get1x(1),se.loop=oe.get1x(1),se.blePin=oe.get1x(1),se.bleStatus=oe.get1x(1),se.bleVolume=oe.get1x(1),se.musicDuration=oe.get4x(1),se.musicProgress=oe.get4x(1),v)for(var ce=0,ue=v.length;ce<ue;ce++)v[ce]?v[ce](se):(v.splice(ce,1),ce--,ue=v.length)}n&&this.sendMsgAck(e.msgType,e.frameSeq,!0===n?0:n)}},r.prototype.registCollectionStatusCallback=function(e){if(e&&"function"==typeof e){var t=h.length;h[t]=e}},r.prototype.unRegistCollectionStatusCallback=function(e){if(e&&"function"==typeof e)for(var t=h.length,n=0;n<t;n++)if(h[n]==e){h.splice(n,1);break}},r.prototype.registDeviceStatusCallback=function(e){if(e&&"function"==typeof e){var t=p.length;p[t]=e}},r.prototype.unregistDeviceStatusCallback=function(e){if(e&&"function"==typeof e)for(var t=p.length,n=0;n<t;n++)if(p[n]==e){p.splice(n,1);break}},r.prototype.registDeviceWorkModeCallback=function(e){if(e&&"function"==typeof e){var t=v.length;v[t]=e}},r.prototype.unRegistDeviceWorkModeCallback=function(e){if(e&&"function"==typeof e)for(var t=v.length,n=0;n<t;n++)if(v[n]==e){v.splice(n,1);break}},r.prototype.registDeviceAlarmStatusCallback=function(e){if(e&&"function"==typeof e){var t=T.length;T[t]=e,console.log("registalarmStatusCallback---------",T)}},r.prototype.registRealtimeDataCallback=function(e){if(e&&"function"==typeof e){var t=d.length;d[t]=e}o.log.i(E,"registRealtimeDataCallback",e,d)},r.prototype.registRealtimeDataWithId=function(e){var t=s.default.buildKey(7,0);this.invoker.init(t,{ignoreTimeout:!0,handler:e}),o.log.i(E,"registRealtimeDataWithId",e,d)},r.prototype.unregistRealtimeDataCallback=function(e){if(e&&"function"==typeof e)for(var t=d.length,n=0;n<t;n++)if(d[n]==e){d.splice(n,1);break}o.log.i(E,"unregistRealtimeDataCallback",e,d)},r.prototype.unregistRealtimeDataWithId=function(e){var t=s.default.buildKey(7,0);this.invoker.clearSingle(t,e),o.log.i(E,"unregistRealtimeDataWithId",callback,d)},r.prototype.registOriginalDataCallback=function(e){if(e&&"function"==typeof e){var t=y.length;y[t]=e}o.log.i(E,"registOriginalDataCallback",e,y)},r.prototype.unregistOriginalDataCallback=function(e){if(e&&"function"==typeof e)for(var t=y.length,n=0;n<t;n++)if(y[n]==e){y.splice(n,1);break}o.log.i(E,"unregistOriginalDataCallback",e,y)},r.prototype.registElectCallback=function(e){if(e&&"function"==typeof e){var t=g.length;g[t]=e}o.log.i(E,"registElectCallback",e,g)},r.prototype.unregistElectCallback=function(e){if(e&&"function"==typeof e)for(var t=g.length,n=0;n<t;n++)if(g[n]==e){g.splice(n,1);break}o.log.i(E,"unregistElectCallback",e,g)},r.prototype.login=function(e){for(var t=new ArrayBuffer(30),n=new DataView(t),r=s.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<13;i++)n.set1x(a.byteLength>i?a.getInt8(i):0);var o=new Date,u=parseInt(o.valueOf()/1e3),f=-60*o.getTimezoneOffset();n.set4x(e.timestamp||u),n.set1x(2),n.set1x(2),n.set1x(4),n.set1x(3),n.set1x(4),n.set4x(e.userId),n.set4x(e.timezone||f),e.content=n.buffer,this.sendMsgOperation(0,c.FRAME_TYPE.Request,e)},r.prototype.postNotify=function(e){var t=new ArrayBuffer(3),n=new DataView(t);n.set1x(1),n.set1x(e.operationType),n.set1x(e.value||0),e.content=n.buffer,this.sendMsgOperation(6,c.FRAME_TYPE.POST,e)},r.prototype.querySummery=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(9,c.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});t.count=e.getUint16(13),t.dataList=new Array;for(var n=0;n<t.count;n++){var r={};r.startTime=e.getUint32(11*n+15),r.timeStep=e.getUint16(11*n+15+4),r.recordCount=e.getUint32(11*n+15+4+2),r.stopMode=e.getUint8(11*n+15+4+2+4),t.dataList.push(r)}return t})},r.prototype.downloadHistoryData=function(e){var t=new ArrayBuffer(19),n=new DataView(t);n.set4x(e.starttime),n.set4x(e.offset),n.set2x(e.count),n.set1x(4),n.set1x(0),n.set1x(1),n.set1x(1),n.set1x(1),n.set1x(2),n.set1x(1),n.set1x(3),n.set1x(1),e.content=n.buffer,this.sendMsgOperation(11,c.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.heartRate=[],t.breathRate=[],t.status=[],t.statusValue=[];for(var n=0;n<t.count;n++)t.breathRate[n]=e.getUint8(4*n+31),t.heartRate[n]=e.getUint8(4*n+31+1),t.status[n]=e.getUint8(4*n+31+1+1),t.statusValue[n]=e.getUint8(4*n+31+1+1+1);return t})},r.prototype.sleepDataSummary=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.starttime),n.set4x(e.endtime),n.set1x(e.type),n.set1x(e.sort),e.content=n.buffer,this.sendMsgOperation(48,c.FRAME_TYPE.Request,e,function(e){e.position=12;for(var t={total:e.get2x(1),summaryList:[]},n=e.get1x(1),r=0;r<n;r++){var a=e.get4x(1),i=e.get2x(1),o=e.get4x(1),c=e.get1x(1),u=s.default.ab2str(e.buffer.slice(e.position,e.position+=12),!0);t.summaryList.push({startTime:a,timeStep:i,recordCount:o,stopMode:c,firmwareVers:u})}return t})},r.prototype.sleepDataSummaryAll=function(e){function t(n,a){o.sleepDataSummary(l({},n,{_retryTimes:3,_retryInterval:100,handler:function(i,o){if(i===c.BLE_RET.status.suc){var f=o.summaryList;if(s=s.concat(f),a&&(u=o.total),f.length>=88)if(r){var p=f[f.length-1];t(l({},n,{starttime:p.startTime+1+p.recordCount*p.timeStep}))}else t(l({},n,{endtime:f[f.length-1].startTime-1}));else e.handler(i,{summaryList:s,total:u})}else e.handler(i)}}))}var n=e.type,r=e.sort,a=e.starttime,i=e.endtime,o=this,s=[],u=void 0;t({starttime:a,endtime:i,type:n,sort:r},!0)},r.prototype.sleepDataMark=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set4x(e.starttime),n.set4x(e.endtime),n.set1x(e.syncState),e.content=n.buffer,this.sendMsgOperation(49,c.FRAME_TYPE.Request,e)},r.prototype.downloadNewPillowHistoryData=function(e){var t=this,n=function(n,r){if(o.log.i(E,"downloadNewP200aHistoryData, ",n,r),n!=c.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.summaryList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(c.BLE_RET.status.suc,[]);var i=[],s=function(t,n){n.summary=a[t];var r=void 0;return e.everyReportHandle&&(r=e.everyReportHandle(t,a.length,n),i.push(n)),r};o.log.i(E,"downloadP200aReports start");var u=function(t){o.log.i(E,"downloadP200aReports complete"),e.completion&&e.completion(t,i)};t.downloadP200aReports(a,e.evDataEnable,0,s,u,e.zip,e.maxPointOnce)},r={starttime:e.startTime,endtime:e.endTime,type:e.type,sort:e.sort,handler:n};this.sleepDataSummaryAll(r)},r.prototype.getVersionInfo=function(e){this.sendMsgOperation(20,c.FRAME_TYPE.Request,e,function(e){var t={};return t.hardMajor=e.getUint8(12),t.hardMinor=e.getUint8(13),t.softMajor=e.getUint8(14),t.softMinor=e.getUint8(15),t})},r.prototype.sendUpdateSummery=function(e){var t=new ArrayBuffer(17),n=new DataView(t);n.set1x(0),n.set1x(e.hardMajor),n.set1x(e.hardMinor),n.set1x(e.softMajor),n.set1x(e.softMinor),n.set4x(e.length),n.set4x(e.encryCrc),n.set4x(e.originCrc),e.content=n.buffer,this.sendMsgOperation(21,c.FRAME_TYPE.Request,e,function(e){return e.getUint16(12)})},r.prototype.sendUpdateDetail=function(e){var t=new ArrayBuffer(7+e.bufferArr.length),n=new DataView(t);n.set1x(1),n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set1x(e.bufferArr[r]);e.content=n.buffer,this.sendMsgOperation(21,c.FRAME_TYPE.Request,e,function(e){return e.getUint16(12)})},r.prototype.setCollectStatus=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set4x(e.timestamp),n.set1x(e.status),e.content=n.buffer,this.sendMsgOperation(25,c.FRAME_TYPE.Request,e)},r.prototype.getCollectStatus=function(e){this.sendMsgOperation(26,c.FRAME_TYPE.Request,e,function(e){return e.getUint8(12)})},r.prototype.getCollectState=function(e){this.sendMsgOperation(26,c.FRAME_TYPE.Request,e,function(e){var t=e.getUint8(12),n=void 0;return e.byteLength>=17&&(n=e.getUint32(13)),{status:t,timestamp:n}})},r.prototype.getDeviceSystemInfo=function(e){e.content=new ArrayBuffer(0),this.sendMsgOperation(27,c.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});return t.hardMajor=String.fromCharCode(e.getUint8(12)),t.hardMinor=String.fromCharCode(e.getUint8(13)),t.hardVersion=t.hardMajor+"."+t.hardMinor,t.softMajor=e.getUint8(14),t.softMinor=e.getUint8(15),t.softVersion=Object(u.padStart)(t.softMajor,1)+"."+Object(u.padStart)(t.softMinor),t.producedDate=e.getUint32(16),t.deviceId=s.default.buf2string(e.buffer.slice(20,33)),t})},r.prototype.getBattery=function(e){this.sendMsgOperation(28,c.FRAME_TYPE.Request,e,function(e){var t={};return t.status=e.getUint8(12),t.battery=e.getUint8(13),t})},r.prototype.setAutoMonitor=function(e){var t=new ArrayBuffer(4),n=new DataView(t);n.set1x(e.flag),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.weekday),e.content=n.buffer,this.sendMsgOperation(30,c.FRAME_TYPE.Request,e)},r.prototype.getAutoMonitor=function(e){this.sendMsgOperation(31,c.FRAME_TYPE.Request,e,function(e){var t={};return t.flag=e.getUint8(12),t.hour=e.getUint8(13),t.minute=e.getUint8(14),t.weekday=e.getUint8(15),t})},r.prototype.setSmartClock=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set1x(e.flag),n.set1x(e.offset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.weekday),e.content=n.buffer,this.sendMsgOperation(32,c.FRAME_TYPE.Request,e)},r.prototype.getSmartClock=function(e){this.sendMsgOperation(33,c.FRAME_TYPE.Request,e,function(e){var t={};return t.flag=e.getUint8(12),t.offset=e.getUint8(13),t.hour=e.getUint8(14),t.minute=e.getUint8(15),t.weekday=e.getUint8(16),t})},r.prototype.getFullAutoHistoryData=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsgOperation(38,c.FRAME_TYPE.Request,e,function(t){var n={};t.position=12;t.get1x();n.starttime=t.get4x(1),n.offset=t.get4x(1),n.count=t.get2x(1),n.data1=[],n.data2=[],n.data3=[],n.data4=[],o.log.i("getFullAutoHistoryData",e,t);for(var r=t.position,a=0;a<n.count;a++){var i=t.getUint32(r,!0)<<0;r+=4;var s=t.getUint8(r++);n.data1[a]=i,n.data2[a]=-1,n.data3[a]=Number("0x"+s.toString(16)+"ffffff")<<0,n.data4[a]=-1}return n})},r.prototype.getSensorStatus=function(e){this.sendMsgOperation(82,c.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,console.log(e.buffer.toArray()),t.status=e.get1x(),t.time=e.get4x(1),t})},r.prototype.sendMsgOperation=function(e,t,n,r){var a=n._retryTimes||1,i=n._retryInterval,s=this,u={content:n.content||new ArrayBuffer(0),timeout:n.timeout||1e4,msgType:e,frameType:t,handler:function(e,t,f){o.log.i(E,"this.sendMsgOperation========== code:"+e+"result:"+JSON.stringify(f));var l;if(e!=c.BLE_RET.status.suc)a--,a<1||!s.DEVICE_CONNECTION_STATE?n.handler&&n.handler(e):i&&i>0?setTimeout(function(){o.log.i(E,"sendMsgOperation retry",e,a,i),s.sendPacket(u)},i):(o.log.i(E,"sendMsgOperation retry",a,i),s.sendPacket(u));else if(n.handler){null==t&&(t=new ArrayBuffer(0));var p,d=new DataView(t);p=f.frameType==c.FRAME_TYPE.ACK?d.getInt8(8):d.getInt8(11),0!=p?n.handler(e,void 0,p):r?(l=r(d),n.handler(c.BLE_RET.status.suc,l)):n.handler(c.BLE_RET.status.suc)}}};this.sendPacket(u)},r.prototype.sendMsgAck=function(e,t,n){var r=new ArrayBuffer(1);new DataView(r).set1x(n);var a={resCode:n,timeout:1e3,msgType:e,frameType:c.FRAME_TYPE.ACK,frameSeq:t};this.sendPacket(a)}},function(e,t,n){"use strict";function r(e){var t=0,n=0,r=0;t^=-1;for(var i=new Int8Array(e),o=0,s=i.byteLength;o<s;o++)n=255&(t^i[o]),r="0x"+a.substr(9*n,8),t=t>>>8^r;return-1^t}Object.defineProperty(t,"__esModule",{value:!0}),t.crc32buf=r;var a="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";t.default={crc32buf:r}},function(e,t,n){"use strict";function r(e){var t=0;t=255&~t;for(var n=new Int8Array(e),r=0;r<n.byteLength;r++){n[r];t=255&a[255&(t^n[r])]}return 255&~t}Object.defineProperty(t,"__esModule",{value:!0}),t.crc8buf=r;var a=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243]},function(e,t,n){"use strict";function r(){this.conf=l}t.a=r;var a=n(11),i=n(7),o=n(1),s=n(3),c=n(2),u=n(4),f="bleCommonApi3",l=a.MedicaBle.getBleDefaultConfig();l.protocol=new i.MedicaProtocol3,r.prototype=new a.MedicaBle,r.prototype.TCP_Consts=s.a,r.prototype.getDeviceInfo=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=514,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),f=0;f<14;f++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x();var l=a.currentHardVersion;a.currVersion=Object(u.padStart)(parseInt(l/100),1,0)+"."+Object(u.padStart)(parseInt(l%100));var p=a.factoryHardVersion;a.facVersion=Object(u.padStart)(parseInt(p/100),1,0)+"."+Object(u.padStart)(parseInt(p%100)),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(),a.busineesCooperationNumber=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.getWifiStatus=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=1184,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.getWifiConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=929,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(33),c=new DataView(i),u=0,f=0;f<33;f++){var l=n.get1x();0==l&&0==u&&(u=f),c.set1x(l)}a.ssid=o.default.ab2str(c.buffer.slice(0,u)),a.encrypType=n.get1x();var p=new ArrayBuffer(65),d=new DataView(p);u=0;for(var g=0;g<65;g++){var h=n.get1x();0==h&&0==u&&(u=g),d.set1x(h)}a.password=o.default.ab2str(d.buffer.slice(0,u)),a.ipType=n.get1x(),a.staticIp=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.subnetMask=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.gateWay=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns1=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns2=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.wifiConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=928,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(120),n=new DataView(t),r=null;if(e.ssidRaw){var a=null;a=e.ssidRaw.constructor==Array?e.ssidRaw:JSON.parse(e.ssidRaw),r=o.default.arr2Buffer(a)}else r=o.default.str2ab(e.ssid);for(var i=new DataView(r),u=0;u<33;u++)u<r.byteLength?n.set1x(i.get1x()):n.set1x(0);n.set1x(1);for(var l=o.default.str2ab(e.password),p=new DataView(l),d=0;d<65;d++)d<l.byteLength?n.set1x(p.get1x()):n.set1x(0);n.set1x(0);for(var g=0;g<20;g++)n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"wifiConfig",e)}},r.prototype.serverConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=930,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;for(var t=new ArrayBuffer(162),n=new DataView(t),r=o.default.str2ab(e.ip),a=new DataView(r),i=0;i<32;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.port);for(var u=o.default.str2ab(e.http||""),l=new DataView(u),p=0;p<128;p++)p<u.byteLength?n.set1x(l.get1x()):n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"serverConfig",e)}},r.prototype.getServerConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=931,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(32),c=new DataView(i),u=0,f=0;f<32;f++){var l=n.get1x();0==l&&0==u&&(u=f),c.set1x(l)}a.ip=o.default.ab2str(c.buffer.slice(0,u)),a.port=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"getServerConfig",e)}},r.prototype.getWifiMac=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=935,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"getServerConfig",e)}},r.prototype.registerPostMsgHanlder(function(e){}),r.prototype.loginByUser=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=512,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.connectType||0),n.set4x(e.userId),n.setStr(e.password),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get4x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.checkTime=function(e){e.handler(0,{})},r.prototype.sendUpdateSummery=function(e){try{e.frameType=s.a.FrameType.POST,e.msgType=1284,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(17),n=new DataView(t);n.set2x(e.devType||e.deviceType),n.set1x(e.hardType),n.set2x(e.hardVersion),n.set4x(e.length),n.set4x(e.encryCrc),n.set4x(e.originCrc),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"sendUpdateSummery",e)}},r.prototype.sendUpdateDetail=function(e){try{e.frameType=s.a.FrameType.POST,e.msgType=1285,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(6+e.bufferArr.length),n=new DataView(t);n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set1x(e.bufferArr[r]);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"sendUpdateDetail",e)}},r.prototype.sendMsg=function(e,t,n){c.log.i(f,"sendMsg-start",e,o.default.buffer2Arr(t),this);try{this.sendPacket({frameType:e.frameType,deviceType:e.deviceType||this.deviceType,msgType:e.msgType,content:t,subVersion:e.subVersion||0,timeout:e.timeout,handler:function(e,t,r){if(e===s.a.RET.Succeed&&t&&t.byteLength>0){var a=new DataView(t),i=a.get2x();0===i?n(s.a.RET.Succeed,a,r):n(i,a,r)}else n(s.a.RET.Timeout,void 0)}})}catch(e){c.log.e(f,"sendMsg",e)}}},function(e,t,n){"use strict";function r(){this.conf=f,this.deviceType=a.DEVICE_TYPE.ZP100}Object.defineProperty(t,"__esModule",{value:!0}),t.ZP100BleApi=r,n.d(t,"zp100BleApi",function(){return p});var a=n(0),i=n(40),o=n(4),s=n(1),c=n(11),u=n(7),f=c.MedicaBle.getBleDefaultConfig();f.protocol=new u.MedicaProtocol2;var l={writeServiceUUID:"0000ffe5-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyServiceUUID:"0000ffe0-0000-1000-8000-00805f9b34fb".toUpperCase(),writeCharacteristUUID:"0000ffe9-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyCharacteristUUID:"0000ffe4-0000-1000-8000-00805f9b34fb".toUpperCase(),newwriteServiceUUID:"0000ffa5-0000-1000-8000-00805f9b34fb".toUpperCase(),newnotifyServiceUUID:"0000ffa0-0000-1000-8000-00805f9b34fb".toUpperCase(),newwriteCharacteristUUID:"0000ffa9-0000-1000-8000-00805f9b34fb".toUpperCase(),newnotifyCharacteristUUID:"0000ffa4-0000-1000-8000-00805f9b34fb".toUpperCase(),advertisServiceUUIDs:["0000fff0-0000-1000-8000-00805f9b34fb".toUpperCase(),"0000ffb0-0000-1000-8000-00805f9b34fb".toUpperCase()]};f.uuids=l,r.prototype=new i.P200aBleApi,r.prototype.discoverServicesIfNeed=function(e,t){this.conf.uuids=JSON.parse(JSON.stringify(l));var n=this;"medica"===this.baseBle.$nativeName?this.baseBle.getPlatform()===c.BLE_RET.platform.ios?this.baseBle.getBLEDeviceServices(e,function(r){if(r.status==c.BLE_RET.Boolean.True){console.log("getBLEDeviceServices----",r.data.services,r.data.services.length);for(var a=r.data.services,i=0;i<a.length;i++){var o=a[i];if(o==l.newwriteServiceUUID||o==l.newnotifyServiceUUID){n.conf.uuids.writeServiceUUID=l.newwriteServiceUUID,n.conf.uuids.notifyServiceUUID=l.newnotifyServiceUUID,n.conf.uuids.writeCharacteristUUID=l.newwriteCharacteristUUID,n.conf.uuids.notifyCharacteristUUID=l.newnotifyCharacteristUUID;break}}n.connectServerAndCharacteristic(e,t)}else n.connectServerAndCharacteristic(e,t)}):n.baseBle.discoverBLEServerAndCharacteristic(e,null,null,function(r){if(r&&r.data)for(var a=Object.keys(r.data),i=0;i<a.length;i++){var o=a[i].toUpperCase();if(o==l.newwriteServiceUUID||o==l.newnotifyServiceUUID){n.conf.uuids.writeServiceUUID=l.newwriteServiceUUID,n.conf.uuids.notifyServiceUUID=l.newnotifyServiceUUID,n.conf.uuids.writeCharacteristUUID=l.newwriteCharacteristUUID,n.conf.uuids.notifyCharacteristUUID=l.newnotifyCharacteristUUID,console.log("发现了新服务");break}}n.connectServerAndCharacteristic(e,t)}):n.connectServerAndCharacteristic(e,t)},r.prototype.getDeviceSystemInfo=function(e){e.content=new ArrayBuffer(0),this.sendMsgOperation(27,a.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.hardMajor=String.fromCharCode(e.get1x(1)),t.hardMinor=String.fromCharCode(e.get1x(1)),t.softMajor=e.get1x(1),t.softMinor=e.get1x(1),t.producedDate=e.get4x(1),t.hardVersion=t.hardMajor+"."+t.hardMinor,t.softVersion=t.softMajor+"."+Object(o.padStart)(t.softMinor),t.deviceId=s.default.buf2string(e.buffer.slice(20,33)),t.deviceName=s.default.ab2string(e.buffer.slice(33,49)),t})},r.prototype.setWakeUpTimeRange=function(e){var t=new ArrayBuffer(5),n=new DataView(t),r=e.startTime.split(":"),i=e.endTime.split(":");n.set1x(e.status),n.set1x(r[0]-0),n.set1x(r[1]-0),n.set1x(i[0]-0),n.set1x(i[1]-0),e.content=n.buffer,this.sendMsgOperation(50,a.FRAME_TYPE.Request,e)},r.prototype.getWakeUpTimeRange=function(e){e.content=new ArrayBuffer(0),this.sendMsgOperation(51,a.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.status=e.get1x(1),t.startTime=[Object(o.padStart)(e.get1x(1)),Object(o.padStart)(e.get1x(1))].join(":"),t.endTime=[Object(o.padStart)(e.get1x(1)),Object(o.padStart)(e.get1x(1))].join(":"),t})},r.prototype.sendUpdateSummery=function(e){var t=new ArrayBuffer(201),n=new DataView(t);n.set1x(0),n.set1x(e.hardMajor),n.set1x(e.hardMinor),n.set1x(e.softMajor),n.set1x(e.softMinor),n.set4x(e.length),n.setStr(e.pKey,128),n.setStr(e.hashCode,64),e.content=n.buffer,this.sendMsgOperation(21,a.FRAME_TYPE.Request,e,function(e){return e.getUint16(12)})},r.prototype.setMacroBroadcast=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set1x(!!e.c_37),n.set1x(!!e.c_38),n.set1x(!!e.c_39),n.set1x(e.bcInterval||20),n.set1x(e.TRP),e.content=n.buffer,this.sendMsgOperation(252,a.FRAME_TYPE.Request,e)};var p=new r;p.registerPostMsgHanlder(function(e){p.parsePost(e)}),p.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(e,t){this.conf=r.getDefaultConfig(),this.conf.ip=e,this.conf.port=t,this.tcpNative=this.conf.tcpNative,this.ip=this.conf.ip,this.port=this.conf.port,this.key=function(){return u.default.buildKey(this.ip,this.port)};var n=h.get(this.key());if(n)return n;this.cancelReconnect=!0,this.keepAliveTime=(new Date).getTime(),this.CONNECTTION_STATUS=!1,this.NETWORK_STATUS=!0,this.autoRespACK=this.conf.autoRespACK,this.pushInstance=function(){h.put(this.key(),this)},this.open=function(e,t,n){var r=this;if(!t&&this.CONNECTTION_STATUS)return r.cancelReconnect=!1,n(!0),null;this.CONNECTTION_STATUS&&this.close(),this.pushInstance(),n&&g.init(u.default.buildKey(v.open,this.key()),{handler:function(e){r.cancelReconnect=!1,n&&n.apply(void 0,arguments)},timeout:e}),this.tcpNative.connectSocket(this.ip,this.port,function(e){e.status===p.a.socketState.connected?(r.keepAliveTime=(new Date).getTime(),g.invoke(u.default.buildKey(v.open,e.ip,e.port),!0),r.CONNECTTION_STATUS=!0):(g.invoke(u.default.buildKey(v.open,e.ip,e.port),!1),r.CONNECTTION_STATUS=!1),r.cancelReconnect=!1}),l.log.i(T,"open",this.ip,this.port)},this.setProtocol=function(e){this.conf.protocol=e,o(this.tcpNative)},this.close=function(e){l.log.i(T,"closeSocket-start"),this.cancelReconnect=!0,this.tcpNative.closeSocket(this.ip,this.port,function(t){l.log.i(T,"closeSocket",t),e(t)}),g.invoke(u.default.buildKey(v.open,this.ip,this.port),!1)},this.sendPacket=function(e){var t=this;try{l.log.i(T,"sendPacket-start2",this.CONNECTTION_STATUS),l.log.i(T,"sendPacket-start3",this.NETWORK_STATUS),l.log.i(T,"sendPacket-start",e,this.ip,this.port,this.NETWORK_STATUS,this.CONNECTTION_STATUS);var n=this.ip&&this.ip.startsWith("192");if(!this.NETWORK_STATUS&&!n)return void(e.handler&&e.handler(p.a.RET.Network_Disable));if(!this.CONNECTTION_STATUS)return void(e.handler&&e.handler(p.a.RET.Socket_Disconnect));this.keepAliveTime=(new Date).getTime();var r=this.conf.protocol.buildMsg(e);l.log.i(T,"sendPacket-msg",u.default.buildKey(this.ip,this.port,r.key),u.default.buffer2Arr(r.buffer)),g.init(u.default.buildKey(this.ip,this.port,r.key),{timeout:e.timeout,handler:e.handler}),this.tcpNative.sendSocketMessage(this.ip,this.port,u.default.buffer2Arr(r.buffer),function(e){l.log.i(T,"sendSocketMessage-callback",e),e!==p.a.RET.Succeed&&g.invoke(u.default.buildKey(t.ip,t.port,r.key),p.a.RET.Failed)})}catch(e){l.log.e(T,"sendPacket",e)}},this.isConnected=function(){return this.CONNECTTION_STATUS},this.responseACK=function(e){if(this.autoRespACK){var t=this.conf.protocol.buildACK(e);this.tcpNative.sendSocketMessage(this.ip,this.port,t.buffer,function(){l.log.i(T,"responseACK-callback",arguments)})}},this.onPostMsg=function(e,t){l.log.i(T,"onPostMsg-start",e);var n=u.default.buildKey(this.ip,this.port,e,0);return l.log.i(T,"onPostMsg-start",n),d.init(n,{ignoreTimeout:!0,handler:t})},this.removePostMsgListener=function(e,t){d.clearSingle(u.default.buildKey(this.ip,this.port,e,0),t)},this.onSocketState=function(e){return d.init(u.default.buildKey(v.socketState,this.ip,this.port),{ignoreTimeout:!0,handler:e})},this.removeSocketStateListener=function(e){d.clearSingle(u.default.buildKey(v.socketState,this.ip,this.port),e)},this.onNetworkState=function(e){return d.init(u.default.buildKey(v.networkState),{ignoreTimeout:!0,handler:e})},this.removeNetworkStateListener=function(e){d.clearSingle(v.networkState,e)},this.getNetworkState=function(){return s.default.getNetworkState()},i(s.default)}function a(e){e.onMessage(function(e){var t=e.ip,n=e.port,r=e.value;l.log.i(T,"onMessage",t,n,e),l.log.i(T,"onMessage","value",r);var a=u.default.buildKey(t,n),i=h.get(a);l.log.i(T,"onMessage-instance",i),i&&i.conf.protocol.handleResp(u.default.arr2Buffer(r),function(e){if(l.log.i(T,"handleResp-callback",e),e){var r=u.default.buildKey(t,n,e.key);e.frameType===p.a.FrameType.Response||e.frameType===p.a.FrameType.ACK?g.invoke(r,p.a.RET.Succeed,e.buffer,e.dataObj):e.frameType===p.a.FrameType.POST?(l.log.i(T,"handleResp-callback-POST",r,e.frameType),d.invoke(r,e.buffer,e.dataObj,e.channelCode),i.responseACK(e.dataObj)):l.log.i(T,"onMessage-unexpected-frameType",e.frameType)}})}),l.log.i(T,"tcpNative.onMessage-end")}function i(e){e.onSocketStateChange(function(e){var t=u.default.buildKey(e.ip,e.port),n=h.get(t);l.log.i(T,"onSocketStateChange-callback",e,"instanceKey: "+t,h),n&&(n.CONNECTTION_STATUS=e.status===p.a.socketState.connected),e.status===p.a.socketState.connected&&g.invoke(u.default.buildKey(v.open,e.ip,e.port),!0),d.invoke(u.default.buildKey(v.socketState,e.ip,e.port),e.status===p.a.socketState.connected)}),l.log.i(T,"tcpNative.onSocketStateChange-end"),e.onNetworkStateChange(function(e){l.log.i(T,"onNetworkStateChange-callback",e),d.invoke(v.networkState,e);var t=h.values();if(t)for(var n=0;n<t.length;n++)t[n].NETWORK_STATUS=e})}function o(e){l.log.i(T,"initGlobalSocket-start"),E||(E=!0,a(e))}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"invoker",function(){return d}),n.d(t,"pool",function(){return h}),n.d(t,"SOCKET_LISTENER_KEY",function(){return v}),t.SocketClient=r;var s=n(24),c=n(12),u=n(1),f=n(6),l=n(2),p=n(3),d=new c.InvokerManager(3e3,!0),g=new c.InvokerManager(3e3,!1),h=new f.Map,y={ip:"",port:0,tcpNative:s.default},v={open:"__open",socketState:"__onSocketStateChange",networkState:"__onNetworkStateChange",postMsg:"__onPostMsg"},T="SocketClient";r.getInstance=function(e,t){h.get(u.default.buildKey(e,t));return conf},r.getDefaultConfig=function(){var e=JSON.parse(JSON.stringify(y));return e.tcpNative=s.default,e};var E=!1},function(e,t,n){"use strict";function r(e,t){this.conf=null,this.rule=null,this.ws=null,this.clientId=0,this.i=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local&&!Object({NODE_ENV:"production",version:"2.2.0",PRODUCTION_TIME:"2021-5-17 20:14:29",channelId:14200,PRODUCTION_STATUS:2,UGLIFY_JS:!1,SLEEPACE_HOST:"https://m800test1.sleepace.com",TCP_SERVER:{IP:"120.24.169.204",PORT:27010}}).RELEASE){var a=n[0];(e.rule[a]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.log.apply(null,n))}e.sendLog2server("info",n)}catch(e){}},this.e=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local){var a=n[0];(e.rule[a]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.error.apply(null,n))}e.sendLog2server("error",n)}catch(e){}},this.w=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local){var a=n[0];(e.rule[a]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.error.apply(null,n))}e.sendLog2server("warn",n)}catch(e){}},this.sendLog2server=function(e,t){var n=this,r=this.conf.log.remote;if(!r.available||!r.url)return null;try{var a=t[0],i={type:"logLine",info:[],warn:[],err:[]};if(this.rule[a]||this.rule.remoteAll){for(var o=[c],u=0;u<t.length;u++){var f=t[u];"object"===s(t[u])&&(f=JSON.stringify(t[u])),o.push(f)}o.unshift(n.clientId),o.push((new Date).getTime());var l=o.join(" ");-1!==["info","warn","error"].indexOf(e)&&i[e].push(l),n.ws.wsSend(JSON.stringify(i))}}catch(e){console.error(c,"Comm.Error sendLog2server",e)}},this.createClientId=function(){this.clientId=o.a.getItem("wsClientId"),this.clientId||(this.clientId=Object(i.randomNum)(1e7,99999999),o.a.setItem("wsClientId",this.clientId)),console.warn(c,"REMOTE-LOG","wsClientId: ",this.clientId)},this.setLogConfig(e,t)}t.a=r;var a=n(45),i=n(4),o=n(46),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c="TAG:base",u={log:{local:!1,remote:{available:!1,url:""}}},f={all:!1,remoteAll:!1};r.prototype.setLogConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if("string"==typeof e)switch(e){case"local":e={all:!0,remoteAll:!1},t.log.local=!0;break;case"remote":e={all:!0,remoteAll:!0},t.log.local=!1;break;case"all":e={all:!0,remoteAll:!0},t.log.local=!0;break;default:e=f}this.rule=e,this.conf=t,this.ws&&this.ws.close(),this.ws=new a.a({websocket:{available:this.conf.log.remote.available,url:this.conf.log.remote.url}}),this.ws.initWebSocket(),this.createClientId()}},function(e,t,n){"use strict";function r(){this.dataStore=[],this.enqueue=function(e){this.dataStore.push(e)},this.dequeue=function(){return this.dataStore.shift()},this.front=function(){return this.dataStore[0]},this.back=function(){return this.dataStore[this.dataStore.length-1]},this.toString=function(){for(var e="",t=0;t<this.dataStore.length;++t)e+=this.dataStore[t]+"&nbsp;";return e},this.empty=function(){return 0==this.dataStore.length},this.count=function(){return this.dataStore.length}}Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=r,t.default={Queue:r}},function(e,t,n){"use strict";function r(){var e=this;this.version=1,this.source=1,this.channelCode=0,this.frameType=0,this.frameNumber=1,this.frameIndex=0,this.frameSequence=0,this.subVersion=1,this.specialId=i.a.specialId,this.deviceType=0,this.messageType=0,this.content=new ArrayBuffer(0),this.separator=i.a.separator,this._payload=new ArrayBuffer(0),this.data=function(){return u(e)},this.key=function(){return"ProtocolNox:"+e.frameSequence}}n.d(t,"a",function(){return r}),n.d(t,"c",function(){return f}),n.d(t,"b",function(){return l});var a=n(22),i=n(3),o=n(14),s=function(e){var t=6+e.content.byteLength;0===e.subVersion&&(t=2+e.content.byteLength);var n=new DataView(new ArrayBuffer(t)),r=0;1===e.subVersion&&(n.setInt16(r,e.specialId),r+=2,n.setInt16(r,e.deviceType),r+=2),n.setInt16(r,e.messageType),r+=2;for(var a=new DataView(e.content),i=0;i<e.content.byteLength;i++)n.setInt8(r,a.getInt8(i)),r+=1;return n.buffer},c=function(e){var t=21+e._payload.byteLength,n=new DataView(new ArrayBuffer(t)),r=0;n.setInt8(r,e.version),r+=1,n.setInt8(r,e.source),r+=1,n.setInt32(r,e.channelCode),r+=4,n.setInt8(r,e.frameType),r+=1,n.setInt16(r,e.frameNumber),r+=2,n.setInt16(r,e.frameIndex),r+=2,n.setInt16(r,e.frameSequence),r+=2;for(var a=new DataView(e._payload),i=0;i<e._payload.byteLength;i++)n.setInt8(r,a.getInt8(i)),r+=1;var s=o.default.crc32buf(n.buffer.slice(0,t-8));n.setInt32(r,s),r+=4;for(var c=0;c<e.separator.length;c++){var u=e.separator[c];n.setInt8(r,u),r+=1}return n.buffer},u=function(e){e._payload=s(e);for(var t=a.a.cutArrayBufferWithSeparatorFromIndex(e._payload,e.separator,2),n=t.length,i=new ArrayBuffer(0),o=0;o<n;o++){var u=t[o],f=new r;f.version=e.version,f.source=e.source,f.channelCode=e.channelCode,f.frameType=e.frameType,f.frameNumber=n,f.frameIndex=o,f.frameSequence=e.frameSequence,f._payload=u,f.separator=e.separator;var l=c(f);i=i.append(l)}return i},f=function(e){var t=e.byteLength;if(!e||t<21)return null;var n=new DataView(e),a=n.getInt32(t-8),s=e.slice(0,t-8);if(a!=o.default.crc32buf(s))return null;var c=new r,u=0;return c.version=n.getInt8(u),u+=1,c.source=n.getInt8(u),u+=1,c.channelCode=n.getInt32(u),u+=4,c.frameType=n.getInt8(u),u+=1,c.frameNumber=n.getInt16(u),u+=2,c.frameIndex=n.getInt16(u),u+=2,c.frameSequence=n.getInt16(u),u+=2,c._payload=e.slice(u,t-8),n.getUint16(13)==i.a.specialId?c.subVersion=1:c.subVersion=0,c},l=function(e){var t=e._payload,n=new DataView(t),r=0;return 1==e.subVersion&&(e.specialId=n.getInt16(r),r+=2,e.deviceType=n.getInt16(r),r+=2),e.messageType=n.getInt16(r),r+=2,e.content=t.slice(r),e}},function(e,t,n){"use strict";function r(e,t){if(0==t.length)return{left:e,bufferAry:[]};var n=i(e,t);if(0==n.length)return{left:e,bufferAry:[]};for(var r=[],a=0,s=0;s<n.length;s++){var c=n[s],u=c.location+c.length-a,f={location:a,length:u},l=o(e,f);r.push(l),a+=u}var p={};if(p.bufferAry=r,a<e.byteLength){var d={location:a,length:e.byteLength-a},g=o(e,d);p.left=g}else p.left=new ArrayBuffer(0);return p}function a(e,t,n){if(0==t.length)return[e];var r=i(e,t);if(0==r.length)return[e];for(var a=[],s=0,c=0;c<r.length;c++){var u=r[c],f=u.location+n-s,l={location:s,length:f},p=o(e,l);a.push(p),s+=f}if(s<e.byteLength){var d={location:s,length:e.byteLength-s},g=o(e,d);a.push(g)}return a}function i(e,t){if(t.length>e.byteLength)return[];for(var n=[],r=u.default.buffer2Arr(e),a=t.length,i=0;i<=r.length-a;){r.slice(i,i+a).isEqualToAnother(t)?(n.push({location:i,length:a}),i+=a):i++}return n}function o(e,t){var n=u.default.buffer2Arr(e),r=t.location,a=t.length;return n=n.slice(r,r+a),u.default.arr2Buffer(n)}function s(e,t){var n=u.default.buffer2Arr(e),r=t.location,a=t.length;return n.length<r+a?e:(n.splice(r,a),u.default.arr2Buffer(n))}function c(e){for(var t=new DataView(e),n=[],r=0;r<e.byteLength;r++)n.push(t.getUint8(r).toString(16));return n}var u=n(1);Array.prototype.isEqualToAnother=function(e){var t=!1;return this.toString()===e.toString()&&(t=!0),t},t.a={cutArrayBufferWithSeparator:r,cutArrayBufferWithSeparatorFromIndex:a,rangeListOfSeparator:i,subArrayBuffer:o,cutOffArrayBuffer:s,bufferToHexAry:c}},function(e,t,n){"use strict";(function(e){function r(e){try{return prompt(e)}catch(e){}}function a(e){var t=JSON.stringify(e);return f.Base64.encode(t)}function i(e){try{var t=f.Base64.decode(e);return JSON.parse(t)}catch(e){}}function o(e,t){try{var n,i;if(navigator.useWkWebView){var o={func:e};void 0!=t&&(o.value=t),i=a(o),n=r(i)}else void 0!=t?(i=a(t),n=g[e](i)):n=g[e]();return n&&(n="string"==typeof n?JSON.parse(f.Base64.decode(n)):n),l.log.i(d,"callNative",e,t,n),n}catch(e){console.error(d,"callNative",e)}}function s(e,t,n){try{var r="__"+e+"Callback";return window[r]=function(){if(n){var t=[];if(arguments.length){for(var r=0;r<arguments.length;r++){var a=arguments[r];t.push(a?i(a):"")}l.log.i(d,"nativeCallback",e,t),n.apply(this,t)}else l.log.i(d,"nativeCallback",e,t),n()}},t?t.callback=r:t={callback:r},o(e,t)}catch(e){console.error(d,"callNative",e)}}function c(){return l.log.i(d,"getSystemInfoSync",(new Date).valueOf()),h=o("getSystemInfoSync"),navigator.devicePlatform=h.platform,l.log.i(d,"getSystemInfoSync",(new Date).valueOf()),h}function u(){return void 0==h?c().platform:h.platform}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return u});var f=n(48),l=(n.n(f),n(2)),p=n(49),d="base-native",g=("undefined"!=typeof window&&window,void 0);try{g=window.medica,navigator.useWkWebView="2"===p.a.urlParse().params.useWkWebView}catch(e){}var h=void 0}).call(t,n(30))},function(e,t,n){"use strict";function r(e,t,n){return Object(p.b)("connectSocket",{ip:e,port:t},n)}function a(e){return Object(p.b)("onSocketStateChange",void 0,e)}function i(e,t,n){return Object(p.b)("closeSocket",{ip:e,port:t},n)}function o(e,t,n,r){return Object(p.b)("sendSocketMessage",{ip:e,port:t,value:n},r)}function s(e){return Object(p.b)("onMessage",void 0,e)}function c(e,t,n){return Object(p.a)("getSocketState",{ip:e,port:t})}function u(e){return Object(p.b)("onNetworkStateChange",void 0,e)}function f(e,t,n,r,a){return Object(p.b)("sendMulticast",{ip:e,port:t,deviceType:r,deviceName:n},a)}function l(e,t,n,r){return Object(p.b)("getUdpServerAddress",{ssid:e,password:t,timeout:n},r)}Object.defineProperty(t,"__esModule",{value:!0});var p=n(23),d=n(33);t.default={connectSocket:r,closeSocket:i,getSocketState:c,onSocketStateChange:a,sendSocketMessage:o,onMessage:s,onNetworkStateChange:u,sendMulticast:f,getUdpServerAddress:l,getNetworkState:d.default.getNetworkState}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_M800,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.M800BleApi=r,n.d(t,"m800BleApi",function(){return o});var a=n(16),i=n(0);r.prototype=new a.a,r.prototype.syncTime=function(e){e.frameType=i.FRAME_TYPE.Request,e.msgType=513,e.deviceType=e.deviceType||i.DEVICE_TYPE.DEVICE_TYPE_M800,e.subVersion=0;var t=new DataView(new ArrayBuffer(13));t.set4x(e.timestamp),t.set4x(e.timezone),t.set1x(e.season),t.set4x(e.seasonOffset),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler(t)})};var o=new r;o.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){var e=this;this.preCode1=o.code1,this.preCode2=o.code2,this.frameType=0,this.payloadLen=0,this.messageType=0,this.content=new ArrayBuffer(0),this._payload=new ArrayBuffer(0),this.data=function(){return u(e)},this.key=function(){return"ProtocolNoxAp:"+e.messageType}}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return f});var a=(n(22),n(3),n(15)),i={Request:1,Response:2,ACK:3,POST:4},o={code1:172,code2:152},s=function(e){var t=new DataView(new ArrayBuffer(e.payloadLen)),n=0;t.setInt8(0,e.messageType),n+=1;for(var r=new DataView(e.content),a=0;a<e.content.byteLength;a++)t.setInt8(n,r.getInt8(a)),n+=1;return t.buffer},c=function(e){var t=6+subNox._payload.byteLength,n=new DataView(new ArrayBuffer(t)),r=0;n.setInt8(r,e.preCode1),r+=1,n.setInt8(r,e.preCode2),r+=1,n.setInt8(r,e.frameType),r+=1,n.setInt16(r,e.payloadLen),r+=2,n.setInt8(r,e.messageType),r+=1;for(var i=new DataView(e._payload),o=0;o<subNox._payload.byteLength;o++)n.setInt8(r,i.getInt8(o)),r+=1;var s=Object(a.crc8buf)(n.buffer.slice(0,t-1));return n.setInt32(r,s),r+=1,n.buffer},u=function(e){return e._payload=s(e),c(e)},f=function(e){var t=e.byteLength,n=new DataView(e),i=n.getUint8(t-1),o=e.slice(0,t-1);if(i!=Object(a.crc8buf)(o))return null;var s=new r,c=0;return s.preCode1=n.getInt8(c),c+=1,s.preCode1=n.getInt8(c),c+=1,s.frameType=n.getInt8(c),c+=1,s.payloadLen=n.getInt16(c),c+=2,s.messageType=n.getInt8(c),c+=1,s._payload=e.slice(c,t-1),s.content=s._payload,s}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(){var e=new ArrayBuffer(0),t=[],n=function(t){e=t},a=function(t){n(e.append(t))},c=function(){var t=o.a.cutArrayBufferWithSeparator(e,s.a.separator),r=t.left,a=t.bufferAry;return n(r),a},u=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=Object(i.c)(r);a&&t.push(a)}return t},f=function(){if(0==t.length)return[];for(var e=[];0!=t.length;){var n=t[0],r=n.frameNumber;if(1!=r)if(0==n.frameIndex){var a=r;t.length<a&&(a=n.length);for(var o=n.frameSequence,s=!1,c=1;c<a;c++){var u=t[c];if(u.frameSequence!=o||u.frameIndex!=c){s=!0,t.splice(0,c);break}}if(!s){if(t.length<r)break;for(var f=new ArrayBuffer(0),l=0;l<r;l++){var p=t[l];p._payload&&(f=f.append(p._payload))}t.splice(0,r),n.frameNumber=1,n.frameIndex=0,n._payload=f,e.push(n)}}else t.shift();else e.push(n),t.shift()}return e.triggerEach(function(e){Object(i.b)(e)}),e};this.appendData=function(e){a(e);var n=c(),i=u(n);if(i&&i.length>0){var o;(o=t).push.apply(o,r(i))}return f()},this.empty=function(){e=new ArrayBuffer(0),t=[]}}t.a=a;var i=n(21),o=(n(1),n(22)),s=n(3)},function(e,t,n){"use strict";function r(e){c.INIT_CONF.nativeApp=e}function a(e){return e&&r(e),c.INIT_CONF.nativeApp===c._const.nativeApp.weixin?o.default:c.INIT_CONF.nativeApp===c._const.nativeApp.hilink?s.a:i.default}Object.defineProperty(t,"__esModule",{value:!0}),t.setBleNative=r,t.getBleNative=a;var i=n(29),o=n(31),s=n(50),c=n(32)},function(e,t,n){"use strict";function r(e,t,n){var r=M[e],a=n;if(!r)return a;for(var i in r){-1!==r[i].indexOf(t.toLowerCase())&&(a=i)}return a}function a(e){Object(I.b)("initializeBluetoothAdapter",void 0,e)}function i(e){Object(I.b)("openBluetoothAdapter",void 0,e)}function o(e){Object(I.b)("closeBluetoothAdapter",void 0,e)}function s(e){Object(I.b)("onBluetoothAdapterStateChange",void 0,e)}function c(e){var t=Object(I.a)("getBluetoothAdapterState");return e(t),t}function u(e,t,n){if(e&&!(e instanceof Array))throw"services must be an Array";var r={services:e,allowDuplicatesKey:t,interval:n};return Object(I.a)("startBluetoothDevicesDiscovery",r)}function f(e){Object(I.b)("onBluetoothDeviceFound",void 0,e)}function l(){return Object(I.a)("stopBluetoothDevicesDiscovery")}function p(){return Object(I.a)("getBluetoothDevices")}function d(){return Object(I.a)("getConnectedBluetoothDevices")}function g(e){return Object(I.a)("createBLEConnection",{deviceId:e})}function h(e){return Object(I.a)("closeBLEConnection",{deviceId:e})}function y(e){Object(I.b)("onBLEConnectionStateChange",void 0,e)}function v(e,t){var n={deviceId:e};return Object(I.b)("getBLEDeviceServices",n,t)}function T(e,t,n,r){var a={deviceId:e,serviceId:t,characteristicId:n};return Object(I.b)("discoverBLEServerAndCharacteristic",a,function(t){t&&t.data?M[e]=t.data:delete M[e],r&&r.apply(void 0,arguments)})}function E(e,t,n,a,i){var o={deviceId:e,serviceId:r(e,n,t),characteristicId:n,state:a};return Object(I.b)("notifyBLECharacteristicValueChange",o,i)}function _(e,t,n,a,i,o){var s={deviceId:e,serviceId:r(e,n,t),characteristicId:n,response:a,value:i},c=Object(I.a)("writeBLECharacteristicValue",s);return o(c),c}function m(e){return Object(I.b)("onBLECharacteristicValueChange",void 0,e)}function w(){return Object(I.a)("getBluetoothMTU")}function x(e,t,n,r){var a={deviceType:e,btAddress:t,newVerCode:n};Object(I.b)("createBond",a,r)}function D(e,t,n,r,a){var i={fileName:e,btAddress:t,fileUUID:n,data:r};Object(I.b)("sendDataByTraditionalBT",i,a)}function b(e){Object(I.b)("filterInit",void 0,e)}function A(e){Object(I.b)("filterEnd",void 0,e)}function C(e,t,n){var r={original:e,state:t};Object(I.b)("filterParse",r,n)}function S(e,t){var n={size:e};if(/iPhone|iPad/i.test(navigator.userAgent))return void t({status:1,mtu:20});Object(I.b)("setMTUSize",n,t)}function B(e,t){var n={deviceId:e,interval:t};return Object(I.a)("setBluetoothRecieveInterval",n)}Object.defineProperty(t,"__esModule",{value:!0});var I=n(23),M={};t.default={$nativeName:"medica",getSystemInfoSync:I.d,getPlatform:I.c,initializeBluetoothAdapter:a,openBluetoothAdapter:i,closeBluetoothAdapter:o,onBluetoothAdapterStateChange:s,getBluetoothAdapterState:c,startBluetoothDevicesDiscovery:u,onBluetoothDeviceFound:f,stopBluetoothDevicesDiscovery:l,getBluetoothDevices:p,getConnectedBluetoothDevices:d,createBLEConnection:g,closeBLEConnection:h,onBLEConnectionStateChange:y,getBLEDeviceServices:v,discoverBLEServerAndCharacteristic:T,notifyBLECharacteristicValueChange:E,writeBLECharacteristicValue:_,onBLECharacteristicValueChange:m,getBluetoothMTU:w,setMTUSize:S,setBluetoothRecieveInterval:B,createBond:x,sendDataByTraditionalBT:D,filterInit:b,filterEnd:A,filterParse:C}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){wx.openBluetoothAdapter({complete:function(t){e()}}),C.log.i(I,"initializeBluetoothAdapter-end")}function a(e){C.log.i(I,"openBluetoothAdapter"),wx.openBluetoothAdapter({success:function(e){C.log.i(I,"openBluetoothAdapter-success",e)},fail:function(e){C.log.i(I,"openBluetoothAdapter-success",e)},complete:function(t){e&&e()}})}function i(e){wx.closeBluetoothAdapter({success:function(t){e&&e(S.default.BLE_RET.Boolean.True)},fail:function(t){e&&e(S.default.BLE_RET.Boolean.False)}}),C.log.i(I,"closeBluetoothAdapter-end")}function o(e){C.log.i(I,"onBluetoothAdapterStateChange-start"),wx.onBluetoothAdapterStateChange(function(t){C.log.i(I,"onBluetoothAdapterStateChange-callback",t);var n=t.available?S.default.BLE_RET.Boolean.True:S.default.BLE_RET.Boolean.False;e(n)})}function s(e){C.log.i(I,"getBluetoothAdapterState-start"),wx.getBluetoothAdapterState({success:function(t){C.log.i(I,"getBluetoothAdapterState-success",t);var n=t.available?S.default.BLE_RET.bleStatus.available:S.default.BLE_RET.bleStatus.close;e(n)}})}function c(e,t,n){if(C.log.i(I,"startBluetoothDevicesDiscovery-start",arguments),e&&!(e instanceof Array))throw"services must be an Array";wx.startBluetoothDevicesDiscovery({allowDuplicatesKey:t,success:function(e){C.log.i(I,"startBluetoothDevicesDiscovery-success",arguments)},fail:function(e){C.log.i(I,e)}})}function u(e){if(e&&e.length>0){for(var t=0;t<e.length;t++)e[t].advertisData&&e[t].advertisData instanceof ArrayBuffer&&(e[t].advertisData=B.default.buffer2Arr(e[t].advertisData)),e[t].serviceData&&e[t].serviceData instanceof ArrayBuffer&&(e[t].serviceData=B.default.buffer2Arr(e[t].serviceData));return C.log.i(I,"onBluetoothDeviceFound-devices",e),e}return[]}function f(e){wx.onBluetoothDeviceFound(function(t){C.log.i(I,"onBluetoothDeviceFound-callback",t);var n=t.devices,r=u(n);e(r)})}function l(){C.log.i(I,"stopBluetoothDevicesDiscovery-start",arguments),wx.stopBluetoothDevicesDiscovery({complete:function(e){C.log.i(I,"stopBluetoothDevicesDiscovery-complete",arguments)}})}function p(e){wx.getBluetoothDevices({success:function(t){e.success(u(t.devices))},fail:e.fail,complete:e.complete})}function d(e,t){wx.getConnectedBluetoothDevices({success:function(n){e&&e(n.devices),t&&t.success&&t.success()}})}function g(e,t){C.log.i(I,"createBLEConnection-start",arguments),wx.createBLEConnection({timeout:t,deviceId:e,complete:function(e){C.log.i(I,"createBLEConnection-complete",e)}})}function h(e){C.log.i(I,"closeBLEConnection-start",arguments),wx.closeBLEConnection({deviceId:e,complete:function(e){C.log.i(I,"closeBLEConnection-complete",e)}})}function y(e){C.log.i(I,"onBLEConnectionStateChange-start"),wx.onBLEConnectionStateChange(function(t){C.log.i(I,"onBLEConnectionStateChange-callback",arguments);var n=t.connected?S.default.BLE_RET.Boolean.True:S.default.BLE_RET.Boolean.False;e({deviceId:t.deviceId,connected:n})})}function v(e,t,n,r){C.log.i(I,"discoverBLEServerAndCharacteristic-start",arguments),wx.getBLEDeviceServices({deviceId:e,complete:function(n){C.log.i(I,"getBLEDeviceServices-complete",arguments),wx.getBLEDeviceCharacteristics({deviceId:e,serviceId:t,success:function(e){C.log.i(I,"getBLEDeviceCharacteristics-success",arguments),r(S.default.BLE_RET.Boolean.True)}})}})}function T(e,t,n,r,a){C.log.i(I,"notifyBLECharacteristicValueChange-start",arguments),wx.notifyBLECharacteristicValueChange({state:A(r),deviceId:e,serviceId:t,characteristicId:n,success:function(e){C.log.i(I,"notifyBLECharacteristicValueChange-success",arguments),a(e)}})}function E(e,t,n,r,a,i){C.log.i(I,"writeBLECharacteristicValue-start",arguments),a instanceof Array&&(a=B.default.arr2Buffer(a)),wx.writeBLECharacteristicValue({deviceId:e,serviceId:t,characteristicId:n,value:a,success:function(e){C.log.i(I,"writeBLECharacteristicValue-success",arguments),i&&i(S.BLE_RET.status.suc)},fail:function(e){C.log.i(I,"writeBLECharacteristicValue-fail",arguments),i&&i(S.BLE_RET.status.fail)}})}function _(e){C.log.i(I,"onBLECharacteristicValueChange-start"),wx.onBLECharacteristicValueChange(function(t){var n=[];t&&t.value instanceof ArrayBuffer&&(n=B.default.buffer2Arr(t.value)),t.value=n,C.log.i(I,"onBLECharacteristicValueChange-callback",arguments),e(t)})}function m(){return 20}function w(e,t){t(20)}function x(e,t){return S.default.BLE_RET.Boolean.True}function D(){var e=wx.getSystemInfoSync();return M=e,C.log.i(I,"getSystemInfoSync-res",e),M}function b(){return void 0==M?D().platform:M}function A(e){return e===S.default.BLE_RET.Boolean.True}Object.defineProperty(t,"__esModule",{value:!0});var C=n(2),S=n(0),B=n(1),I="wxBleNative",M=void 0;t.default={$nativeName:"weixin",getSystemInfoSync:D,getPlatform:b,initializeBluetoothAdapter:r,openBluetoothAdapter:a,closeBluetoothAdapter:i,onBluetoothAdapterStateChange:o,getBluetoothAdapterState:s,startBluetoothDevicesDiscovery:c,onBluetoothDeviceFound:f,stopBluetoothDevicesDiscovery:l,getBluetoothDevices:p,getConnectedBluetoothDevices:d,createBLEConnection:g,closeBLEConnection:h,onBLEConnectionStateChange:y,discoverBLEServerAndCharacteristic:v,notifyBLECharacteristicValueChange:T,writeBLECharacteristicValue:E,onBLECharacteristicValueChange:_,getBluetoothMTU:m,setMTUSize:w,setBluetoothRecieveInterval:x}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"_const",function(){return a}),n.d(t,"INIT_CONF",function(){return o});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a={platform:{android:0,ios:1,other:2},nativeApp:{medica:1,weixin:2,hilink:3}},i=a.nativeApp.medica;"object"===("undefined"==typeof wx?"undefined":r(wx))&&wx.version?i=a.nativeApp.weixin:"object"===("undefined"==typeof hilink?"undefined":r(hilink))&&(i=a.nativeApp.hilink);var o={nativeApp:i}},function(e,t,n){"use strict";function r(){return Object(c.a)("getWiFiConnectionInfo")}function a(e){return Object(c.b)("startWiFiScan",void 0,e)}function i(e,t,n,r,a,i){return Object(c.b)("connectWiFi",{ssid:e,originalSsid:t,password:n,safeType:r,timeout:a},i)}function o(){return Object(c.a)("getWiFiIp")}function s(){return Object(c.a)("getNetworkState")}Object.defineProperty(t,"__esModule",{value:!0});var c=n(23);t.default={getWiFiConnectionInfo:r,startWiFiScan:a,connectWiFi:i,getWiFiIp:o,getNetworkState:s}},function(e,t,n){"use strict";function r(){a.BleCommon1.call(this),this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001_2,this.setMtuEnable=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.Sa10012BleApi=r,n.d(t,"sa10012Api",function(){return s});var a=n(8),i=n(0),o=n(35);Object(o.a)(r,a.BleCommon1);var s=new r;s.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(){this.deviceType=s.DEVICE_TYPE.DEVICE_TYPE_EW201B,this.setMtuEnable=!1}function a(e){var t={},n=new DataView(e);return t.alarmId=n.get1x(DataView.NO_SIGNED),t.alarmFlag=n.get1x(DataView.NO_SIGNED),t.smartFlag=n.get1x(DataView.NO_SIGNED),t.smartOffset=n.get1x(DataView.NO_SIGNED),t.hour=n.get1x(DataView.NO_SIGNED),t.minute=n.get1x(DataView.NO_SIGNED),t.week=n.get1x(DataView.NO_SIGNED),t.lazyCount=n.get1x(DataView.NO_SIGNED),t.lazyTime=n.get1x(DataView.NO_SIGNED),t.volume=n.get1x(),t.brightness=n.get1x(DataView.NO_SIGNED),t.musicId=n.get2x(DataView.NO_SIGNED),t.timestamp=n.get4x(DataView.NO_SIGNED),t.isValid=n.get1x(DataView.NO_SIGNED),t}function i(e){var t=new DataView(new ArrayBuffer(18));return t.set1x(e.alarmId),t.set1x(e.alarmFlag),t.set1x(e.smartFlag),t.set1x(e.smartOffset),t.set1x(e.hour),t.set1x(e.minute),t.set1x(e.week),t.set1x(e.lazyCount),t.set1x(e.lazyTime),t.set1x(e.volume),t.set1x(e.brightness),t.set2x(e.musicId),t.set4x(e.timestamp),t.set1x(e.isValid),e.content=t.buffer,e}Object.defineProperty(t,"__esModule",{value:!0}),t.EW201BApi=r,n.d(t,"ew201bBleApi",function(){return f});var o=n(8),s=n(0),c=n(1),u=n(4);r.prototype=new o.BleCommon1;var f=new r,l="EW201BApi";r.prototype.getSystemInfo=function(e){console.log(l,"getSystemInfo---"),this.sendMsgOperation(17,s.FRAME_TYPE.Request,e,function(e){console.log(l,"getSystemInfo---back",e);var t=new DataView(e),n={};n.deviceName=c.default.buf2string(t.buffer.slice(9,22)),n.deviceId=c.default.buf2string(t.buffer.slice(23,36)),n.deviceType=t.getUint16(37),n.currVersion=t.getUint16(39),n.currVersion=Object(u.padStart)(parseInt(n.currVersion/100),1,0)+"."+Object(u.padStart)(parseInt(n.currVersion%100)),n.facVersion=t.getUint16(41),n.facVersion=Object(u.padStart)(parseInt(n.facVersion/100),1,0)+"."+Object(u.padStart)(parseInt(n.facVersion%100)),n.facTime=t.getUint32(43),n.manufacCode=t.getUint16(47),n.coopCode=t.getUint16(49),n.pcbVersion=t.getUint8(51)+"."+t.getUint8(52);var r=t.getUint8(53),a=t.getUint8(54),i=t.getUint8(55),o=t.getUint8(56),s=t.getUint8(57),f=t.getUint8(58),p=[f,s,o,i,a,r].map(function(e){return Object(u.padStart)(e.toString(16))}).join(":").toUpperCase();return n.deviceMac=p,n.traditionBleName=c.default.buf2string(t.buffer.slice(59,90)),n.bleName=c.default.buf2string(t.buffer.slice(91,122)),n.bleContent=c.default.buf2string(t.buffer.slice(123,154)),n})},r.prototype.retSystemInfo=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(19,s.FRAME_TYPE.Request,e)},r.prototype.getSystemConfigInfo=function(e){console.log(l,"getSystemConfigInfo",e);var t=new DataView(new ArrayBuffer(1));t.set1x(e.operation),e.content=t.buffer,this.sendMsgOperation(20,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.operation=t.get1x(DataView.NO_SIGNED),n.value=t.get1x(DataView.NO_SIGNED),console.log(l,"getSystemConfigInfo",e,n),n})},r.prototype.setSystemConfigInfo=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(e.operation),t.set1x(e.value),e.content=t.buffer,this.sendMsgOperation(21,s.FRAME_TYPE.Request,e)},r.prototype.checkTime=function(e){console.log(l,"checkTime---",e);var t=new DataView(new ArrayBuffer(13));t.set4x(e.timestamp),t.set4x(e.timezoneOffset),t.set1x(e.season),t.set4x(e.seasonOffset),e.content=t.buffer,this.sendMsgOperation(22,s.FRAME_TYPE.Request,e)},r.prototype.getClockConfig=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(e.alarmId),e.content=t.buffer,this.sendMsgOperation(34,s.FRAME_TYPE.Request,e,function(t){var n=new Array,r=new DataView(t);r.position=9;var i=1;255==e.alarmId&&(i=5);for(var o=0;o<i;o++){var s=r.position,c=s+18,u=a(r.buffer.slice(s,c));r.position=c,(u.isValid||0==u.alarmId)&&n.push(u)}return n})},r.prototype.colockConfig=function(e){var t=i(e);this.sendMsgOperation(35,s.FRAME_TYPE.Request,t,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.configureTimeDormantInfo=function(e){var t=new DataView(new ArrayBuffer(5));t.set1x(e.sleepFlag),t.set1x(e.startHour),t.set1x(e.startMinute),t.set1x(e.endHour),t.set1x(e.endMinute),e.content=t.buffer,this.sendMsgOperation(25,s.FRAME_TYPE.Request,e)},r.prototype.getTimeDormantInfo=function(e){this.sendMsgOperation(33,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.sleepFlag=t.get1x(DataView.NO_SIGNED),n.startHour=t.get1x(DataView.NO_SIGNED),n.startMinute=t.get1x(DataView.NO_SIGNED),n.endHour=t.get1x(DataView.NO_SIGNED),n.endMinute=t.get1x(DataView.NO_SIGNED),console.log(l,"getTimeDormantInfo back",n),n})},r.prototype.asistSleepOperation=function(e){var t=new DataView(new ArrayBuffer(13));t.set1x(e.musicSwitch),t.set2x(e.musicId),t.set1x(e.volume),t.set1x(e.circle),t.set1x(e.lightSwitch),t.set1x(e.brightness),t.set1x(e.colorR),t.set1x(e.colorG),t.set1x(e.colorB),t.set1x(e.colorW),t.set1x(e.smartFlag),t.set1x(e.aidingTime),e.content=t.buffer,console.log("asistSleepOperation---",e),this.sendMsgOperation(36,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.getAsistConfig=function(e){this.sendMsgOperation(37,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.musicSwitch=t.get1x(DataView.NO_SIGNED),n.musicId=t.get2x(DataView.NO_SIGNED),n.volume=t.get1x(DataView.NO_SIGNED),n.circle=t.get1x(DataView.NO_SIGNED),n.lightSwitch=t.get1x(DataView.NO_SIGNED),n.brightness=t.get1x(DataView.NO_SIGNED),n.colorR=t.get1x(DataView.NO_SIGNED),n.colorG=t.get1x(DataView.NO_SIGNED),n.colorB=t.get1x(DataView.NO_SIGNED),n.colorW=t.get1x(DataView.NO_SIGNED),n.smartFlag=t.get1x(DataView.NO_SIGNED),n.aidingTime=t.get1x(DataView.NO_SIGNED),n})},r.prototype.ligthSwitchOpertaion=function(e){var t=new DataView(new ArrayBuffer(3));t.set1x(e.operation),t.set1x(Math.min(e.brightness,100)),t.set1x(e.colorId),e.content=t.buffer,this.sendMsgOperation(48,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.musicOperation=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(e.operation),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(49,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.alarmPreviewOperation=function(e){var t=new DataView(new ArrayBuffer(5));t.set1x(e.operation),t.set1x(e.brightness),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(50,s.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.queryWorkMode=function(e){var t=this;this.sendMsgOperation(81,s.FRAME_TYPE.Request,e,function(e){return Object.assign(t.fillWithResponseAndPostData({msgType:81,buffer:e,isPost:!1}))})},r.prototype.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=8:n.position=9,e.msgType){case 81:t.configMode=n.get1x(DataView.NO_SIGNED),t.lightStatus=n.get1x(DataView.NO_SIGNED),t.lightBrightness=n.get1x(DataView.NO_SIGNED),t.colorId=n.get1x(DataView.NO_SIGNED),t.alarmFlag=n.get1x(DataView.NO_SIGNED),t.alarmStatus=n.get1x(DataView.NO_SIGNED),t.timeMode=n.get1x(DataView.NO_SIGNED),t.systemBluetooth=n.get1x(DataView.NO_SIGNED),t.pincode=n.get1x(DataView.NO_SIGNED),t.sleepAidStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidLightStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidMusicStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidMusicID=n.get2x(DataView.NO_SIGNED),t.sleepAidLeftTime=n.get1x(DataView.NO_SIGNED)}return t}},function(e,t,n){"use strict";function r(){this.deviceType=o.DEVICE_TYPE.DEVICE_TYPE_SLEEPDOT,this.setMtuEnable=!1}function a(e,t){var n=u({},e);return n.content=t||new ArrayBuffer(0),n}Object.defineProperty(t,"__esModule",{value:!0}),t.B501BleApi=r,n.d(t,"b501BleApi",function(){return f});var i=n(8),o=n(0),s=n(2),c=n(1),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};r.prototype=new i.BleCommon1,r.prototype.registerPostMessage=function(e){this.registerPostMsgHanlder(function(t){var n=t.msgType,r=t.buffer;if(n&&r){var a=new DataView(r),i=void 0;switch(n){case 66:i={},i.state=a.getUint8(8),i.startTime=a.getUint32(9),i.duration=a.getUint16(13);break;case 64:i={},i.battery=a.getUint8(8);break;case 65:i={},i.sleepFlag=a.getUint8(8),i.wakeupFlag=a.getUint8(9)}i&&e&&e(n,i)}})},r.prototype.getSystemInfo=function(e){this.sendMsgOperation(17,o.FRAME_TYPE.Request,a(e,new ArrayBuffer(0)),function(e){var t={},n=new DataView(e);return t.deviceName=c.default.buf2string(n.buffer.slice(9,22)),t.deviceId=c.default.buf2string(n.buffer.slice(23,36)),t.deviceType=n.getUint16(37),t.currentVersion=n.getUint16(39),t.facVersion=n.getUint8(41)+"."+n.getUint8(42),t.facTime=n.getUint32(43),t.manufacCode=n.getUint16(47),t.coopCode=n.getUint16(49),t})},r.prototype.setUserID=function(e){var t=new DataView(new ArrayBuffer(5));t.set1x(1),t.set4x(e.userId),this.sendMsgOperation(32,o.FRAME_TYPE.Request,a(e,t.buffer))},r.prototype.getUserId=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),this.sendMsgOperation(32,o.FRAME_TYPE.Request,a(e,t.buffer),function(e){var t={},n=new DataView(e);return t.userId=n.getUint32(10),t})},r.prototype.setMonitorTime=function(e){var t=void 0==e.offsetTime?-90:e.offsetTime,n=new Date;n.setHours(e.hour,e.minute),t&&(n=new Date(n.valueOf()+6e4*t));var r=e.duration-t;r>1440?r=1440:r<0&&(r=0);var i=new DataView(new ArrayBuffer(6));s.log.i("setMonitorTime: "+n.getHours()+":"+n.getMinutes()+" ,offset: "+t),i.set1x(1),i.set1x(n.getHours()),i.set1x(n.getMinutes()),i.set2x(r),i.set1x(e.week),this.sendMsgOperation(33,o.FRAME_TYPE.Request,a(e,i.buffer))},r.prototype.getMonitorTime=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),this.sendMsgOperation(33,o.FRAME_TYPE.Request,a(e,t.buffer),function(e){var t={},n=new DataView(e);return t.hour=n.getUint8(10),t.minute=n.getUint8(11),t.duration=n.getUint16(12),t.week=n.getUint8(14),t})},r.prototype.changeMonitorState=function(e){var t=new DataView(new ArrayBuffer(0));this.sendMsgOperation(48,o.FRAME_TYPE.Request,a(e,t.buffer))},r.prototype.getMonitorState=function(e){this.sendMsgOperation(66,o.FRAME_TYPE.Request,a(e,new ArrayBuffer(0)),function(e){var t={},n=new DataView(e);return t.state=n.getInt8(9),t.startTime=n.getUint32(10),t.duration=n.getUint16(14),t})},r.prototype.getBattery=function(e){this.sendMsgOperation(64,o.FRAME_TYPE.Request,a(e,new ArrayBuffer(0)),function(e){var t={},n=new DataView(e);return t.battery=n.getInt8(9),t})},r.prototype.getSleepState=function(e){this.sendMsgOperation(65,o.FRAME_TYPE.Request,a(e,new ArrayBuffer(0)),function(e){var t={},n=new DataView(e);return t.sleepFlag=n.getUint8(9),t.wakeupFlag=n.getUint8(10),t})},r.prototype.getTemperatureAndHumidity=function(e){this.sendMsgOperation(67,o.FRAME_TYPE.Request,a(e,new ArrayBuffer(0)),function(e){var t={},n=new DataView(e),r=n.getUint16(9),a=n.getUint16(11);return t.temperature=r/100,t.humidity=a/100,t})},r.prototype.getHistoryDataSummary=function(e){var t=new DataView(new ArrayBuffer(8));t.set4x(e.startTime),t.set4x(e.endTime),this.sendMsgOperation(80,o.FRAME_TYPE.Request,a(e,t.buffer),function(e){var t={},n=new DataView(e);t.count=n.getUint8(9),t.dataList=new Array;for(var r=0;r<t.count;r++){var a={};a.startTime=n.getUint32(8*r+10),a.Interval=n.getUint8(8*r+10+4),a.recordCount=n.getUint16(8*r+10+4+1),a.stopMode=n.getUint8(8*r+10+4+1+2),t.dataList[r]=a}return t})},r.prototype.downloadSubHistoryData=function(e){var t=new DataView(new ArrayBuffer(7));t.set4x(e.startTime),t.set2x(e.offset),t.set1x(e.count);var n=e.evDataEnable;n=!(!n||1!=n),this.sendMsgOperation(81,o.FRAME_TYPE.Request,a(e,t.buffer),function(e){var t={},r=new DataView(e),a=r.getUint8(9),i=5;n&&(i+=2),t.count=a,t.dataList=new Array;for(var o=0;o<a;o++){var s={};s.feature1=r.getUint16(o*i+10),s.feature2=r.getUint16(o*i+10+2),s.flag=r.getUint8(o*i+10+2+2),n&&(s.temperature=r.getUint8(o*i+10+2+2+1),s.humidity=r.getUint8(o*i+10+2+2+1+1)),t.dataList[o]=s}return t})},r.prototype.downloadSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,a=function(a,i){if(a!==o.BLE_RET.status.timeout||t<=1)return void(n&&n(a,i));e.handler=n,r.downloadSubHistoryDataTryTimes(e,t-1)};e.handler=a,e.timeout=2e3,r.downloadSubHistoryData(e)},r.prototype.downloadSingleReport=function(e,t,n,r,a,i){var s=this,c=function(c,u){if(c!=o.BLE_RET.status.suc)return void(i&&i(c));for(var f=u.dataList,l=f.length,p=0;p<l;p++){var d=f[p];a.feature1.push(d.feature1),a.feature2.push(d.feature2),a.flag.push(d.flag),t&&(a.temperature.push(d.temperature),a.humidity.push(d.humidity))}if(r+n>=e.recordCount)return void(i&&i(c));n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),s.downloadSingleReport(e,t,n,r,a,i)},u={offset:n,count:r,evDataEnable:t};u.startTime=e.startTime,u.handler=c,s.downloadSubHistoryDataTryTimes(u,10)},r.prototype.downloadReports=function(e,t,n,r,a){var i=e.length,s=this,c={feature1:[],feature2:[],flag:[],temperature:[],humidity:[]},u=function(u){return u!==o.BLE_RET.status.suc?void(a&&a(u)):(r&&r(n,c),++n>=i?void(a&&a(u)):void s.downloadReports(e,t,n,r,a))};this.downloadSingleReport(e[n],t,0,40,c,u)},r.prototype.downloadHistoryData=function(e){var t=this,n=function(n,r){if(n!=o.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(o.BLE_RET.status.suc,[]);var i=[],s=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),i.push(n))},c=function(t){e.completion&&e.completion(t,i)};t.downloadReports(a,e.evDataEnable,0,s,c)},r={startTime:e.startTime,endTime:e.endTime,handler:n};this.getHistoryDataSummary(r)},r.prototype.sendUpgradeInfo=function(e){var t=new ArrayBuffer(14),n=new DataView(t);n.set2x(e.version),n.set4x(e.length),n.set4x(e.crcDes),n.set4x(e.crcBin),this.sendMsgOperation(82,o.FRAME_TYPE.Request,a(e,n.buffer))},r.prototype.sendUpgradePacket=function(e){var t=e.offset,n=e.length,r=e.content,i=(e.handler,new ArrayBuffer(6+r.length)),s=new DataView(i);s.set4x(t),s.set2x(n);for(var c=0;c<r.length;c++)s.set1x(r[c]);this.sendMsgOperation(83,o.FRAME_TYPE.Request,a(e,s.buffer))},r.prototype.sendUpgradePacketTryTimes=function(e,t){var n=e.handler,r=this,a=function(a,i){if(a!==o.BLE_RET.status.timeout||t<=1)return void(n&&n(a,i));e.handler=n,r.sendUpgradePacketTryTimes(e,t-1)};e.handler=a,e.timeout=e.timeout||3e3,r.sendUpgradePacket(e)},r.prototype.sendHoleUpgradePacket=function(e){var t=e,n=t.packet,r=t.offset,a=t.length,i=t.everyPacketHandle,s=t.completion,c=n.length;r+a>c&&(a=c-r);var u=n.slice(r,r+a),f=this,l=function(t){return t!==o.BLE_RET.status.suc?void(s&&s(t)):(r+=a,i&&i(r,c),r>=c?void(s&&s(o.BLE_RET.status.suc)):(e={packet:n,offset:r,length:a,everyPacketHandle:i,completion:s},void f.sendHoleUpgradePacket(e)))},p={offset:r,length:a,content:u,handler:l};r+a>=c&&(p.timeout=1e4),this.sendUpgradePacketTryTimes(p,5)},r.prototype.upgrade=function(e){var t=e.version,n=e.crcDes,r=e.crcBin,a=e.packet,i=e.everyPacketHandle,s=e.completion,c=this,u=function(e){if(e!==o.BLE_RET.status.suc)return void(s&&s(e));var t={packet:a,offset:0,length:200,everyPacketHandle:i,completion:s};c.sendHoleUpgradePacket(t)},f=a.length,l={version:t,length:f,crcDes:n,crcBin:r,handler:u};this.sendUpgradeInfo(l)};var f=new r;f.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=o.DEVICE_TYPE.DEVICE_TYPE_PILLOW,this.setMtuEnable=!1}function a(e,t){var n={},r=void 0;return e&&(r=e.timeout),r&&(n.timeout=r),n.content=t||new ArrayBuffer(0),n}Object.defineProperty(t,"__esModule",{value:!0}),t.PillowBleApi=r,n.d(t,"pillowBleApi",function(){return c});var i=n(13),o=n(0),s=n(2);r.prototype=new i.a,r.prototype.getHistoryDataSummary=function(e){var t=new DataView(new ArrayBuffer(8));t.set4x(e.startTime),t.set4x(e.endTime),this.sendMsgOperation(80,o.FRAME_TYPE.Request,a(e,t.buffer),function(t,n){if(e.handler){var r={};if(t===o.BLE_RET.status.suc){var a=new DataView(n);r.count=a.getUint8(9),r.dataList=new Array;for(var i=0;i<r.count;i++){var s={};s.startTime=a.getUint32(8*i+10),s.Interval=a.getUint8(8*i+10+4),s.recordCount=a.getUint16(8*i+10+4+1),s.stopMode=a.getUint8(8*i+10+4+1+2),r.dataList[i]=s}}e.handler(t,r)}})},r.prototype.downloadSubHistoryData=function(e){var t=new ArrayBuffer(19),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),n.set1x(4),n.set1x(0),n.set1x(1),n.set1x(1),n.set1x(1),n.set1x(2),n.set1x(1),n.set1x(3),n.set1x(1),e.content=n.buffer,this.sendMsgOperation(11,o.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.heartRate=new Array,t.breathRate=new Array,t.status=new Array,t.statusValue=new Array;for(var n=0;n<t.count;n++)t.breathRate[n]=e.getUint8(4*n+31),t.heartRate[n]=e.getUint8(4*n+31+1),t.status[n]=e.getUint8(4*n+31+1+1),t.statusValue[n]=e.getUint8(4*n+31+1+1+1);return t})},r.prototype.downloadSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,a=function(a,i){if(a!==o.BLE_RET.status.timeout||t<=1)return void(n&&n(a,i));e.handler=n,r.downloadSubHistoryDataTryTimes(e,t-1)};e.handler=a,e.timeout=2e3,r.downloadSubHistoryData(e)},r.prototype.downloadSingleReport=function(e,t,n,r,a,i){var c=this,u=function(s,u){return s!=o.BLE_RET.status.suc?void(i&&i(s)):(a.detail.breathRate.push.apply(a.detail.breathRate,u.breathRate),a.detail.heartRate.push.apply(a.detail.heartRate,u.heartRate),a.detail.status.push.apply(a.detail.status,u.status),a.detail.statusValue.push.apply(a.detail.statusValue,u.statusValue),r+n>=e.recordCount?void(i&&i(s)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void c.downloadSingleReport(e,t,n,r,a,i)))},f={offset:n,count:r,evDataEnable:t};f.startTime=e.startTime,f.handler=u,s.log.i("downloadSubHistoryDataTryTimes: ",f.startTime),c.downloadSubHistoryDataTryTimes(f,10)},r.prototype.downloadReports=function(e,t,n,r,a){var i=e.length,s=this,c={detail:{breathRate:[],heartRate:[],status:[],statusValue:[]}},u=function(u){return u!==o.BLE_RET.status.suc?void(a&&a(u)):(r&&r(n,c),++n>=i?void(a&&a(u)):void s.downloadReports(e,t,n,r,a))};this.downloadSingleReport(e[n],t,0,40,c,u)},r.prototype.downloadHistoryData=function(e){var t=this,n=function(n,r){if(n!=o.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(o.BLE_RET.status.suc,[]);var i=[],c=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),i.push(n))};s.log.i("downloadHistoryData start");var u=function(t){s.log.i("downloadHistoryData complete"),e.completion&&e.completion(t,i)};t.downloadReports(a,e.evDataEnable,0,c,u)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.querySummery(r)};var c=new r;c.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_BM8701,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.BM8701BleApi=r,n.d(t,"bm8701BleApi",function(){return c});var a=n(25),i=n(0),o=n(1),s=n(3);n(4);r.prototype=new a.M800BleApi,r.prototype.querySensorState=function(e){e.frameType=i.FRAME_TYPE.Request,e.msgType=1187,e.deviceType=e.deviceType||i.DEVICE_TYPE.DEVICE_TYPE_BM8701,e.subVersion=0;for(var t=new DataView(new ArrayBuffer(17)),n=o.default.str2ab(e.deviceId),r=new DataView(n),a=0;a<14;a++)a<n.byteLength?t.set1x(r.get1x()):t.set1x(0);t.set2x(e.deviceType),t.set1x(e.num),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x(),a.num=n.get1x(),a.connectState=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})};var c=new r},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_P200A,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.P200aBleApi=r,n.d(t,"p200aBleApi",function(){return c});var a=n(38),i=n(0),o=n(1),s=n(2);r.prototype=new a.PillowBleApi,r.prototype.queryP200aSummery=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(36,i.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});t.count=e.getUint16(13),t.dataList=[];for(var n=0;n<t.count;n++){var r={};r.startTime=e.getUint32(23*n+15),r.timeStep=e.getUint16(23*n+15+4),r.recordCount=e.getUint32(23*n+15+4+2),r.stopMode=e.getUint8(23*n+15+4+2+4),r.firmwareVers=o.default.buf2string(e.buffer.slice(23*n+15+4+2+4+1,23*n+15+4+2+4+1+8)),t.dataList.push(r)}return t})},r.prototype.queryP200aAllSummery=function(e){var t={count:0,dataList:[]},n=this,r=e.handler;e.handler=function(a,o){0==a&&o.count>0?(t.count+=o.count,t.dataList=t.dataList.concat(o.dataList),88==o.count?(e.endtime=o.dataList[87].startTime,n.queryP200aSummery(e)):(e.reverse&&t.dataList.reverse(),r(i.BLE_RET.status.suc,t))):r(a,t)},this.queryP200aSummery(e)},r.prototype.downloadP200SubHistoryData=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsgOperation(35,i.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.data1=[],t.data2=[],t.data3=[],t.data4=[];for(var n=0;n<t.count;n++)t.data1[n]=e.getUint32(16*n+0+22,!0)<<0,t.data2[n]=e.getUint32(16*n+4+22,!0)<<0,t.data3[n]=e.getUint32(16*n+8+22,!0)<<0,t.data4[n]=e.getUint32(16*n+12+22,!0)<<0;return t})},r.prototype.downloadP200aSubHistoryDataTryTimes=function(e,t,n){var r=this,a=e.handler,o=this,c=function(c,u){return s.log.i("P200A-api","downloadP200aSubHistoryDataTryTimes",c),c!==i.BLE_RET.status.timeout||r.DEVICE_CONNECTION_STATE?c!==i.BLE_RET.status.timeout||t<=1?void(a&&a(c,u)):(e.handler=a,void o.downloadP200aSubHistoryDataTryTimes(e,t-1,n)):void a(c,u)};e.handler=c,e.timeout=2e3,n?this.getFullAutoHistoryData(e):o.downloadP200SubHistoryData(e)},r.prototype.downloadP200aSingleReport=function(e,t,n,r,a,o,s){var c=this,u=function(u,f){return u!=i.BLE_RET.status.suc?void(o&&o(u)):(a.detail.data1.push.apply(a.detail.data1,f.data1),a.detail.data2.push.apply(a.detail.data2,f.data2),a.detail.data3.push.apply(a.detail.data3,f.data3),a.detail.data4.push.apply(a.detail.data4,f.data4),r+n>=e.recordCount?void(o&&o(u)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void c.downloadP200aSingleReport(e,t,n,r,a,o,s)))};r>e.recordCount&&(r=e.recordCount);var f={offset:n,count:r,evDataEnable:t};f.startTime=e.startTime,f.handler=u,c.downloadP200aSubHistoryDataTryTimes(f,10,s)},r.prototype.downloadP200aReports=function(e,t,n,r,a,o,s){var c=e.length,u=this,f={detail:{data1:[],data2:[],data3:[],data4:[]}},l=function(l){if(l!==i.BLE_RET.status.suc)return void(a&&a(l));var p=void 0;return r&&(p=r(n,f)),++n>=c?void(a&&a(l)):!1===p?void(a&&a(i.BLE_RET.status.cancel)):void u.downloadP200aReports(e,t,n,r,a,o,s)},p=o?400:40;s>0&&(p=s),this.downloadP200aSingleReport(e[n],t,0,p,f,l,o)},r.prototype.downloadP200aHistoryData=function(e){var t=this,n=function(n,r){if(s.log.i("P200A-api","queryP200aSummery, ",n,r),n!=i.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(i.BLE_RET.status.suc,[]);var o=[],c=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),o.push(n))};s.log.i("downloadP200aReports start");var u=function(t){s.log.i("downloadP200aReports complete"),e.completion&&e.completion(t,o)};t.downloadP200aReports(a,e.evDataEnable,0,c,u,e.zip,e.maxPointOnce)},r={starttime:e.startTime,endtime:e.endTime,reverse:e.reverse,handler:n};this.queryP200aAllSummery(r)};var c=new r;c.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(e){e&&(this.socketClient=e,this.protocol=new o.a,e.setProtocol(this.protocol))}function a(e,t){for(var n=0;n<e.length;n++){var r=e[n];switch(r.musicType){case u.MUSIC_TYPE.LOCAL:t.set2x(r.musicId);break;case u.MUSIC_TYPE.XMLY_ALBUM:case u.MUSIC_TYPE.XMLY_SIGLE:case u.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case u.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t.set4x(r.musicId)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.SocketClientApi1=r;var i=n(2),o=n(10),s=n(3),c=n(1),u=n(0),f=n(9),l="tcp-common-api-1";r.prototype.socketClient=null,r.prototype.TCP_Consts=s.a,r.prototype.synTime=function(e){try{i.log.i(l,"synTime",e),e.frameType=s.a.FrameType.Request,e.msgType=16,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=0;var t=new ArrayBuffer(13),n=new DataView(t);n.set4x(e.timestamp),n.set4x(e.timezone),n.set1x(e.specialSeason),n.set4x(e.specialOffset),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){t===s.a.RET.Succeed?e.handler(t):e.handler(t,{})})}catch(e){i.log.i(l,"synTime",e)}},r.prototype.getSystemInfo=function(e){try{i.log.i(l,"getSystemInfo",e),e.frameType=s.a.FrameType.Request,e.msgType=17,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t===s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),o=new DataView(i),u=0;u<14;u++)o.set1x(n.get1x());a.deviceName=c.default.ab2str(o.buffer.slice(0,13));for(var f=new ArrayBuffer(14),l=new DataView(f),p=0;p<14;p++)l.set1x(n.get1x());a.deviceId=c.default.ab2str(l.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x(),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(DataView.NO_SIGNED),a.busineesCooperationNumber=n.get2x(),a.pcbVersion=n.get2x(),a.wifiMac=n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED),e.handler(t,a)}else e.handler(t)})}catch(e){i.log.i(l,"getSystemInfo",e)}},r.prototype.getSystemVersionInfo=function(e){try{i.log.i(l,"getSystemVersionInfo",e),e.frameType=s.a.FrameType.Request,e.msgType=18,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t===s.a.RET.Succeed){var a=n.get2x();e.handler(t,a)}else e.handler(t)})}catch(e){i.log.i(l,"getSystemVersionInfo",e)}},r.prototype.restoreFactoryDefaults=function(e){try{i.log.i(l,"restoreFactoryDefaults",e),e.frameType=s.a.FrameType.Request,e.msgType=19,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=0;var t=new ArrayBuffer(1),n=new DataView(t);n.set1x(0),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler(t)})}catch(e){i.log.i(l,"restoreFactoryDefaults",e)}},r.prototype.sceneConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=33,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(1024),r=new DataView(n);r.set1x(t),r.set1x(e.count);for(var a=e.sleepSceneConfigs,o=0;o<a.length;o++){var f=a[o];r.set8x(f.sceneId||100),r.set1x(f.flag||1),r.set1x(f.sceneType||0),r.set1x(f.monitorFlag||1),r.set2x(f.monitorDeviceType);for(var p=c.default.str2ab(f.monitorDeviceId),d=new DataView(p),g=0;g<14;g++)g<p.byteLength?r.set1x(d.get1x()):r.set1x(0);r.set1x(f.sleepAidDeviceFlag||1),r.set1x(f.sleepAidFlag||1);var h=0;1==f.musicFlag&&(h|=1),1==f.lightFlag&&(h|=2),r.set1x(h),r.set1x(f.volume),r.set1x(f.lightBrightness),r.set1x(f.lightColorR),r.set1x(f.lightColorG),r.set1x(f.lightColorB),r.set1x(f.lightColorW),r.set1x(f.aromatherapySpeed||0),r.set1x(f.smartStop),r.set1x(f.sleepAidTime),r.set1x(f.smartAlarm)}e.content=r.buffer.slice(0,r.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"sceneOperation",e)}},r.prototype.alarmConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=35,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(1024),r=new DataView(n);r.set1x(t),r.set1x(e.count);for(var a=e.alarms,o=0;o<a.length;o++){var c=a[o];r.set8x(c.alarmId),r.set1x(c.flag),r.set1x(c.smartFlag),r.set1x(c.smartOffset),r.set1x(c.hour),r.set1x(c.minute),r.set1x(c.weekday),r.set1x(c.lazyCount),r.set1x(c.lazyTime),r.set1x(c.volume),r.set1x(c.lightBrightness),r.set1x(c.aromatherapySpeed),r.set1x(c.vibratorFlag);var p=c.music;f.a.musicConfigFill(p,r),r.set4x(c.timestamp)}e.content=r.buffer.slice(0,r.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"alarmConfig",e)}},r.prototype.centerKeyConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=44,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(4),r=new DataView(n);r.set1x(t),r.set1x(e.lightFlag),r.set1x(e.musicFlag),r.set1x(e.aromatherapyFlag),e.content=r.buffer,this.sendMsg(e,e.content,function(n,r,a){n==s.a.RET.Succeed?(t===u.OPERATION_TYPE.GET&&(r.get1x(),a.data={lightFlag:r.get1x(),musicFlag:r.get1x(),aromatherapyFlag:r.get1x()}),e.handler&&e.handler(n,r,a)):e.handler&&e.handler(n)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.aromatherapyTimerConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=45,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(1024),r=new DataView(n);r.set1x(t),r.set1x(e.operationCode);var a=e.aromatherapyList;switch(e.operationCode){case 1:break;case 2:case 5:case 6:var o=a[0];o?r.set8x(o.id):i.log.i("定时香薰配置参数错误");break;case 3:case 4:f.a.aromatherapyTimerListConfig(a,r)}e.content=r.buffer.slice(0,r.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.albumMusicConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=39,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(1024),r=new DataView(n);r.set1x(t);var o=e.music,f=o.albumType;if(o.soundLightFlag&&(f|=o.soundLightFlag<<7),r.set1x(f),r.set4x(o.albumId),o.albumType==u.MUSIC_TYPE.XMLY_ALBUM)r.set2x(0);else{r.set2x(o.count);a(o.musicList,r)}e.content=r.buffer.slice(0,r.position),i.log.i("send data----",c.default.buffer2Arr(e.content)),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"alarmConfig",e)}},r.prototype.aromatherapyTimerConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=45,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=void 0!=e.operationType?e.operationType:u.OPERATION_TYPE.SET,n=new ArrayBuffer(1024),r=new DataView(n);r.set1x(t),r.set1x(e.operationCode);var a=e.aromatherapyList;switch(e.operationCode){case 1:break;case 2:case 5:case 6:var o=a[0];o?r.set8x(o.id):i.log.i("定时香薰配置参数错误");break;case 3:case 4:f.a.aromatherapyTimerListConfig(a,r)}e.content=r.buffer.slice(0,r.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.lightOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=48,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);e.mode?n.set1x(e.operationCode|e.mode<<4):n.set1x(e.operationCode),n.set1x(e.lightBrightness),f.a.lightConfigFill(e.light,n),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.musicOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=49,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);e.mode?n.set1x(e.operationCode|e.mode<<4):n.set1x(e.operationCode),5==e.operationCode?n.set2x(e.seek):(n.set1x(e.volume),f.a.musicConfigFill(e.music,n)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.aromatherapyOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=55,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(2),n=new DataView(t);e.mode?n.set1x(e.operationCode|e.mode<<4):n.set1x(e.operationCode),e.aromatherapySpeed?n.set1x(e.aromatherapySpeed):i.log.i("香薰操作，参数错误，香薰速率没有传"),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.oneKeyOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=55,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);e.mode?n.set1x(e.operationCode|e.mode<<4):n.set1x(e.operationCode),1==e.operationCode&&(e.aromatherapySpeed?n.set1x(e.aromatherapySpeed):i.log.i("一键开启操作香薰速率参数错误"),n.set1x(e.lightBrightness),f.a.lightConfigFill(e.light,n)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.sceneOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=50,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.operationCode),n.set8x(e.sceneId||100),n.set1x(255),n.set1x(255),n.set1x(255),n.set1x(0),n.set1x(e.lightFlag),n.set1x(255),n.set1x(255),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.sleepAidOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=51,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(4),n=new DataView(t);n.set1x(e.operationCode),n.set1x(e.lightFlag),n.set1x(e.musicFlag),n.set1x(e.aromatherapyFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.alarmOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=52,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);if(n.set1x(e.operationCode),n.set8x(e.alarmId),3==e.operationCode){n.set1x(e.volume),n.set1x(e.lightBrightness);var r=e.music;f.a.musicConfigFill(r,n)}e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.previewOperation=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=53,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(3),n=new DataView(t);n.set1x(e.operationCode),n.set1x(e.exitCode),n.set1x(e.rebootFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"centerKeyConfig",e)}},r.prototype.getDeviceExceptionStatus=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=64,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getDeviceExceptionStatus",e)}},r.prototype.getWorkMode=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=65,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=f.a.workModeParse(n,e.deviceType);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getWorkMode",e)}},r.prototype.getDeviceMusicList=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=66,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a={};a.count=n.get1x(),a.musicIdList=[];for(var i=0;i<a.count;i++){var o=n.get2x();a.musicIdList.push(o)}e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getWorkMode",e)}},r.prototype.getMusicProgress=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=69,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x(),i=n.get2x(),o=n.get1x(),c=f.a.musicConfigParse(n);c.musicStatus=a,c.seek=i,c.volume=o,c.soundLightFlag=n.get1x(),e.handler&&e.handler(t,c)}else e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getMusicProgress",e)}},r.prototype.getUpgradeProgress=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=79,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a={};a.upgradeStatus=n.get1x(),a.hardVersion=n.get2x(),a.seek=n.get4x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getMusicProgress",e)}},r.prototype.uploadFirewareSummery=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=81,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set2x(e.currenVersion),n.set2x(e.newVersion),n.set1x(e.updateType),n.setStr(e.fileUrl),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(l,"getMusicProgress",e)}},r.prototype.registerWorkModeCallback=function(e){return this.socketClient.onPostMsg(65,function(t,n){var r=new DataView(t),a=(r.get1x(),f.a.workModeParse(r,n.deviceType));e&&e(a)})},r.prototype.unregisterWorkModeCallback=function(e){this.socketClient.removePostMsgListener(65,e)},r.prototype.registerMusicProgressCallback=function(e){return this.socketClient.onPostMsg(69,function(t,n){var r=new DataView(t),a=(r.get1x(),r.get1x()),i=r.get2x(),o=r.get1x(),s=f.a.musicConfigParse(r);s.musicStatus=a,s.seek=i,s.volume=o,s.soundLightFlag=r.get1x(),e&&e(s)})},r.prototype.unregisterMusicProgressCallback=function(e){this.socketClient.removePostMsgListener(69,e)},r.prototype.sendMsg=function(e,t,n){i.log.i(l,"sendMsg-start",e,c.default.buffer2Arr(t),this);try{this.socketClient.sendPacket({frameType:e.frameType,deviceType:e.deviceType,msgType:e.msgType,content:t,timeout:e.timeout||s.a.timeout,handler:function(e,t,r){if(e===s.a.RET.Succeed&&t&&t.byteLength>0){var a=new DataView(t);a.get1x();0===a.get1x()?n(s.a.RET.Succeed,a,r):n(s.a.RET.Failed,a,r)}else n(s.a.RET.Timeout,void 0)}})}catch(e){i.log.e(l,"sendMsg",e)}}},function(e,t,n){"use strict";function r(e){if(e){var t=e.conf.ip+"_"+e.conf.port;if(f[t]){var n=f[t];return n.socketClient=e,n}f[t]=this,this.socketClient=e}}function a(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=u.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x(),t.num=e.get1x(),t.collectStatus=e.get1x(),t.timestamp=e.get4x(1),t}Object.defineProperty(t,"__esModule",{value:!0}),t.M800TcpApi=r;var i=n(5),o=n(3),s=n(19),c=n(9),u=n(1),f=(n(0),{});r.prototype=new i.SocketClientApi2,r.prototype.startCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(27),n=new DataView(t);n.set2x(9),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){s.a.i(logTip,"startCollect",e)}},r.prototype.stopCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(27),n=new DataView(t);n.set2x(10),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){s.a.i(logTip,"stopCollect",e)}},r.prototype.getDeviceCollectStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=1026,e.deviceType=e.deviceType,e.subVersion=0;for(var t=new ArrayBuffer(17),n=new DataView(t),r=u.default.str2ab(e.deviceId),i=new DataView(r),c=0;c<14;c++)c<r.byteLength?n.set1x(i.get1x()):n.set1x(0);n.set2x(e.deviceType),n.set1x(e.serialNumber),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var i=a(n);e.handler&&e.handler(t,i)}else e.handler&&e.handler(t)})}catch(e){s.a.i(logTip,"getDeviceOnlineStatus",e)}},r.prototype.startRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(19),n=new DataView(t);n.set2x(7),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){s.a.i(logTip,"startRealData",e)}},r.prototype.stopRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(19),n=new DataView(t);n.set2x(8),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){s.a.i(logTip,"stopRealData",e)}},r.prototype.registerRealDataCallback=function(e){return this.socketClient.onPostMsg(1536,function(t,n,r){var a=new DataView(t),i=c.a.m800RealDataParse(a);e&&e(i,r)})},r.prototype.unregisterRealDataCallback=function(e){this.socketClient.removePostMsgListener(1536,e)}},function(e,t,n){var r=n(1),a=n(6),i=a.Map,o=n(14),s=o.crc32buf,c=n(15),u=c.crc8buf,f=n(44),l=n(12),p=l.InvokerManager,d=n(2),g=d.log,h=n(2),y=h.setLogConfig,v=n(4),T=n(47),E=n(20),_=E.Queue,m=n(11),w=n(7),x=n(29),D=n(33),b=n(24),A=n(0),C=n(31),S=n(32),B=S.INIT_CONF,I=S._const,M=n(0),O=M.BLE_RET,V=M.FRAME_TYPE,R=M.DEVICE_TYPE,P=n(28),N=P.setBleNative,k=n(8),L=n(51),U=L.z400tBleApi,F=n(52),Y=F.z400t2BleApi,q=n(34),W=q.sa10012Api,G=n(53),j=G.sa10015BleApi,K=n(54),H=K.sa10014BleApi,X=n(55),z=X.sa1001BleApi,Z=n(37),J=Z.b501BleApi,Q=n(56),$=Q.brigeBleApi,ee=Q.bridge2BleApi,te=n(57),ne=te.gp300BleApi,re=n(38),ae=re.pillowBleApi,ie=n(58),oe=ie.b501tBleApi,se=n(25),ce=se.m800BleApi,ue=n(59),fe=ue.z400twp3BleApi,le=n(60),pe=le.m871wBleApi,de=n(39),ge=de.bm8701BleApi,he=n(61),ye=he.bm8701_2BleApi,ve=n(40),Te=ve.p200aBleApi,Ee=n(62),_e=Ee.sn902bBleApi,me=n(63),we=me.sn913eBleApi,xe=n(36),De=xe.ew201bBleApi,be=n(65),Ae=be.ew202wApi,Ce=n(66),Se=Ce.blanketBleApi,Be=n(17),Ie=Be.zp100BleApi,Me=n(67),Oe=Me.p401mBleApi,Ve=n(68),Re=Ve.php100BleApi,Pe=n(69),Ne=Pe.p102tBleApi,ke=n(18),Le=ke.SocketClient,Ue=n(41),Fe=n(5),Ye=n(70),qe=n(71),We=n(72),Ge=We.WebSocketClient,je=n(73),Ke=je.BrigeTcpApi,He=n(74),Xe=He.NoxTcpApi,ze=n(75),Ze=ze.NoxApApi,Je=n(78),Qe=Je.DotTcpApi,$e=n(79),et=$e.PillowTcpApi,tt=n(80),nt=tt.Z400TWPTcpApi,rt=n(81),at=rt.NoxAromaTcpApi,it=n(82),ot=it.AromaLanApi,st=n(42),ct=st.M800TcpApi,ut=n(83),ft=ut.M871WTcpApi,lt=n(84),pt=lt.SN913TcpApi,dt=n(85),gt=dt.EW202WTcpApi;e.exports={medicaBle:m,medicaBleProtocol:w,medicaBleNative:x.default,medicaNetNative:D.default,medicaTcpNative:b.default,bleCommonApi:k,bufUtil:r.default,Map:i,crc32buf:s,crc8buf:u,dom:f,InvokerManager:p,log:g,setLogConfig:y,math:v,md5:T,Queue:_,z400tBleApi:U,z400t2BleApi:Y,sa1001BleApi:z,sa10012Api:W,sa10015BleApi:j,sa10014BleApi:H,b501BleApi:J,b501tBleApi:oe,brigeBleApi:$,bridge2BleApi:ee,gp300BleApi:ne,pillowBleApi:ae,m800BleApi:ce,z400twp3BleApi:fe,m871wBleApi:pe,bm8701BleApi:ge,bm8701_2BleApi:ye,p200aBleApi:Te,sn902bBleApi:_e,sn913eBleApi:we,ew201bBleApi:De,ew202wApi:Ae,blanketBleApi:Se,zp100BleApi:Ie,php100BleApi:Re,p401mBleApi:Oe,p102tBleApi:Ne,tcpCommonApi1:Ue,tcpCommonApi2:Fe,MedicaCommonWAN:Ye.MedicaCommonWAN,MedicaCommonLan:qe.MedicaCommonLAN,SocketClient:Le,NoxApApi:Ze,BrigeTcpApi:Ke,NoxTcpApi:Xe,DotTcpApi:Qe,PillowTcpApi:et,Z400TWPTcpApi:nt,NoxAromaTcpApi:at,AromaLanApi:ot,M800TcpApi:ct,M871WTcpApi:ft,SN913TcpApi:pt,EW202WTcpApi:gt,WebSocketClient:Ge,constants:A,wxBleNative:C.default,INIT_CONF:B,_const:I,setBleNative:N,BLE_RET:O,FRAME_TYPE:V,DEVICE_TYPE:R,version:"2.2.0"}},function(e,t,n){"use strict";function r(e){var t=document.querySelectorAll(e);return 0===t.length?null:1===t.length?t[0]:t}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getElement:r,getStyle:function(e,t){var n=void 0;return"string"==typeof e&&(e=r(e)),"[object NodeList]"===Object.prototype.toString.call(e)&&(e=e[0]),n=window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle,t?n[t]:n},getScrollPos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return{x:void 0!==e.pageXOffset?e.pageXOffset:e.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:e.scrollTop}}}},function(e,t,n){"use strict";function r(e){this.conf=e||i,this.ws=void 0,this.connected=!1,this.msgCache=new a.default.Queue,this.keepAliveId=null,this.initWebSocket=function(){var t=this;try{var n=this.conf.websocket;if(!n.available||!n.url)return null;if(!this.ws||!this.connected){var r=!1;this.ws||(this.ws=new WebSocket(e.websocket.url),r=!0),(r||t.ws.readyState===t.ws.CLOSED)&&(t.ws.onopen=function(){console.log("TAG:base websocket open"),t.connected=!0,t.sendCache()},t.ws.onclose=function(){console.log("TAG:base websocket close"),t.connected=!1,t.ws=void 0},t.ws.onmessage=function(e){})}}catch(e){console.error("TAG:base Comm.Error websocket init",e)}},this.sendCache=function(){var e=this;this.conf.websocket.available&&setTimeout(function(){e.ws.readyState===e.ws.OPEN&&e.msgCache.count()>0&&(e.wsSend(e.msgCache.front()),e.msgCache.dequeue()),e.sendCache()},100)},this.wsSend=function(e){var t=this;try{t.conf.websocket.available&&(t.ws.readyState===t.ws.OPEN?t.ws.send(e):(t.msgCache.enqueue(e),console.error("TAG:base Comm.Error","WebSocket connected:",t.ws.readyState,"send later")))}catch(e){console.error("TAG:base sendError",e)}},this.keepAlive=function(){var e=this;this.conf.websocket.available&&(e.keepAliveId=setInterval(function(){e.initWebSocket()},500))},this.keepAlive()}t.a=r;var a=n(20),i={websocket:{available:!1,url:""}};r.prototype.close=function(){this.keepAliveId&&clearInterval(this.keepAliveId),this.ws&&this.ws.close()}},function(e,t,n){"use strict";function r(e){try{return wx?wx.getStorageSync(e):localStorage.getItem(e)}catch(t){return o.get(e)}}function a(e,t){try{wx?wx.setStorageSync(e,t):localStorage.setItem(e,t)}catch(n){o.put(e,t)}}var i=n(6),o=new i.Map;t.a={getItem:r,setItem:a}},function(e,t){function n(e){return p(r(l(e),e.length*g))}function r(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,a=-1732584194,f=271733878,l=0;l<e.length;l+=16){var p=n,d=r,g=a,h=f;n=i(n,r,a,f,e[l+0],7,-680876936),f=i(f,n,r,a,e[l+1],12,-389564586),a=i(a,f,n,r,e[l+2],17,606105819),r=i(r,a,f,n,e[l+3],22,-1044525330),n=i(n,r,a,f,e[l+4],7,-176418897),f=i(f,n,r,a,e[l+5],12,1200080426),a=i(a,f,n,r,e[l+6],17,-1473231341),r=i(r,a,f,n,e[l+7],22,-45705983),n=i(n,r,a,f,e[l+8],7,1770035416),f=i(f,n,r,a,e[l+9],12,-1958414417),a=i(a,f,n,r,e[l+10],17,-42063),r=i(r,a,f,n,e[l+11],22,-1990404162),n=i(n,r,a,f,e[l+12],7,1804603682),f=i(f,n,r,a,e[l+13],12,-40341101),a=i(a,f,n,r,e[l+14],17,-1502002290),r=i(r,a,f,n,e[l+15],22,1236535329),n=o(n,r,a,f,e[l+1],5,-165796510),f=o(f,n,r,a,e[l+6],9,-1069501632),a=o(a,f,n,r,e[l+11],14,643717713),r=o(r,a,f,n,e[l+0],20,-373897302),n=o(n,r,a,f,e[l+5],5,-701558691),f=o(f,n,r,a,e[l+10],9,38016083),a=o(a,f,n,r,e[l+15],14,-660478335),r=o(r,a,f,n,e[l+4],20,-405537848),n=o(n,r,a,f,e[l+9],5,568446438),f=o(f,n,r,a,e[l+14],9,-1019803690),a=o(a,f,n,r,e[l+3],14,-187363961),r=o(r,a,f,n,e[l+8],20,1163531501),n=o(n,r,a,f,e[l+13],5,-1444681467),f=o(f,n,r,a,e[l+2],9,-51403784),a=o(a,f,n,r,e[l+7],14,1735328473),r=o(r,a,f,n,e[l+12],20,-1926607734),n=s(n,r,a,f,e[l+5],4,-378558),f=s(f,n,r,a,e[l+8],11,-2022574463),a=s(a,f,n,r,e[l+11],16,1839030562),r=s(r,a,f,n,e[l+14],23,-35309556),n=s(n,r,a,f,e[l+1],4,-1530992060),f=s(f,n,r,a,e[l+4],11,1272893353),a=s(a,f,n,r,e[l+7],16,-155497632),r=s(r,a,f,n,e[l+10],23,-1094730640),n=s(n,r,a,f,e[l+13],4,681279174),f=s(f,n,r,a,e[l+0],11,-358537222),a=s(a,f,n,r,e[l+3],16,-722521979),r=s(r,a,f,n,e[l+6],23,76029189),n=s(n,r,a,f,e[l+9],4,-640364487),f=s(f,n,r,a,e[l+12],11,-421815835),a=s(a,f,n,r,e[l+15],16,530742520),r=s(r,a,f,n,e[l+2],23,-995338651),n=c(n,r,a,f,e[l+0],6,-198630844),f=c(f,n,r,a,e[l+7],10,1126891415),a=c(a,f,n,r,e[l+14],15,-1416354905),r=c(r,a,f,n,e[l+5],21,-57434055),n=c(n,r,a,f,e[l+12],6,1700485571),f=c(f,n,r,a,e[l+3],10,-1894986606),a=c(a,f,n,r,e[l+10],15,-1051523),r=c(r,a,f,n,e[l+1],21,-2054922799),n=c(n,r,a,f,e[l+8],6,1873313359),f=c(f,n,r,a,e[l+15],10,-30611744),a=c(a,f,n,r,e[l+6],15,-1560198380),r=c(r,a,f,n,e[l+13],21,1309151649),n=c(n,r,a,f,e[l+4],6,-145523070),f=c(f,n,r,a,e[l+11],10,-1120210379),a=c(a,f,n,r,e[l+2],15,718787259),r=c(r,a,f,n,e[l+9],21,-343485551),n=u(n,p),r=u(r,d),a=u(a,g),f=u(f,h)}return Array(n,r,a,f)}function a(e,t,n,r,a,i){return u(f(u(u(t,e),u(r,i)),a),n)}function i(e,t,n,r,i,o,s){return a(t&n|~t&r,e,t,i,o,s)}function o(e,t,n,r,i,o,s){return a(t&r|n&~r,e,t,i,o,s)}function s(e,t,n,r,i,o,s){return a(t^n^r,e,t,i,o,s)}function c(e,t,n,r,i,o,s){return a(n^(t|~r),e,t,i,o,s)}function u(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function f(e,t){return e<<t|e>>>32-t}function l(e){for(var t=Array(),n=(1<<g)-1,r=0;r<e.length*g;r+=g)t[r>>5]|=(e.charCodeAt(r/g)&n)<<r%32;return t}function p(e){for(var t=d?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}var d=0,g=8;e.exports={hex_md5:n}},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,function(global){"use strict";var _Base64=global.Base64,version="2.4.9",buffer;if(void 0!==module&&module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),t>=2?"=":b64chars.charAt(n>>>6&63),t>=1?"=":b64chars.charAt(63&n)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return fromCharCode(55296+(n>>>10))+fromCharCode(56320+(1023&n));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,n=t%4,r=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),a=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return a.length-=[0,0,2,1][n],a.join("")},atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,cb_decode)},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),void 0!==module&&module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}})}).call(exports,__webpack_require__(30))},function(e,t,n){"use strict";function r(e){var t=window.location.hash.match(new RegExp("(?:#|&)"+e+"=([^&]*)(&|$)"));return(t?decodeURIComponent(t[1]):"")||a(e)}function a(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}function i(e){e=e||location.href;var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},r=t.search.replace(/^\?/,"").split("&"),a=r.length,i=0;i<a;i++)r[i]&&(e=r[i].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[void 0,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[void 0,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}}t.a={getParameter:r,getParameterByName:a,urlParse:i}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(){console.warn(j,"cb not use",arguments)}function i(e,t,n){var r="__hilink_"+e+"_callback";return window[r]=function(){var i;(i=console).log.apply(i,[j,e+" - callback"].concat(Array.prototype.slice.call(arguments))),arguments[0]&&!n?arguments[0]=JSON.parse(arguments[0]):"function"==typeof n&&(arguments[0]=n(arguments[0])),t&&t.apply(this,arguments),window[r]=a},r}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("object"===("undefined"==typeof hilink?"undefined":W(hilink))){var n;return console.log("hilink-native",e,t),(n=hilink)[e].apply(n,r(t))}console.log(j,e,"not found")}function s(e){var t="__getSystemInfoSyncCallback";G[t]=function(){e&&e.apply(this,arguments),delete G[t]},hilink.getSystemInfoSync(t)}function c(e){u(e)}function u(e){var t=hilink.openBluetoothAdapter();q.log.i(j,"openBluetoothAdapter",t),e&&t===K&&e(Y.default.BLE_RET.Boolean.True)}function f(e){var t=hilink.closeBluetoothAdapter();q.log.i(j,"closeBluetoothAdapter",t),e&&t===K&&e(Y.default.BLE_RET.Boolean.True)}function l(e){var t="onBluetoothAdapterStateChange",n="__"+t+"Callback";q.log.i(j,t),G[n]=function(t){q.log.i(j,n,t),t=JSON.parse(t),e&&e.call(this,Number(t.available),Number(t.discovering))},hilink[t](n)}function p(e){var t="getBluetoothAdapterState",n="__"+t+"Callback";G[n]=function(r){r=JSON.parse(r),q.log.i.apply(q.log,[j,t].concat(Array.prototype.slice.call(arguments)));var a=r.available?Y.default.BLE_RET.bleStatus.available:Y.default.BLE_RET.bleStatus.close;e&&e.call(this,a),delete G[n]},hilink[t](n)}function d(e,t,n){var r="startBluetoothDevicesDiscovery";if(e&&!(e instanceof Array))throw"services must be an Array";H={},hilink.onBluetoothDeviceFound("__onBluetoothDeviceFoundCallback");var a=hilink[r](e,t,0);q.log.i.apply(q.log,[j,r,a].concat(Array.prototype.slice.call(arguments)))}function g(e){for(var t=[],n=0;n<e.length;)t.push(Number("0x"+e.slice(n,n+=2)));return t}function h(e){var t=F.default.arr2Buffer(e);return F.default.buffer2hex(t)}function y(e){if(!e||!e.length)return[];for(var t=[],n=0;n<e.length;n++){var r=e[n],a=255===e[n+1];r&&(a&&(t=t.concat(e.slice(n+2,n+r+1))),n+=r)}return t}function v(e){var t="onBluetoothDeviceFound",n="__"+t+"Callback";G[n]=function(n){q.log.i(j,t,n);try{n=JSON.parse(n)}catch(e){q.log.i(j,t,"parse fail"),n=null}if(n){var r=n;if(r instanceof Array||(r=[r]),r&&r.length>0){for(var a=[],i=0;i<r.length;i++){var o=JSON.parse(JSON.stringify(r[i]));o.name=o.localName,delete o.localName;var s=r[i].advertisData;s&&"string"==typeof s&&(o.advertisData=U?g(s.slice(1,s.length-1).replace(/\s+/g,"")):y(g(s))),r[i].serviceData&&"string"==typeof r[i].serviceData&&(o.serviceData=g(r[i].serviceData)),H[r[i].deviceId]||a.push(o),H[r[i].deviceId]=o}a.length&&e(a)}}},hilink[t](n)}function T(){hilink.stopBluetoothDevicesDiscovery()}function E(){var e=[];for(var t in H)e.push(H[t]);return e}function _(e){try{var t="getConnectedBluetoothDevices",n="__"+t+"Callback";q.log.i(j,t,"start"),G[n]=function(n){n=JSON.parse(n),q.log.i.apply(q.log,[j,t].concat(Array.prototype.slice.call(arguments))),e&&e(n===K)},hilink[t](["0000ffe5-0000-1000-8000-00805f9b34fb","0000ffe0-0000-1000-8000-00805f9b34fb","0000fff0-0000-1000-8000-00805f9b34fb","0000ffb0-0000-1000-8000-00805f9b34fb"],n)}catch(e){}throw new Error("hilink nonsupport")}function m(e,t,n){var r=void 0;r=hilink&&"function"==typeof hilink.createBleConnection?hilink.createBleConnection(e,2):hilink.createBLEConnection(e,2),console.log(j,"createBleConnection",e,U,t,r),X.state=!1;var a="onBLEServicesDiscovered",i="__"+a+"Callback";G[i]=function(e){e=JSON.parse(e),q.log.i.apply(q.log,[j,i].concat(Array.prototype.slice.call(arguments))),X.state=!0,n&&n(e===K)},hilink[a](i)}function w(e){q.log.i(j,"closeBLEConnection-start",arguments),hilink.closeBLEConnection(e)}function x(e){var t="onBLEConnectionStateChange",n="__"+t+"Callback";q.log.i(j,"onBLEConnectionStateChange"),G[n]=function(t){q.log.i(j,n,t),t=JSON.parse(t);var r=t.connected?Y.default.BLE_RET.Boolean.True:Y.default.BLE_RET.Boolean.False;e&&e({deviceId:t.deviceId,connected:r})},hilink[t](n)}function D(e,t,n,r){q.log.i(j,"discoverBLEServerAndCharacteristic-start"),b(function(){A(e,t,n,r)})}function b(e){X.state?e&&e():X.stateChange=e}function A(e,t,n,r){var a="readBLECharacteristicValue",i="__"+a+"Callback";q.log.i(j,"readBLECharacteristicValue-start",e,t,n,i),G[i]=function(e){e=JSON.parse(e),q.log.i.apply(q.log,[j,a].concat(Array.prototype.slice.call(arguments))),r&&r(Y.default.BLE_RET.Boolean.True)},hilink[a](e,t,n,i),r&&r(Y.default.BLE_RET.Boolean.True)}function C(e,t,n,r,a){q.log.i(j,"notifyBLECharacteristicValueChange-start",arguments),X.deviceId=e,X.serviceId=t;var i=hilink.notifyBLECharacteristicValueChange(e,t,n,R(r));a&&a(i===K)}function S(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments[5],o=U?"writeBLECharacteristicValue":"writeBLECharacteristicValueIsDelayTime",s="__"+o+"Callback";G[s]=function(e){e=JSON.parse(e),q.log.i(j,"writeBLECharacteristicValue-callback, code: ",e),i&&i(e===K?0:10010)},q.log.i(j,"writeBLECharacteristicValue-start",e,t,n,h(a)),U?hilink[o](e,t,n,h(a),s):hilink[o](0,e,t,n,h(a),s)}function B(e){var t="onBLECharacteristicValueChange",n="__"+t+"Callback";G[n]=function(t){q.log.i(j,"onBLECharacteristicValueChange-callback",JSON.stringify(t));var n=[];t=JSON.parse(t),t&&t.data&&(n=g(t.data)),t.deviceId=t.deviceId||X.deviceId,t.serviceId=t.serviceId||X.serviceId,t.value=n,q.log.i(j,"onBLECharacteristicValueChange-callback",JSON.stringify(t)),e&&e(t)},hilink[t](n)}function I(e){return o("requestMtu",[i("requestMtu",e)])}function M(e,t){if(U)t({mtu:20,status:1});else{var n="registerRequestMtu";o(n,[i(n,t,function(e){var t=JSON.parse(e);return t.status=0===t.status?1:0,t.mtu-=3,t})]),o("requestMtu",[e+3])}}function O(e,t){return Y.default.BLE_RET.Boolean.True}function V(){return Y.default.BLE_RET.platform.android}function R(e){return e===Y.default.BLE_RET.Boolean.True}function P(e){var t="getCurrentRegisteredDevice",n="__"+t+"Callback";G[n]=function(t){q.log.i(j,n,t),t=JSON.parse(t),e&&e(t),delete G[n]},hilink[t](n)}function N(e){var t="getCurrentUnregisteredDevice",n="__"+t+"Callback";G[n]=function(t){q.log.i(j,n,t),t=JSON.parse(t),e&&e(t),delete G[n]},hilink[t](n)}function k(e,t){var n=e.sn,r=e.fwv,a=e.hwv,i="__registerBleDeviceCallback";G[i]=function(e){q.log.i(j,i,e),e=JSON.parse(e),t&&t(e),delete G[i]},hilink.registerBleDevice(n,r,a,i)}function L(e){return U?0:hilink.requestConnectionPriority(e)}var U,F=n(1),Y=n(0),q=n(2),W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G=window,j="hilink-native",K=0;void 0!==G&&(U=-1!=navigator.appVersion.search(/iPhone|Mac/));var H={},X={bool:!1,stateChange:null,deviceId:null,serviceId:null,get state(){return this.bool},set state(e){this.bool=e,this.stateChange&&e&&this.stateChange()}};t.a={$nativeName:"hilink",getSystemInfoSync:s,getPlatform:V,initializeBluetoothAdapter:c,openBluetoothAdapter:u,closeBluetoothAdapter:f,onBluetoothAdapterStateChange:l,getBluetoothAdapterState:p,startBluetoothDevicesDiscovery:d,onBluetoothDeviceFound:v,stopBluetoothDevicesDiscovery:T,getBluetoothDevices:E,getConnectedBluetoothDevices:_,createBLEConnection:m,closeBLEConnection:w,onBLEConnectionStateChange:x,discoverBLEServerAndCharacteristic:D,notifyBLECharacteristicValueChange:C,writeBLECharacteristicValue:S,onBLECharacteristicValueChange:B,getBluetoothMTU:I,setMTUSize:M,setBluetoothRecieveInterval:O,getCurrentUnregisteredDevice:N,getCurrentRegisteredDevice:P,registerBleDevice:k,requestConnectionPriority:L}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_RESTON_Z400T,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"z400tBleApi",function(){return s});var a=n(13),i=n(0),o=n(2);r.prototype=new a.a,r.prototype.downloadSubHistoryData=function(e){o.log.i("downloadSubHistoryData startTime: ",e.startTime);var t=new ArrayBuffer(23),n=new DataView(t);n.set4x(e.startTime).set4x(e.offset).set2x(e.count),n.set1x(4).set1x(0).set1x(1).set1x(1).set1x(1).set1x(2).set1x(1).set1x(3).set1x(1).set1x(16).set1x(1).set1x(17).set1x(1),e.content=n.buffer,this.sendMsgOperation(11,i.FRAME_TYPE.Request,e,function(e){var t=DataView.NO_SIGNED,n={heartRate:[],breathRate:[],status:[],statusValue:[],temperature:[],humidity:[]};n.starttime=e.getUint32(12),n.offset=e.getUint32(16),n.count=e.getUint16(20);for(var r=0;r<n.count;r++)e.position=6*r+35,n.breathRate[r]=e.get1x(t),n.heartRate[r]=e.get1x(t),n.status[r]=e.get1x(t),n.statusValue[r]=e.get1x(t),n.temperature[r]=e.get1x(t),n.humidity[r]=e.get1x(t);return n})},r.prototype.downloadSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,a=function(a,o){if(a!==i.BLE_RET.status.timeout||t<=1)return void(n&&n(a,o));e.handler=n,r.downloadSubHistoryDataTryTimes(e,t-1)};e.handler=a,e.timeout=2e3,r.downloadSubHistoryData(e)},r.prototype.downloadSingleReport=function(e,t,n,r,a,s){var c=this,u=function(o,u){return o!=i.BLE_RET.status.suc?void(s&&s(o)):(a.detail.breathRate.push.apply(a.detail.breathRate,u.breathRate),a.detail.heartRate.push.apply(a.detail.heartRate,u.heartRate),a.detail.status.push.apply(a.detail.status,u.status),a.detail.statusValue.push.apply(a.detail.statusValue,u.statusValue),a.detail.temperature.push.apply(a.detail.temperature,u.temperature),a.detail.humidity.push.apply(a.detail.humidity,u.humidity),r+n>=e.recordCount?void(s&&s(o)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void c.downloadSingleReport(e,t,n,r,a,s)))},f={offset:n,count:r,evDataEnable:t};f.startTime=e.startTime,f.handler=u,o.log.i("downloadSubHistoryDataTryTimes startTime",f.startTime),c.downloadSubHistoryDataTryTimes(f,10)},r.prototype.downloadReports=function(e,t,n,r,a){var o=e.length,s=this,c={detail:{breathRate:[],heartRate:[],status:[],statusValue:[],temperature:[],humidity:[]}},u=function(u){return u!==i.BLE_RET.status.suc?void(a&&a(u)):(r&&r(n,c),++n>=o?void(a&&a(u)):void s.downloadReports(e,t,n,r,a))};this.downloadSingleReport(e[n],t,0,40,c,u)},r.prototype.downloadHistoryData=function(e){var t=this,n=function(n,r){if(n!=i.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(i.BLE_RET.status.suc,[]);var s=[],c=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),s.push(n))};o.log.i("downloadHistoryData start");var u=function(t){o.log.i("downloadHistoryData complete"),e.completion&&e.completion(t,s)};t.downloadReports(a,e.evDataEnable,0,c,u)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.querySummery(r)},r.prototype.getTemperatureAndHumidity=function(e){this.sendMsgOperation(34,i.FRAME_TYPE.Request,e,function(e){var t={},n=e.getUint8(12),r=e.getUint8(13);return t.temperature=n,t.humidity=r,t})};var s=new r;s.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_Z400T2,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.Z400t2BleApi=r,n.d(t,"z400t2BleApi",function(){return c});var a=n(13),i=n(0),o=n(1),s=n(2);r.prototype=new a.a,r.prototype.queryZ400t2Summery=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(36,i.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});t.count=e.getUint16(13),t.dataList=new Array;for(var n=0;n<t.count;n++){var r={};r.startTime=e.getUint32(23*n+15),r.timeStep=e.getUint16(23*n+15+4),r.recordCount=e.getUint32(23*n+15+4+2),r.stopMode=e.getUint8(23*n+15+4+2+4),r.firmwareVers=o.default.buf2string(e.buffer.slice(23*n+15+4+2+4+1,23*n+15+4+2+4+1+8)),t.dataList.push(r)}return t})},r.prototype.downloadZ400t2SubHistoryData=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsgOperation(37,i.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.data1=new Array,t.data2=new Array,t.data3=new Array,t.data4=new Array,t.temperature=new Array,t.humidity=new Array;for(var n=0;n<t.count;n++)t.data1[n]=e.getUint32(18*n+0+22,!0)<<0,t.data2[n]=e.getUint32(18*n+4+22,!0)<<0,t.data3[n]=e.getUint32(18*n+8+22,!0)<<0,t.data4[n]=e.getUint32(18*n+12+22,!0)<<0,t.temperature[n]=e.getUint8(18*n+16+22,!0)<<0,t.humidity[n]=e.getUint8(18*n+16+1+22,!0)<<0;return s.log.i("downloadSubHistoryData result: ",t),t})},r.prototype.downloadZ400t2SubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,a=function(a,o){if(a!==i.BLE_RET.status.timeout||t<=1)return void(n&&n(a,o));e.handler=n,r.downloadZ400t2SubHistoryDataTryTimes(e,t-1)};e.handler=a,e.timeout=2e3,r.downloadZ400t2SubHistoryData(e)},r.prototype.downloadZ400t2SingleReport=function(e,t,n,r,a,o){var c=this,u=function(s,u){return s!=i.BLE_RET.status.suc?void(o&&o(s)):(a.detail.data1.push.apply(a.detail.data1,u.data1),a.detail.data2.push.apply(a.detail.data2,u.data2),a.detail.data3.push.apply(a.detail.data3,u.data3),a.detail.data4.push.apply(a.detail.data4,u.data4),a.detail.temperature.push.apply(a.detail.temperature,u.temperature),a.detail.humidity.push.apply(a.detail.humidity,u.humidity),r+n>=e.recordCount?void(o&&o(s)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void c.downloadZ400t2SingleReport(e,t,n,r,a,o)))},f={offset:n,count:r,evDataEnable:t};f.startTime=e.startTime,f.handler=u,s.log.i("downloadSubHistoryDataTryTimes startTime: ",f.startTime),c.downloadZ400t2SubHistoryDataTryTimes(f,10)},r.prototype.downloadZ400t2Reports=function(e,t,n,r,a){var o=e.length,s=this,c={detail:{data1:[],data2:[],data3:[],data4:[],temperature:[],humidity:[]}},u=function(u){return u!==i.BLE_RET.status.suc?void(a&&a(u)):(r&&r(n,c),++n>=o?void(a&&a(u)):void s.downloadZ400t2Reports(e,t,n,r,a))};this.downloadZ400t2SingleReport(e[n],t,0,42,c,u)},r.prototype.downloadZ400t2HistoryData=function(e){var t=this,n=function(n,r){if(s.log.i("Z400T2-api","queryZ400t2Summery  result: ",n,r),n!=i.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(i.BLE_RET.status.suc,[]);var o=[],c=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),o.push(n))};s.log.i("downloadP200aReports start");var u=function(t){s.log.i("downloadP200aReports complete"),e.completion&&e.completion(t,o)};t.downloadZ400t2Reports(a,e.evDataEnable,0,c,u)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.queryZ400t2Summery(r)};var c=new r;c.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){a.Sa10012BleApi.call(this),this.deviceType=i.DEVICE_TYPE.NOX_SA1001_5,this.setMtuEnable=!0,this.maxMtu=500}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"sa10015BleApi",function(){return s});var a=n(34),i=n(0),o=n(35);Object(o.a)(r,a.Sa10012BleApi),r.prototype.bindConfirm=function(e){var t=this,n=new DataView(new ArrayBuffer(1));n.set1x(e.operation),e.content=n.buffer,this.sendMsgOperation(20,i.FRAME_TYPE.Request,e,function(e){return t.fillWithResponseAndPostData({msgType:20,buffer:e,isPost:!1})})};var s=new r;s.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=c.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001_4,this.setMtuEnable=!1}function a(e){var t={},n=new DataView(e);return t.aromaId=n.get1x(DataView.NO_SIGNED),t.aromaFlag=n.get1x(DataView.NO_SIGNED),t.isValid=n.get1x(DataView.NO_SIGNED),t.startHour=n.get1x(DataView.NO_SIGNED),t.startMin=n.get1x(DataView.NO_SIGNED),t.duration=n.get2x(DataView.NO_SIGNED),t}function i(e){var t=new DataView(new ArrayBuffer(7));return t.set1x(e.aromaId),t.set1x(e.aromaFlag),t.set1x(e.isValid),t.set1x(e.startHour),t.set1x(e.startMin),t.set2x(e.duration),e.content=t.buffer,e}function o(e){var t={},n=new DataView(e);return t.alarmId=n.get1x(DataView.NO_SIGNED),t.alarmFlag=n.get1x(DataView.NO_SIGNED),t.smartFlag=n.get1x(DataView.NO_SIGNED),t.smartOffset=n.get1x(DataView.NO_SIGNED),t.hour=n.get1x(DataView.NO_SIGNED),t.minute=n.get1x(DataView.NO_SIGNED),t.week=n.get1x(DataView.NO_SIGNED),t.lazyCount=n.get1x(DataView.NO_SIGNED),t.lazyTime=n.get1x(DataView.NO_SIGNED),t.volume=n.get1x(),t.brightness=n.get1x(DataView.NO_SIGNED),t.rate=n.get1x(DataView.NO_SIGNED),t.shake=n.get1x(DataView.NO_SIGNED),t.musicId=n.get2x(DataView.NO_SIGNED),t.timestamp=n.get4x(DataView.NO_SIGNED),t.isValid=n.get1x(DataView.NO_SIGNED),t}function s(e){var t=new DataView(new ArrayBuffer(20));return t.set1x(e.alarmId),t.set1x(e.alarmFlag),t.set1x(e.smartFlag),t.set1x(e.smartOffset),t.set1x(e.hour),t.set1x(e.minute),t.set1x(e.week),t.set1x(e.lazyCount),t.set1x(e.lazyTime),t.set1x(e.volume),t.set1x(e.brightness),t.set1x(e.rate),t.set1x(e.shake),t.set2x(e.musicId),t.set4x(e.timestamp),t.set1x(e.isValid),e.content=t.buffer,e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"sa10014BleApi",function(){return d});var c=(n(8),n(0)),u=n(1),f=n(4),l=n(36),p="Sa10014BleApi";r.prototype=new l.EW201BApi;var d=new r;r.prototype.fragranceOperation=function(e){var t=e.operation,n=new DataView(new ArrayBuffer(2));n.set1x(t),n.set1x(e.rate),e.content=n.buffer,this.sendMsgOperation(51,c.FRAME_TYPE.Request,e)},r.prototype.pinSet=function(e){var t=new DataView(new ArrayBuffer(18));t.set1x(e.onBleSwitch),t.set1x(e.onBlePinSwitch),1==e.onBlePinSwitch&&t.setStr(e.pinCode,16),e.content=t.buffer,this.sendMsgOperation(38,c.FRAME_TYPE.Request,e)},r.prototype.getSystemInfo=function(e){console.log(p,"getSystemInfo---"),this.sendMsgOperation(17,c.FRAME_TYPE.Request,e,function(e){console.log(p,"getSystemInfo---back",e);var t=new DataView(e),n={};n.deviceName=u.default.buf2string(t.buffer.slice(9,22)),n.deviceId=u.default.buf2string(t.buffer.slice(23,36)),n.deviceType=t.getUint16(37),n.currVersion=t.getUint16(39),n.currVersion=Object(f.padStart)(parseInt(n.currVersion/100),1,0)+"."+Object(f.padStart)(parseInt(n.currVersion%100)),n.facVersion=t.getUint16(41),n.facVersion=Object(f.padStart)(parseInt(n.facVersion/100),1,0)+"."+Object(f.padStart)(parseInt(n.facVersion%100)),n.facTime=t.getUint32(43),n.manufacCode=t.getUint16(47),n.coopCode=t.getUint16(49),n.pcbVersion=t.getUint8(51)+"."+t.getUint8(52);var r=t.getUint8(53),a=t.getUint8(54),i=t.getUint8(55),o=t.getUint8(56),s=t.getUint8(57),c=t.getUint8(58),l=[c,s,o,i,a,r].map(function(e){return Object(f.padStart)(e.toString(16))}).join(":").toUpperCase();return n.deviceMac=l,n.traditionBleName=u.default.buf2string(t.buffer.slice(59,90)),n.bleName=u.default.buf2string(t.buffer.slice(91,122)),n.bleContent=u.default.buf2string(t.buffer.slice(123,154)),n})},r.prototype.retSystemInfo=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(19,c.FRAME_TYPE.Request,e)},r.prototype.getSystemConfigInfo=function(e){console.log(p,"getSystemConfigInfo",e),this.sendMsgOperation(38,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.onBleSwitch=t.get1x(DataView.NO_SIGNED),n.onBlePinSwitch=t.get1x(DataView.NO_SIGNED),n.pinCode=u.default.buf2string(t.buffer.slice(12,28)),console.log(p,"getSystemConfigInfo",e,n),n})},r.prototype.setSystemConfigInfo=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(e.operation),t.set1x(e.value),e.content=t.buffer,this.sendMsgOperation(21,c.FRAME_TYPE.Request,e)},r.prototype.checkTime=function(e){console.log(p,"checkTime---",e);var t=new DataView(new ArrayBuffer(13));t.set4x(e.timestamp),t.set4x(e.timezoneOffset),t.set1x(e.season),t.set4x(e.seasonOffset),e.content=t.buffer,this.sendMsgOperation(22,c.FRAME_TYPE.Request,e)},r.prototype.getClockConfig=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(e.alarmId),e.content=t.buffer,this.sendMsgOperation(34,c.FRAME_TYPE.Request,e,function(t){var n=new Array,r=new DataView(t);r.position=9;var a=1;255==e.alarmId&&(a=5);for(var i=0;i<a;i++){var s=r.position,c=s+18,u=o(r.buffer.slice(s,c));r.position=c,(u.isValid||0==u.alarmId)&&n.push(u)}return n})},r.prototype.colockConfig=function(e){console.log(p,"--aromaTimeConfig---",e);var t=s(e);this.sendMsgOperation(35,c.FRAME_TYPE.Request,t,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.getAromaTimeData=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(e.aromaId),e.content=t.buffer,this.sendMsgOperation(41,c.FRAME_TYPE.Request,e,function(t){var n=new Array,r=new DataView(t);r.position=9;var i=1;255==e.aromaId&&(i=5);for(var o=0;o<i;o++){var s=r.position,c=s+18,u=a(r.buffer.slice(s,c));r.position=c,(u.isValid||0==u.alarmId)&&n.push(u)}return n})},r.prototype.aromaTimeConfig=function(e){console.log(p,"--aromaTimeConfig---",e);var t=i(e);this.sendMsgOperation(40,c.FRAME_TYPE.Request,t,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.asistSleepOperation=function(e){var t=new DataView(new ArrayBuffer(13));t.set1x(e.musicSwitch),t.set2x(e.musicId),t.set1x(e.volume),t.set1x(e.circle),t.set1x(e.lightSwitch),t.set1x(e.brightness),t.set1x(e.colorR),t.set1x(e.colorG),t.set1x(e.colorB),t.set1x(e.colorW),t.set1x(e.smartFlag),t.set1x(e.aidingTime),e.content=t.buffer,console.log(p,"--asistSleepOperation---",e),this.sendMsgOperation(36,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.getAsistConfig=function(e){this.sendMsgOperation(37,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.musicSwitch=t.get1x(DataView.NO_SIGNED),n.musicId=t.get2x(DataView.NO_SIGNED),n.volume=t.get1x(DataView.NO_SIGNED),n.circle=t.get1x(DataView.NO_SIGNED),n.lightSwitch=t.get1x(DataView.NO_SIGNED),n.brightness=t.get1x(DataView.NO_SIGNED),n.colorR=t.get1x(DataView.NO_SIGNED),n.colorG=t.get1x(DataView.NO_SIGNED),n.colorB=t.get1x(DataView.NO_SIGNED),n.colorW=t.get1x(DataView.NO_SIGNED),n.smartFlag=t.get1x(DataView.NO_SIGNED),n.aidingTime=t.get1x(DataView.NO_SIGNED),n})},r.prototype.ligthSwitchOpertaion=function(e){console.log(p,"--ligthSwitchOpertaion---",e);var t=new DataView(new ArrayBuffer(3));t.set1x(e.operation),t.set1x(Math.min(e.brightness,100)),t.set1x(e.colorId),e.content=t.buffer,this.sendMsgOperation(48,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.musicOperation=function(e){console.log(p,"--musicOperation---",e);var t=new DataView(new ArrayBuffer(4));t.set1x(e.operation),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(49,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.centerFuntionKeySet=function(e){console.log(p,"--centerFuntionKeySet---",e);var t=new DataView(new ArrayBuffer(3));t.set1x(e.musicSwitch),t.set1x(e.lightSwitch),t.set1x(e.fragranceSwitch),e.content=t.buffer,this.sendMsgOperation(42,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.centerFuntionGet=function(e){this.sendMsgOperation(43,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.musicSwitch=t.get1x(DataView.NO_SIGNED),n.lightSwitch=t.get1x(DataView.NO_SIGNED),n.fragranceSwitch=t.get1x(DataView.NO_SIGNED),n})},r.prototype.alarmPreviewOperation=function(e){var t=new DataView(new ArrayBuffer(5));t.set1x(e.operation),t.set1x(e.brightness),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(50,c.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.queryWorkMode=function(e){var t=this;this.sendMsgOperation(81,c.FRAME_TYPE.Request,e,function(e){return Object.assign(t.fillWithResponseAndPostData({msgType:81,buffer:e,isPost:!1}))})},r.prototype.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=8:n.position=9,e.msgType){case 81:t.configMode=n.get1x(DataView.NO_SIGNED),t.lightStatus=n.get1x(DataView.NO_SIGNED),t.lightBrightness=n.get1x(DataView.NO_SIGNED),t.colorId=n.get1x(DataView.NO_SIGNED),t.sleepAidStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidLightStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidMusicStatus=n.get1x(DataView.NO_SIGNED),t.sleepAidMusicID=n.get2x(DataView.NO_SIGNED),t.sleepAidLeftTime=n.get1x(DataView.NO_SIGNED),t.aromaStatus=n.get1x(DataView.NO_SIGNED)}return t}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"sa1001BleApi",function(){return o});var a=n(8),i=n(0);r.prototype=new a.BleCommon1;var o=new r;o.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=o.DEVICE_TYPE.DEVICE_TYPE_BLE_BRIGE,this.setMtuEnable=!1}function a(){r.call(this),this.deviceType=o.DEVICE_TYPE.BRIGE}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"brigeBleApi",function(){return s}),n.d(t,"bridge2BleApi",function(){return c});var i=n(16),o=n(0);r.prototype=new i.a,a.prototype=r.prototype;var s=new r,c=new a},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_GP300,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"gp300BleApi",function(){return s});var a=n(13),i=n(0),o=n(2);r.prototype=new a.a;var s=new r;s.setAlarm=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set1x(e.flag),n.set1x(e.startHour),n.set1x(e.startMinute),n.set2x(e.continue),e.content=n.buffer,this.sendMsgOperation(35,i.FRAME_TYPE.Request,e)},s.getAlarm=function(e){this.sendMsgOperation(36,i.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.flag=e.get1x(),t.startHour=e.get1x(),t.startMinute=e.get1x(),t.continue=e.get2x(),t})},s.setBirthDay=function(e){var t=new ArrayBuffer(4),n=new DataView(t);n.set2x(e.year),n.set1x(e.month),n.set1x(e.day),e.content=n.buffer,this.sendMsgOperation(38,i.FRAME_TYPE.Request,e)},s.getBirthDay=function(e){this.sendMsgOperation(39,i.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.year=e.get2x(),t.month=e.get1x(),t.day=e.get1x(),t})},s.setAlarmRemind=function(e){var t=new ArrayBuffer(6),n=new DataView(t);n.set1x(e.exceptionFlag),n.set1x(e.breathPauseFlag),n.set1x(e.breathOverSpeedFlag),n.set1x(e.breathTooSlowFlag),n.set1x(e.heartOverSpeedFlag),n.set1x(e.heartTooSlowFlag),e.content=n.buffer,this.sendMsgOperation(48,i.FRAME_TYPE.Request,e)},s.getAlarmRemind=function(e){this.sendMsgOperation(49,i.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.exceptionFlag=e.get1x(),t.breathPauseFlag=e.get1x(),t.breathOverSpeedFlag=e.get1x(),t.breathTooSlowFlag=e.get1x(),t.heartOverSpeedFlag=e.get1x(),t.heartTooSlowFlag=e.get1x(),t})},s.downloadSubHistoryData=function(e){var t=new Date(1e3*e.startime),n=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" 10:0:0",r=new Date(n).valueOf()/1e3,a={starttime:e.startTime||r,offset:e.offset,count:e.count,handler:e.handler};e.timeout&&(a.timeout=e.timeout),this.download24HistoryData(a)},s.downloadSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,a=function(r,a){if(r!==i.BLE_RET.status.timeout||t<=1)return void(n&&n(r,a));e.handler=n,s.downloadSubHistoryDataTryTimes(e,t-1)};e.handler=a,e.timeout=2e4,r.downloadSubHistoryData(e)},s.downloadSingleReport=function(e,t,n,r,a,s){var c=this,u=function(u,f){if(u!=i.BLE_RET.status.suc)return void(s&&s(u));for(var l=f.count,p=0;p<l;p++)a.hrAry.push(f.heartRate[p]),a.brAry.push(f.breathRate[p]),a.statusAry.push(f.status[p]),a.statusValueAry.push(f.statusValue[p]);if(o.log.i("count:"+r+" ,offset:"+n+" ,summaryData.count:"+e.count),r+n>=1440)return void(s&&s(u));n+=r,r+n>=1440&&(r=1440-n),c.downloadSingleReport(e,t,n,r,a,s)},f={offset:n,count:r,evDataEnable:t};f.startime=e.startime,f.handler=u,c.downloadSubHistoryDataTryTimes(f,1)},s.downloadReports=function(e,t,n,r,a){var o=e.length,s=this,c={hrAry:[],brAry:[],statusAry:[],statusValueAry:[]},u=function(u){return u!==i.BLE_RET.status.suc?void(a&&a(u)):(r&&r(n,c),++n>=o?void(a&&a(u)):void s.downloadReports(e,t,n,r,a))};this.downloadSingleReport(e[n],t,0,80,c,u)},s.downloadHistoryDataList=function(e){var t=this,n=function(n,r){if(n!=i.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var a=r.dataList;if(e.summaryHandle&&e.summaryHandle(a.length),0===a.length)return void e.completion(i.BLE_RET.status.suc,[]);var o=[],s=function(t,n){n.summary=a[t],e.everyReportHandle&&(e.everyReportHandle(t,a.length,n),o.push(n))},c=function(t){e.completion&&e.completion(t,o)};t.downloadReports(a,e.evDataEnable,0,s,c)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.querySummeryData(r)},s.querySummeryData=function(e){var t=new ArrayBuffer(9),n=new DataView(t),r=0;n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(9,i.FRAME_TYPE.Request,e,function(e){var t={};t.count=e.getUint16(13),t.dataList=new Array;for(var n=0;n<t.count;n++){var a={},i=e.getUint32(11*n+15),s=new Date(1e3*i),c=s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()+" 10:0:0";if(c!==r){r=c,a.startime=new Date(c).valueOf()/1e3,a.step=e.getUint16(11*n+15+4);var u=e.getUint32(11*n+15+4+2);a.count=1440!==u?1440:u,a.stopmode=e.getUint8(11*n+15+4+2+4),o.log.i("querySummeryData summery: "+JSON.stringify(a)),t.dataList.push(a)}else o.log.i("querySummeryData 时间相同 "+c)}return t})},s.download24HistoryData=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.starttime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsgOperation(12,i.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.heartRate=[],t.breathRate=[],t.status=[],t.statusValue=[],t.desc=[];for(var n=e.getUint8(22),r=0;r<n;r++)t.desc[r]=[],t.desc[r][0]=e.getUint8(23+2*r),t.desc[r][1]=e.getUint8(23+2*r+1);for(var a=0;a<t.count;a++)for(var i=0;i<n;i++)switch(t.desc[i][0]){case 0:t.breathRate[a]=e.getUint8(31+n*a+i);break;case 1:t.heartRate[a]=e.getUint8(31+n*a+i);break;case 2:t.status[a]=e.getUint8(31+n*a+i);break;case 3:t.statusValue[a]=e.getUint8(31+n*a+i)}return t})}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_SLEEPDOT_502T,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"b501tBleApi",function(){return o});var a=n(37),i=n(0);r.prototype=new a.B501BleApi;var o=new r},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_Z400TWP3,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.Z400TWP3BleApi=r,n.d(t,"z400twp3BleApi",function(){return f});var a=n(16),i=n(0),o=n(2),s=n(4),c=n(1),u=n(3);r.prototype=new a.a,r.prototype.getDeviceInfo=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=518,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(console.log("Z400TWP3BleApi","getDeviceInfo---",t,n),t==u.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),o=new DataView(i),f=0;f<14;f++)o.set1x(n.get1x());a.deviceName=c.default.ab2str(o.buffer.slice(0,13));for(var l=new DataView(i),p=0;p<14;p++)l.set1x(n.get1x());a.deviceId=c.default.ab2str(l.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x();var d=a.currentHardVersion;a.currVersion=Object(s.padStart)(parseInt(d/100),1,0)+"."+Object(s.padStart)(parseInt(d%100));var g=a.factoryHardVersion;a.facVersion=Object(s.padStart)(parseInt(g/100),1,0)+"."+Object(s.padStart)(parseInt(g%100)),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(),a.busineesCooperationNumber=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){o.log.e("Z400TWP3BleApi","getDeviceInfo",e)}};var f=new r;f.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_M871W,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"m871wBleApi",function(){return c});var a=n(25),i=n(0),o=n(1),s=n(3);n(4);r.prototype=new a.M800BleApi,r.prototype.querySensorState=function(e){e.frameType=i.FRAME_TYPE.Request,e.msgType=1187,e.deviceType=e.deviceType||i.DEVICE_TYPE.DEVICE_TYPE_M871W,e.subVersion=0;for(var t=new DataView(new ArrayBuffer(17)),n=o.default.str2ab(e.deviceId),r=new DataView(n),a=0;a<14;a++)a<n.byteLength?t.set1x(r.get1x()):t.set1x(0);t.set2x(e.deviceType),t.set1x(e.num),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x(),a.num=n.get1x(),a.connectState=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})};var c=new r},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_BM8701_2,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"bm8701_2BleApi",function(){return o});var a=n(39),i=n(0);n(1),n(3),n(4);r.prototype=new a.BM8701BleApi;var o=new r},function(e,t,n){"use strict";function r(){this.deviceType=s.DEVICE_TYPE.DEVICE_TYPE_NOX_2B,this.setMtuEnable=!1}function a(e,t){var n=e.get1x(1),r=void 0;switch(n){case 0:case 1:r=e.get2x(1);break;case 3:r=e.get4x(1);break;case 2:case 6:case 7:t.albumId=e.get4x(1),r=e.get4x(1),t.currentIndex=e.get2x(1),t.playMode=e.get1x(1)}t.cycle=e.get1x(1),t.musicType=n,t.musicId=r}function i(e,t,n){switch(e){case 2:n.fluxaySeqid=t.get1x(1);break;case 0:case 1:n.r=t.get1x(1),n.g=t.get1x(1),n.b=t.get1x(1),n.w=t.get1x(1)}}Object.defineProperty(t,"__esModule",{value:!0}),t.SN902BApi=r,n.d(t,"sn902bBleApi",function(){return c});var o=n(8),s=(n(1),n(0));n(3),n(5),n(2);r.prototype=new o.BleCommon1;var c=new r;c.initBle(void 0,!1,function(){}),c.albumConfig=function(e){var t=new DataView(new ArrayBuffer(8+4*e.voiceNumber));t.set1x(1),t.set1x(e.type),t.set4x(e.albumId),t.set2x(e.voiceNumber);for(var n=0;n<e.musicList.length;n++){var r=e.musicList[n].musicId;t.set4x(r)}e.content=t.buffer,this.sendMsgOperation(39,s.FRAME_TYPE.Request,e)},c.setGestureConfig=function(e){var t=new DataView(new ArrayBuffer(3));t.set1x(1),t.set1x(e.operation),t.set1x(e.size),e.content=t.buffer.append(e.endData),this.sendMsgOperation(36,s.FRAME_TYPE.Request,e)},c.gestureContentData=function(e){var t=new DataView(new ArrayBuffer(4));return t.set1x(e.gestureOperation),t.set1x(e.number),t.set2x(e.value),t.buffer},c.sceneOperation=function(e){var t=this.musicData(e),n=new DataView(new ArrayBuffer(9));n.set1x(e.operation),n.set8x(e.sceneNumber);var r=n.buffer.append(t),a=new DataView(new ArrayBuffer(2));a.set1x(e.lightSwitch),a.set1x(e.musicSwitch),e.content=r.append(a.buffer),this.sendMsgOperation(50,s.FRAME_TYPE.Request,e)},c.alarmContentData=function(e){var t=this.musicData(e),n=new DataView(new ArrayBuffer(19));n.set8x(e.alarmId),n.set1x(e.alarmFlag),n.set1x(e.smartFlag),n.set1x(e.smartOffset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.week),n.set1x(e.lazyCount),n.set1x(e.lazyTime),n.set1x(e.volume),n.set1x(e.brightness),n.set1x(e.oscillatorFlag);var r=n.buffer.append(t),a=new DataView(new ArrayBuffer(4));return a.set4x(e.timestamp),e.content=r.append(a.buffer),e},c.colockConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.number);for(var n=t.buffer,r=0;r<e.alarmListData.length;r++){var a=e.alarmListData[r];n=n.append(a.content)}e.content=n,this.sendMsgOperation(35,s.FRAME_TYPE.Request,e)},c.musicData=function(e){var t;switch(e.musicType){case s.MUSIC_TYPE.LOCAL:case s.MUSIC_TYPE.OUTSITE:t=new DataView(new ArrayBuffer(4)),t.set1x(e.musicType),t.set2x(e.musicId),t.set1x(e.cycle);break;case s.MUSIC_TYPE.XMLY_SIGLE:t=new DataView(new ArrayBuffer(6)),t.set1x(e.musicType),t.set4x(e.musicId),t.set1x(e.cycle);case s.MUSIC_TYPE.XMLY_ALBUM:case s.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case s.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t=new DataView(new ArrayBuffer(13)),t.set1x(e.musicType),t.set4x(e.albumId),t.set4x(e.musicId),t.set2x(e.currentIndex),t.set1x(e.playMode),t.set1x(e.cycle)}return t.buffer},c.clockOperation=function(e){var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set8x(e.alarmSeqid),e.content=e.endData.byteLength>0?t.buffer.append(e.endData):t.buffer,this.sendMsgOperation(52,s.FRAME_TYPE.Request,e)},c.alarmData=function(e,t){var n,r=new ArrayBuffer(0);switch(e){case 3:n=new DataView(new ArrayBuffer(5)),n.set1x(t.volume),n.set1x(t.brightness),n.set1x(t.musicType),n.set2x(t.musicId),r=n.buffer}return r},c.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=8:n.position=9,e.msgType){case 65:t.mode=n.get1x(1),t.sceneNumbers=n.get1x(1),t.sceneNumbers>0&&(t.sceneId=n.get8x(1),t.sceneType=n.get1x(1)),t.sleepAssistStatus=n.get1x(1),t.sleepAssistLeftTime=n.get1x(1),t.alarmStatus=n.get1x(1),t.alarmId=n.get8x(1),t.lightStatus=n.get1x(1),t.lightBrightness=n.get1x(1),t.lightMode=n.get1x(1),i(t.lightMode,n,t),t.musicStatus=n.get1x(1),t.volume=n.get1x(1),a(n,t)}return t},c.lightConfig=function(e){var t=new DataView(new ArrayBuffer(11));t.set1x(1),t.set1x(e.nightLightFlag),t.set1x(e.lightness),t.set1x(e.r),t.set1x(e.g),t.set1x(e.b),t.set1x(e.w),t.set1x(e.startHour),t.set1x(e.startMin),t.set2x(e.duration),e.content=t.buffer,this.sendMsgOperation(38,s.FRAME_TYPE.Request,e)},c.sleepAssistModel=function(e){var t=e.lightSwitch,n=e.musicSwitch,r=0;n&&(r|=1),t&&(r|=2);var a=new DataView(new ArrayBuffer(10));a.set1x(e.sleepSwitch),a.set1x(r),a.set1x(e.volume),a.set1x(e.brightness),a.set1x(e.r),a.set1x(e.g),a.set1x(e.b),a.set1x(e.w),a.set1x(e.smartStop),a.set1x(e.aidingTime);var i={};return i.contentData=a.buffer,i}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_SN913E,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"sn913eBleApi",function(){return c});var a=n(64),i=n(0),o=n(1),s=n(3);n(4);r.prototype=new a.a,r.prototype.querySensorState=function(e){e.frameType=i.FRAME_TYPE.Request,e.msgType=1187,e.deviceType=e.deviceType||i.DEVICE_TYPE.DEVICE_TYPE_SN913E,e.subVersion=0;for(var t=new DataView(new ArrayBuffer(17)),n=o.default.str2ab(e.deviceId),r=new DataView(n),a=0;a<14;a++)a<n.byteLength?t.set1x(r.get1x()):t.set1x(0);t.set2x(e.deviceType),t.set1x(e.num),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.deviceType=n.get2x(),a.num=n.get1x(),a.connectState=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})};var c=new r},function(e,t,n){"use strict";function r(){this.conf=l}t.a=r;var a=n(11),i=n(7),o=n(1),s=n(3),c=n(2),u=n(4),f="bleCommonApi3",l=a.MedicaBle.getBleDefaultConfig();l.protocol=new i.MedicaProtocol3,r.prototype=new a.MedicaBle,r.prototype.TCP_Consts=s.a,r.prototype.getDeviceInfo=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=518,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),f=0;f<14;f++)c.set1x(n.get1x());a.deviceName=o.default.ab2str(c.buffer.slice(0,13));for(var l=new DataView(i),p=0;p<14;p++)l.set1x(n.get1x());a.deviceId=o.default.ab2str(l.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x();var d=a.currentHardVersion;a.currVersion=Object(u.padStart)(parseInt(d/100),1,0)+"."+Object(u.padStart)(parseInt(d%100));var g=a.factoryHardVersion;a.facVersion=Object(u.padStart)(parseInt(g/100),1,0)+"."+Object(u.padStart)(parseInt(g%100)),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(),a.busineesCooperationNumber=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.getWifiStatus=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5152,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.getWifiConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5121,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(33),c=new DataView(i),u=0,f=0;f<33;f++){var l=n.get1x();0==l&&0==u&&(u=f),c.set1x(l)}a.ssid=o.default.ab2str(c.buffer.slice(0,u)),a.encrypType=n.get1x();var p=new ArrayBuffer(65),d=new DataView(p);u=0;for(var g=0;g<65;g++){var h=n.get1x();0==h&&0==u&&(u=g),d.set1x(h)}a.password=o.default.ab2str(d.buffer.slice(0,u)),a.ipType=n.get1x(),a.staticIp=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.subnetMask=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.gateWay=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns1=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns2=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.wifiConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5120,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(120),n=new DataView(t),r=null;if(e.ssidRaw){var a=null;a=e.ssidRaw.constructor==Array?e.ssidRaw:JSON.parse(e.ssidRaw),r=o.default.arr2Buffer(a)}else r=o.default.str2ab(e.ssid);for(var i=new DataView(r),u=0;u<33;u++)u<r.byteLength?n.set1x(i.get1x()):n.set1x(0);n.set1x(1);for(var l=o.default.str2ab(e.password),p=new DataView(l),d=0;d<65;d++)d<l.byteLength?n.set1x(p.get1x()):n.set1x(0);n.set1x(0);for(var g=0;g<20;g++)n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"wifiConfig",e)}},r.prototype.serverConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5122,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;for(var t=new ArrayBuffer(162),n=new DataView(t),r=o.default.str2ab(e.ip),a=new DataView(r),i=0;i<32;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.port);for(var u=o.default.str2ab(e.http||""),l=new DataView(u),p=0;p<128;p++)p<u.byteLength?n.set1x(l.get1x()):n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"serverConfig",e)}},r.prototype.getServerConfig=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5123,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){for(var a={},i=new ArrayBuffer(32),c=new DataView(i),u=0,f=0;f<32;f++){var l=n.get1x();0==l&&0==u&&(u=f),c.set1x(l)}a.ip=o.default.ab2str(c.buffer.slice(0,u)),a.port=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"getServerConfig",e)}},r.prototype.getWifiMac=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=5124,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"getServerConfig",e)}},r.prototype.registerPostMsgHanlder(function(e){}),r.prototype.loginByUser=function(e){try{e.frameType=s.a.FrameType.Request,e.msgType=512,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.connectType||0),n.set4x(e.userId),n.setStr(e.password),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==s.a.RET.Succeed){var a=n.get4x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.log.e(f,"loginByUser",e)}},r.prototype.checkTime=function(e){e.handler(0,{})},r.prototype.sendUpdateSummery=function(e){try{e.frameType=s.a.FrameType.POST,e.msgType=1284,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(17),n=new DataView(t);n.set2x(e.devType||e.deviceType),n.set1x(e.hardType),n.set2x(e.hardVersion),n.set4x(e.length),n.set4x(e.encryCrc),n.set4x(e.originCrc),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"sendUpdateSummery",e)}},r.prototype.sendUpdateDetail=function(e){try{e.frameType=s.a.FrameType.POST,e.msgType=1285,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(6+e.bufferArr.length),n=new DataView(t);n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set1x(e.bufferArr[r]);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){s.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.e(f,"sendUpdateDetail",e)}},r.prototype.sendMsg=function(e,t,n){c.log.i(f,"sendMsg-start",e,o.default.buffer2Arr(t),this);try{this.sendPacket({frameType:e.frameType,deviceType:e.deviceType||this.deviceType,msgType:e.msgType,content:t,subVersion:e.subVersion||0,timeout:e.timeout,handler:function(e,t,r){if(e===s.a.RET.Succeed&&t&&t.byteLength>0){var a=new DataView(t),i=a.get2x();0===i?n(s.a.RET.Succeed,a,r):n(i,a,r)}else n(s.a.RET.Timeout,void 0)}})}catch(e){c.log.e(f,"sendMsg",e)}}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_EW202W,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ew202wApi",function(){return l});var a=n(16),i=n(0),o=n(1),s=n(4),c=n(19),u=n(3),f="Ew202wApi";r.prototype=new a.a,r.prototype.getDeviceInfo=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=518,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(console.log(f,"getDeviceInfo---",t,n),t==u.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),c=new DataView(i),l=0;l<14;l++)c.set1x(n.get1x());a.deviceName=o.default.ab2str(c.buffer.slice(0,13));for(var p=new DataView(i),d=0;d<14;d++)p.set1x(n.get1x());a.deviceId=o.default.ab2str(p.buffer.slice(0,13)),a.deviceType=n.get2x(),a.currentHardVersion=n.get2x(),a.factoryHardVersion=n.get2x();var g=a.currentHardVersion;a.currVersion=Object(s.padStart)(parseInt(g/100),1,0)+"."+Object(s.padStart)(parseInt(g%100));var h=a.factoryHardVersion;a.facVersion=Object(s.padStart)(parseInt(h/100),1,0)+"."+Object(s.padStart)(parseInt(h%100)),a.factoryTimestamp=n.get4x(),a.factoryNumber=n.get2x(),a.busineesCooperationNumber=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"getDeviceInfo",e)}},r.prototype.getWifiStatus=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=5381,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==u.a.RET.Succeed){var a=n.get1x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"loginByUser",e)}},r.prototype.getWifiConfig=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=5377,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==u.a.RET.Succeed){for(var a={},i=new ArrayBuffer(33),s=new DataView(i),c=0,f=0;f<33;f++){var l=n.get1x();0==l&&0==c&&(c=f),s.set1x(l)}a.ssid=o.default.ab2str(s.buffer.slice(0,c)),a.encrypType=n.get1x();var p=new ArrayBuffer(65),d=new DataView(p);c=0;for(var g=0;g<65;g++){var h=n.get1x();0==h&&0==c&&(c=g),d.set1x(h)}a.password=o.default.ab2str(d.buffer.slice(0,c)),a.ipType=n.get1x(),a.staticIp=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.subnetMask=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.gateWay=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns1=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),a.dns2=n.get1x()+"."+n.get1x()+"."+n.get1x()+"."+n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"loginByUser",e)}},r.prototype.wifiConfig=function(e){console.log(f,"wifiConfig---",e);try{e.frameType=u.a.FrameType.Request,e.msgType=5376,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(120),n=new DataView(t),r=null;if(e.ssidRaw){var a=null;a=e.ssidRaw.constructor==Array?e.ssidRaw:JSON.parse(e.ssidRaw),r=o.default.arr2Buffer(a)}else r=o.default.str2ab(e.ssid);for(var i=new DataView(r),s=0;s<33;s++)s<r.byteLength?n.set1x(i.get1x()):n.set1x(0);n.set1x(1);for(var l=o.default.str2ab(e.password),p=new DataView(l),d=0;d<65;d++)d<l.byteLength?n.set1x(p.get1x()):n.set1x(0);n.set1x(0);for(var g=0;g<20;g++)n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){u.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.a.e(f,"wifiConfig",e)}},r.prototype.serverConfig=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=5378,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;for(var t=new ArrayBuffer(162),n=new DataView(t),r=o.default.str2ab(e.ip),a=new DataView(r),i=0;i<32;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.port),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){u.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.a.e(f,"serverConfig",e)}},r.prototype.getServerConfig=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=5379,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==u.a.RET.Succeed){for(var a={},i=new ArrayBuffer(32),s=new DataView(i),c=0,f=0;f<32;f++){var l=n.get1x();0==l&&0==c&&(c=f),s.set1x(l)}a.ip=o.default.ab2str(s.buffer.slice(0,c)),a.port=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"getServerConfig",e)}},r.prototype.getWifiMac=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=5380,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==u.a.RET.Succeed){var a=n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED)+"."+n.get1x(DataView.NO_SIGNED);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"getServerConfig",e)}},r.prototype.registerPostMsgHanlder(function(e){}),r.prototype.loginByUser=function(e){try{e.frameType=u.a.FrameType.Request,e.msgType=512,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.connectType||0),n.set4x(e.userId),n.setStr(e.password),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==u.a.RET.Succeed){var a=n.get4x();e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){c.a.e(f,"loginByUser",e)}},r.prototype.checkTime=function(e){e.handler(0,{})},r.prototype.sendUpdateSummery=function(e){try{e.frameType=u.a.FrameType.POST,e.msgType=1284,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(17),n=new DataView(t);n.set2x(e.devType||e.deviceType),n.set1x(e.hardType),n.set2x(e.hardVersion),n.set4x(e.length),n.set4x(e.encryCrc),n.set4x(e.originCrc),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){u.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.a.e(f,"sendUpdateSummery",e)}},r.prototype.sendUpdateDetail=function(e){try{e.frameType=u.a.FrameType.POST,e.msgType=1285,e.deviceType=e.deviceType||this.deviceType,e.subVersion=0;var t=new ArrayBuffer(6+e.bufferArr.length),n=new DataView(t);n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set1x(e.bufferArr[r]);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){u.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.a.e(f,"sendUpdateDetail",e)}};var l=new r;l.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_EB100,this.mtu=120,this.maxMtu=503,this.defaultMtu=120,this.setMtuEnable=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.BlanketBleApi=r,n.d(t,"blanketBleApi",function(){return s});var a=n(13),i=n(0),o=n(1);n(2),n(4);r.prototype=new a.a,r.prototype.operateBlanket=function(e){var t=new ArrayBuffer(4),n=new DataView(t);n.set1x(e.powerSwitch),n.set1x(e.leftTemp),n.set1x(e.rightTemp),n.set1x(e.time),e.content=n.buffer,this.sendMsgOperation(64,i.FRAME_TYPE.Request,e)},r.prototype.getBlanketStatus=function(e){this.sendMsgOperation(65,i.FRAME_TYPE.Request,e,function(e){e.position=12;var t={};return t.powerSwitch=e.get1x(1),t.leftTemp=e.get1x(1),t.rightTemp=e.get1x(1),t.time=e.get1x(1),t})},r.prototype.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=11:n.position=12,e.msgType){case 65:t.powerSwitch=n.get1x(1),t.leftTemp=n.get1x(1),t.rightTemp=n.get1x(1),t.time=n.get1x(1)}return t},r.prototype.getDeviceInfo=function(e){e.content=new ArrayBuffer(0),this.sendMsgOperation(27,i.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});return t.deviceName=o.default.buf2string(e.buffer.slice(12,25)),t.deviceId=o.default.buf2string(e.buffer.slice(26,39)),t.deviceType=e.getUint16(40),t.softVersion=(e.getUint16(42)/100).toFixed(2),t.producedVersion=e.getUint16(44),t.producedDate=e.getUint32(46),t.producedFirm=e.getUint16(50),t.cooperationFirm=e.getUint16(52),t.pcbVersion=e.getUint16(54),console.log("获取设备信息",t),t})};var s=new r;s.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_P401M,this.mtu=480,this.maxMtu=503,this.defaultMtu=480,this.setMtuEnable=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.P401MBleApi=r,n.d(t,"p401mBleApi",function(){return o});var a=n(17),i=n(0);r.prototype=new a.ZP100BleApi;var o=new r;o.initBle(void 0,!1,function(){}),o.registerPostMsgHanlder(function(e){o.parsePost(e)}),r.prototype.setBuff=function(e){var t=new ArrayBuffer(3),n=new DataView(t);n.set1x(e.originFlag),n.set1x(e.top),n.set1x(e.floor),e.content=n.buffer,this.sendMsgOperation(39,i.FRAME_TYPE.Request,e)},r.prototype.getBuff=function(e){this.sendMsgOperation(40,i.FRAME_TYPE.Request,e,function(e){var t={};return t.originFlag=e.getUint8(12),t.top=e.getUint8(13),t.floor=e.getUint8(14),t})},r.prototype.getMusicVer=function(e){this.sendMsgOperation(82,i.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.musicVer=e.get2x(),t})},r.prototype.setLeftbedNums=function(e){var t=new ArrayBuffer(21),n=new DataView(t);n.set1x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set2x(e.bufferArr[r]);e.content=n.buffer,this.sendMsgOperation(80,i.FRAME_TYPE.Request,e)},r.prototype.getLeftbedNums=function(e){this.sendMsgOperation(81,i.FRAME_TYPE.Request,e,function(e){var t={};e.position=12,t.length=e.get1x();for(var n=[],r=13;r<23;r++)n.push(e.get2x());return t.bufferArr=n,t})},r.prototype.getAlarmConfig=function(e){var t=new ArrayBuffer(1),n=new DataView(t);n.set1x(255),e.content=n.buffer,this.sendMsgOperation(64,i.FRAME_TYPE.Request,e,function(e){e.position=12;for(var t=e.get1x(),n=[],r=0;r<t;r++){var a={id:e.get1x(1),enable:e.get1x(1),smartOpen:e.get1x(1),smartOffset:e.get1x(1),hour:e.get1x(1),minute:e.get1x(1),repeat:e.get1x(1),snoozeCount:e.get1x(1),snoozeLength:e.get1x(1),volume:e.get1x(1),brightness:e.get1x(1),musicId:e.get2x(1),timestamp:e.get4x(1),invalid:e.get1x(1)};1==a.invalid&&n.push(a)}return n})},r.prototype.setAlarmConfig=function(e){var t=new ArrayBuffer(18),n=new DataView(t);n.set1x(e.id),n.set1x(e.enable),n.set1x(e.smartOpen),n.set1x(e.smartOffset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.repeat),n.set1x(e.snoozeCount),n.set1x(e.snoozeLength),n.set1x(e.volume),n.set1x(e.brightness),n.set2x(e.musicId),n.set4x(e.timestamp),n.set1x(e.invalid),e.content=n.buffer,this.sendMsgOperation(57,i.FRAME_TYPE.Request,e)},r.prototype.alarmMusicPreview=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(e.operation),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(65,i.FRAME_TYPE.Request,e)},r.prototype.alarmPreviewOperation=function(e){var t=new DataView(new ArrayBuffer(5));t.set1x(e.operation),t.set1x(e.brightness),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsgOperation(50,i.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=8;var n={};return n.code=t.get1x(1),n})},r.prototype.sleepAidOperation=function(e){var t=new DataView(new ArrayBuffer(14));t.set1x(e.musicSwitch),t.set2x(e.musicId),t.set1x(e.volume),t.set1x(e.loop),t.set1x(0),t.set1x(0),t.set1x(0),t.set1x(0),t.set1x(0),t.set1x(0),t.set1x(e.smartSleepAid),t.set2x(e.sleepAidStopDuration),e.content=t.buffer,this.sendMsgOperation(55,i.FRAME_TYPE.Request,e)},r.prototype.getSleepAidOperation=function(e){var t=new DataView(new ArrayBuffer(0));e.content=t.buffer,this.sendMsgOperation(56,i.FRAME_TYPE.Request,e,function(e){e.position=12;var t={};return t.musicSwitch=e.get1x(1),t.musicId=e.get2x(1),t.volume=e.get1x(1),t.loop=e.get1x(1),t.lightSwitch=e.get1x(1),t.brightness=e.get1x(1),t.r=e.get1x(1),t.g=e.get1x(1),t.b=e.get1x(1),t.w=e.get1x(1),t.smartSleepAid=e.get1x(1),t.sleepAidStopDuration=e.get2x(1),t})},r.prototype.smartStopPlay=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(e.operation),e.content=t.buffer,this.sendMsgOperation(66,i.FRAME_TYPE.Request,e)},r.prototype.getSmartStopPlay=function(e){var t=new DataView(new ArrayBuffer(0));e.content=t.buffer,this.sendMsgOperation(67,i.FRAME_TYPE.Request,e,function(e){e.position=12;var t={};return t.operation=e.get1x(1),t})},r.prototype.getWorkMode=function(e){var t=new DataView(new ArrayBuffer(0));e.content=t.buffer,this.sendMsgOperation(68,i.FRAME_TYPE.Request,e,function(e){e.position=12;var t={};return t.alarmStatus=e.get1x(1),t.sleepAidStatus=e.get1x(1),t.sleepAidMusictStatus=e.get1x(1),t.sleepAidVolume=e.get1x(1),t.sleepAidMusicId=e.get2x(1),t.sleepAidLeave=e.get1x(1),t.loop=e.get1x(1),t.blePin=e.get1x(1),t.bleStatus=e.get1x(1),t.bleVolume=e.get1x(1),t.musicDuration=e.get4x(1),t.musicProgress=e.get4x(1),t})},r.prototype.leavePillowAlarmConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(e.status),t.set1x(e.operation),e.content=t.buffer,this.sendMsgOperation(69,i.FRAME_TYPE.Request,e)},r.prototype.getLeavePillowAlarmConfig=function(e){var t=new DataView(new ArrayBuffer(0));e.content=t.buffer,this.sendMsgOperation(70,i.FRAME_TYPE.Request,e,function(e){e.position=12;var t={};return t.status=e.get1x(1),t.operation=e.get1x(1),t})}},function(e,t,n){"use strict";function r(){this.deviceType=a.DEVICE_TYPE.PHP100,this.setMtuEnable=!0,this.maxMtu=247}Object.defineProperty(t,"__esModule",{value:!0}),t.Php100BleApi=r,n.d(t,"php100BleApi",function(){return o});var a=n(0),i=n(17);r.prototype=new i.ZP100BleApi;var o=new r;o.registerPostMsgHanlder(function(e){o.parsePost(e)}),o.initBle(void 0,!1,function(){}),r.prototype.discoverServicesIfNeed=function(e,t){this.connectServerAndCharacteristic(e,t)}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_P102T,this.mtu=120,this.maxMtu=120,this.defaultMtu=120,this.setMtuEnable=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.P102TBleApi=r,n.d(t,"p102tBleApi",function(){return o});var a=n(17),i=n(0);n(1),n(2),n(4);r.prototype=new a.ZP100BleApi,r.prototype.setBuff=function(e){var t=new ArrayBuffer(3),n=new DataView(t);n.set1x(e.originFlag),n.set1x(e.top),n.set1x(e.floor),e.content=n.buffer,this.sendMsgOperation(39,i.FRAME_TYPE.Request,e)},r.prototype.getBuff=function(e){this.sendMsgOperation(40,i.FRAME_TYPE.Request,e,function(e){var t={};return t.originFlag=e.getUint8(12),t.top=e.getUint8(13),t.floor=e.getUint8(14),t})},r.prototype.setLeftbedNums=function(e){var t=new ArrayBuffer(21),n=new DataView(t);n.set1x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set2x(e.bufferArr[r]);e.content=n.buffer,this.sendMsgOperation(80,i.FRAME_TYPE.Request,e)},r.prototype.getLeftbedNums=function(e){this.sendMsgOperation(81,i.FRAME_TYPE.Request,e,function(e){var t={};e.position=12,t.length=e.get1x();for(var n=[],r=13;r<23;r++)n.push(e.get2x());return t.bufferArr=n,t})},r.prototype.getSensorStatus=function(e){this.sendMsgOperation(82,i.FRAME_TYPE.Request,e,function(e){var t={};return e.position=12,t.status=e.get1x(),t.time=e.get4x(1),t})};var o=new r;o.registerPostMsgHanlder(function(e){o.parsePost(e)}),o.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(p[t]){var n=p[t];return n.socketClient=e,n}p[t]=this,this.socketClient=e,this.protocol=new c.b,this.socketClient.setProtocol(this.protocol);l&&clearInterval(l),this.keepAlive()}Object.defineProperty(t,"__esModule",{value:!0}),t.MedicaCommonWAN=r;var a=n(2),i=n(3),o=n(1),s=n(0),c=n(10),u=n(18),f="MedicaCommonWAN",l=void 0,p={};r.prototype.loginByUser=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=512,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.connectType||0),n.set4x(e.userId),n.setStr(e.password),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==i.a.RET.Succeed){var a=n.get4x();e.handler&&e.handler(t,a,r)}else e.handler&&e.handler(t)})}catch(e){a.log.i(f,"loginByUser",e)}},r.prototype.loginByToken=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=517,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(1024),n=new DataView(t);n.set1x(e.connectType||0),n.setStr(e.token),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==i.a.RET.Succeed){var a=n.get4x();e.handler&&e.handler(t,a,r)}else e.handler&&e.handler(t)})}catch(e){a.log.i(f,"loginByToken",e)}},r.prototype._keepAlive=function(){var e=this;try{var t={};t.frameType=i.a.FrameType.POST,t.msgType=0,t.deviceType=27,t.subVersion=0,t.timeout=2e3,a.log.i(f,"_keepAlive-start",t),this.sendMsg(t,new ArrayBuffer(0),function(t,n,r){a.log.i(f,"_keepAlive-callback",t,r),e.handleKeepAliveResp(t===i.a.RET.Timeout)})}catch(e){a.log.i(f,"_keepAlive",e)}},r.prototype.handleKeepAliveResp=function(e){a.log.i(f,"handleKeepAliveResp-start",e),e?this.keepAliveFailedTimes+=1:(this.keepAliveFailedTimes=0,this.socketClient.keepAliveTime=(new Date).getTime())},r.prototype.keepAlive=function(){var e=this;l=setInterval(function(){for(var t=u.pool.keySet(),n=0;n<t.length;n++){var r=u.pool.get(t[n]);if(r&&e.protocol.protocolConfig.keepAlive&&r.CONNECTTION_STATUS){var i=(new Date).getTime()-r.keepAliveTime;i>e.protocol.protocolConfig.reconnectInterval?(u.invoker.invoke(o.default.buildKey(u.SOCKET_LISTENER_KEY.socketState,r.ip,r.port),!1),r.CONNECTTION_STATUS=!1):i>e.protocol.protocolConfig.keepAliveInterval&&(a.log.i(f,"_keepAlive",i,e.protocol.protocolConfig.keepAliveInterval),e.protocol.protocolConfig.keepAlive&&e._keepAlive())}}},1e3)},r.prototype.sendMsg=function(e,t,n){a.log.i(f,"sendMsg-start",e,o.default.buffer2Arr(t),this);try{this.socketClient.sendPacket({frameType:e.frameType,deviceType:e.deviceType,msgType:e.msgType,content:t,subVersion:e.subVersion,timeout:e.timeout||i.a.timeout,networkDeviceId:e.networkDeviceId,handler:function(t,r,o){if(a.log.i(f,"tcp back ----",t,r,o,e),t===i.a.RET.Succeed&&r&&r.byteLength>0){var s=new DataView(r),c=s.get2x();a.log.i(f,"sendPacket_status",c,"msgType:",e.msgType),0===c?n(i.a.RET.Succeed,s,o):n(c,s,o)}else a.log.i(f,"sendPacket_status","msgType:",e.msgType),n(i.a.RET.Timeout,void 0)}})}catch(e){a.log.e(f,"sendMsg",e)}}},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(p[t]){var n=p[t];return n.socketClient=e,n}p[t]=this,this.socketClient=e,this.protocol=new c.a,this.socketClient.setProtocol(this.protocol);l&&clearInterval(l),this.keepAlive()}Object.defineProperty(t,"__esModule",{value:!0}),t.MedicaCommonLAN=r;var a=n(2),i=n(3),o=n(1),s=n(0),c=n(10),u=n(18),f="MedicaCommonLAN",l=void 0,p={};r.prototype.loginByUser=function(e){try{a.log.i(f,"loginByUser",e),e.frameType=i.a.FrameType.Request,e.msgType=32,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=0;var t=new DataView(new ArrayBuffer(6));t.set1x(s.OPERATION_TYPE.SET),t.set4x(e.userId),t.set1x(e.language),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){t===i.a.RET.Succeed?e.handler(t):e.handler(t,{})})}catch(e){a.log.i(f,"loginByUser",e)}},r.prototype._keepAlive=function(){var e=this;try{var t={};t.frameType=i.a.FrameType.POST,t.msgType=0,t.deviceType=2,t.subVersion=0,t.timeout=2e3,a.log.i(f,"_keepAlive-start",t),this.sendMsg(t,new ArrayBuffer(0),function(t,n,r){a.log.i(f,"_keepAlive-callback",t,r),e.handleKeepAliveResp(t===i.a.RET.Timeout)})}catch(e){a.log.i(f,"_keepAlive",e)}},r.prototype.handleKeepAliveResp=function(e){a.log.i(f,"handleKeepAliveResp-start",e),e?this.keepAliveFailedTimes+=1:(this.keepAliveFailedTimes=0,this.socketClient.keepAliveTime=(new Date).getTime())},r.prototype.keepAlive=function(){var e=this;l=setInterval(function(){for(var t=u.pool.keySet(),n=0;n<t.length;n++){var r=u.pool.get(t[n]);if(r&&e.protocol.protocolConfig.keepAlive&&r.CONNECTTION_STATUS){var i=(new Date).getTime()-r.keepAliveTime;i>e.protocol.protocolConfig.reconnectInterval?(u.invoker.invoke(o.default.buildKey(u.SOCKET_LISTENER_KEY.socketState,r.ip,r.port),!1),r.CONNECTTION_STATUS=!1):i>e.protocol.protocolConfig.keepAliveInterval&&(a.log.i(f,"_keepAlive",i,e.protocol.protocolConfig.keepAliveInterval),e.protocol.protocolConfig.keepAlive&&e._keepAlive())}}},1e3)},r.prototype.sendMsg=function(e,t,n){a.log.i(f,"sendMsg-start",e,o.default.buffer2Arr(t),this);try{this.socketClient.sendPacket({frameType:e.frameType,deviceType:e.deviceType,msgType:e.msgType,content:t,timeout:e.timeout,handler:function(e,t,r){if(e===i.a.RET.Succeed&&t&&t.byteLength>0){var a=new DataView(t);a.get1x();0===a.get1x()?n(i.a.RET.Succeed,a,r):n(i.a.RET.Failed,a,r)}else n(i.a.RET.Timeout,void 0)}})}catch(e){a.log.e(f,"sendMsg",e)}}},function(e,t,n){"use strict";function r(e,t){var n=e.split(":");this.conf={ip:n[0]||"",port:n[1]||""},this.url=e,this.key=e;var r=c.pool.get(this.key);if(r)return r;this.keepAliveTime=(new Date).getTime(),this.CONNECTTION_STATUS=!1,this.pushInstance=function(){c.pool.put(this.key,this)},this.open=function(n,r){if(!r&&this.CONNECTTION_STATUS)return this.websocket.onopen(),null;this.CONNECTTION_STATUS&&this.close(),this.pushInstance(),this.websocket=new WebSocket(e),(void 0==t||t)&&(this.websocket.binaryType="arraybuffer"),o.log.i(l,"open",e),this.registerMessageListner()},this.setProtocol=function(e){this.protocol=e},this.close=function(e){o.log.i(l,"closeSocket-start"),this.websocket.close()},this.sendPacket=function(e){try{if(o.log.i(l,"sendPacket-start",e,this.url,this.CONNECTTION_STATUS),!this.CONNECTTION_STATUS)return void(e.handler&&e.handler(s.a.RET.Socket_Disconnect));this.keepAliveTime=(new Date).getTime();var t=this.protocol.buildMsg(e);o.log.i(l,"sendPacket-msg",t.key,i.default.buffer2Arr(t.buffer)),f.init(i.default.buildKey(this.url,t.key),{timeout:e.timeout,handler:e.handler}),this.websocket.send(t.buffer)}catch(e){o.log.e(l,"sendPacket",e)}},this.isConnected=function(){return this.CONNECTTION_STATUS},this.responseACK=function(e){if(this.autoRespACK){var t=this.protocol.buildACK(e);this.tcpNative.sendSocketMessage(this.ip,this.port,t.buffer,function(){o.log.i(l,"responseACK-callback",arguments)})}},this.onPostMsg=function(e,t){o.log.i(l,"onPostMsg-start",e);var n=i.default.buildKey(this.url,e,0);return o.log.i(l,"onPostMsg-start",n),u.init(n,{ignoreTimeout:!0,handler:t})},this.removePostMsgListener=function(e,t){u.clearSingle(i.default.buildKey(this.url,e,0),t)},this.onOpen=function(e){var t=this;return this.keepAliveTime=(new Date).getTime(),this.websocket.onopen=function(){t.CONNECTTION_STATUS=!0,o.log.i("websocket CONNECTTION_STATUS: "+t.CONNECTTION_STATUS),e()}},this.onError=function(e){var t=this;return this.websocket.onerror=function(){t.CONNECTTION_STATUS=!1,o.log.i("websocket CONNECTTION_STATUS: "+t.CONNECTTION_STATUS),e()}},this.onClose=function(e){var t=this;return this.websocket.onclose=function(){t.CONNECTTION_STATUS=!1,o.log.i("websocket CONNECTTION_STATUS: "+t.CONNECTTION_STATUS),e()}},this.registerMessageListner=function(){var e=this;this.websocket.onmessage=function(t){o.log.i(l,"onMessage","value",t.data),e.protocol.handleResp(t.data,function(t){if(o.log.i(l,"handleResp-callback",t),t){var n=i.default.buildKey(e.url,t.key);t.frameType===s.a.FrameType.Response||t.frameType===s.a.FrameType.ACK?f.invoke(n,s.a.RET.Succeed,t.buffer,t.dataObj):t.frameType===s.a.FrameType.POST?(o.log.i(l,"handleResp-callback-POST",n,t.frameType),u.invoke(n,t.buffer,t.dataObj,t.channelCode)):o.log.i(l,"onMessage-unexpected-frameType",t.frameType)}})}}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"invoker",function(){return u}),t.WebSocketClient=r;var a=n(12),i=n(1),o=n(2),s=n(3),c=n(18),u=new a.InvokerManager(3e3,!0),f=new a.InvokerManager(3e3,!1),l="WebSocketClient"},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(f[t]){var n=f[t];return n.socketClient=e,n}f[t]=this,this.socketClient=e}Object.defineProperty(t,"__esModule",{value:!0}),t.BrigeTcpApi=r;var a=n(5),i=n(4),o=n(3),s=n(0),c=n(1),u="BridgeTcpApi",f={};r.prototype=new a.SocketClientApi2,r.prototype.getPower=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4097,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),s=new DataView(i),u=0;u<14;u++)s.set1x(n.get1x());a.deviceId=c.default.ab2str(s.buffer.slice(0,13)),a.chargeStatus=n.get1x(),a.power=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.e(u,"getPower"+JSON.stringify(e))}},r.prototype.getDeviceCollectStatus=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4098,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),s=new DataView(i),u=0;u<14;u++)s.set1x(n.get1x());a.deviceId=c.default.ab2str(s.buffer.slice(0,13)),a.collectStatus=n.get1x(),a.timestamp=n.get4x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.e(u,"getDeviceCollectStatus",e)}},r.prototype.getMacAddres=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4099,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_BLE_BRIGE,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),f=0;f<14;f++)f<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},s=new ArrayBuffer(14),u=new DataView(s),f=0;f<14;f++)u.set1x(n.get1x());a.deviceId=c.default.ab2str(u.buffer.slice(0,13)),a.bleMac=[n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1)].map(function(e){return Object(i.padStart)(e.toString(16))}).join(":"),a.wifiMac=[n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1)].map(function(e){return Object(i.padStart)(e.toString(16))}).join(":"),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.i(u,"getMacAddres",e)}},r.prototype.setAlarm=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4100,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(25),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set1x(e.flag),n.set1x(e.startHour),n.set1x(e.startMinute),n.set2x(e.continue),n.set1x(e.exceptionFlag),n.set1x(e.breathPauseFlag),n.set1x(e.breathOverSpeedFlag),n.set1x(e.breathTooSlowFlag),n.set1x(e.heartOverSpeedFlag),n.set1x(e.heartTooSlowFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"setAlarm",e)}},r.prototype.getAlarm=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4101,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),s=new DataView(i),u=0;u<14;u++)s.set1x(n.get1x());a.deviceId=c.default.ab2str(s.buffer.slice(0,13)),a.flag=n.get1x(),a.startHour=n.get1x(),a.startMinute=n.get1x(),a.continue=n.get2x(),a.exceptionFlag=n.get1x(),a.breathPauseFlag=n.get1x(),a.breathOverSpeedFlag=n.get1x(),a.breathTooSlowFlag=n.get1x(),a.heartOverSpeedFlag=n.get1x(),a.heartTooSlowFlag=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.i(u,"getAlarm",e)}},r.prototype.setBirthDay=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4102,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(18),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.year),n.set1x(e.month),n.set1x(e.day),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"setBirthDay",e)}},r.prototype.getBirthDay=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4102,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),s=new DataView(i),u=0;u<14;u++)s.set1x(n.get1x());a.deviceId=c.default.ab2str(s.buffer.slice(0,13)),a.year=n.get2x(),a.month=n.get1x(),a.day=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.i(u,"getBirthDay",e)}},r.prototype.download24HistoryData=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4107,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(24),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"downloadHistoryData",e)}},r.prototype.asyncDownload24HistoryData=function(e){try{e.frameType=o.a.FrameType.Request,e.msgType=4110,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(24),n=new DataView(t),r=c.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set4x(e.startTime),n.set2x(e.count),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"asyncDownload24HistoryData",e)}},r.prototype.startCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;var t=new ArrayBuffer(24),n=new DataView(t);n.set2x(4097),n.setStr(e.deviceId,14),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"stopCollect",e)}},r.prototype.stopCollect=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;var t=new ArrayBuffer(24),n=new DataView(t);n.set2x(4098),n.setStr(e.deviceId,14),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"stopCollect",e)}},r.prototype.startRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;var t=new ArrayBuffer(16),n=new DataView(t);n.set2x(4102),n.setStr(e.deviceId,14),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"startRawData",e)}},r.prototype.stopRealData=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||s.DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;var t=new ArrayBuffer(16),n=new DataView(t);n.set2x(4103),n.setStr(e.deviceId,14),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(u,"stopRealData",e)}},r.prototype.registerRealDataCallback=function(e){return this.socketClient.onPostMsg(4104,function(t,n){for(var r=new DataView(t),a={},i=new ArrayBuffer(14),o=new DataView(i),s=0;s<14;s++)o.set1x(r.get1x());a.deviceId=c.default.ab2str(o.buffer.slice(0,13)),a.timestamp=r.get4x(DataView.NO_SIGNED),a.heartRate=r.get1x(DataView.NO_SIGNED),a.breathRate=r.get1x(DataView.NO_SIGNED),a.status=r.get1x(DataView.NO_SIGNED),a.sleepStatus=r.get1x(DataView.NO_SIGNED),a.temperature=r.get1x(),a.humidity=r.get1x(),a.power=r.get1x(DataView.NO_SIGNED),a.otherFlag=r.get1x(DataView.NO_SIGNED),e&&e(a)})},r.prototype.unregisterRealDataCallback=function(e){this.socketClient.removePostMsgListener(4104,e)},r.prototype.registerExceptionStatusCallback=function(e){return this.socketClient.onPostMsg(4108,function(t,n){for(var r=new DataView(t),a={},i=new ArrayBuffer(14),o=new DataView(i),s=0;s<14;s++)o.set1x(r.get1x());a.deviceId=c.default.ab2str(o.buffer.slice(0,13)),a.timestamp=r.get4x(DataView.NO_SIGNED),a.heartOverSpeedFlag=r.get1x(),a.heartTooSlowFlag=r.get1x(),a.breathOverSpeedFlag=r.get1x(),a.breathTooSlowFlag=r.get1x(),a.breathPauseFlag=r.get1x(),e&&e(a)})},r.prototype.unregisterExceptionStatusCallback=function(e){this.socketClient.removePostMsgListener(4108,e)},r.prototype.registerSleepStatusCallback=function(e){return this.socketClient.onPostMsg(4109,function(t,n){for(var r=new DataView(t),a={},i=new ArrayBuffer(14),o=new DataView(i),s=0;s<14;s++)o.set1x(r.get1x());a.deviceId=c.default.ab2str(o.buffer.slice(0,13)),a.timestamp=r.get4x(DataView.NO_SIGNED),a.status=r.get1x(),e&&e(a)})},r.prototype.unregisterSleepStatusCallback=function(e){this.socketClient.removePostMsgListener(4109,e)}},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(s[t]){var n=s[t];return n.socketClient=e,n}s[t]=this,this.socketClient=e}Object.defineProperty(t,"__esModule",{value:!0}),t.NoxTcpApi=r;var a=n(5),i=n(2),o=n(3),s={};r.prototype=new a.SocketClientApi2,r.prototype.alarmOperation=function(e){try{e.frameType=o.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set2x(83),n.set1x(e.operationCode),n.set8x(e.alarmId),3==e.operationCode&&(n.set1x(e.volume),n.set1x(e.lightBrightness),n.set1x(0),n.set2x(e.musicId)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){i.log.i(logTip,"sceneOperation",e)}}},function(e,t,n){"use strict";function r(e){this.socketClient=e,this.protocol=new c.a,this.socketClient.setProtocol(this.protocol)}Object.defineProperty(t,"__esModule",{value:!0}),t.NoxApApi=r;var a=n(2),i=n(1),o=n(3),s=n(24),c=n(76),u=n(26),f=n(4),l="NoxAPApi";s.default,new c.a;this.key=function(){return i.default.buildKey(this.ip,this.port)},r.prototype.wifiConfig=function(e){try{e.frameType=u.a.Request,e.msgType=1;var t=new ArrayBuffer(120),n=new DataView(t),r=null;if(e.ssidRaw){var s=null;s=e.ssidRaw.constructor==Array?e.ssidRaw:JSON.parse(e.ssidRaw),r=i.default.arr2Buffer(s)}else r=i.default.str2ab(e.ssid);for(var c=new DataView(r),f=0;f<33;f++)f<r.byteLength?n.set1x(c.get1x()):n.set1x(0);e.password.length>0?n.set1x(1):n.set1x(0);for(var p=i.default.str2ab(e.password),d=new DataView(p),g=0;g<65;g++)g<p.byteLength?n.set1x(d.get1x()):n.set1x(0);if(n.position=99,n.set1x(e.ipAllocType),e.staticIp&&e.staticIp.length>0){var h=e.staticIp.split(":");n.set1x(h[0]),n.set1x(h[1]),n.set1x(h[2]),n.set1x(h[3])}if(n.position=104,e.subnetMask&&e.subnetMask.length>0){var y=e.subnetMask.split(":");n.set1x(y[0]),n.set1x(y[1]),n.set1x(y[2]),n.set1x(y[3])}if(n.position=108,e.gateway&&e.gateway.length>0){var v=e.gateway.split(":");n.set1x(v[0]),n.set1x(v[1]),n.set1x(v[2]),n.set1x(v[3])}if(n.position=112,e.dns1&&e.dns1.length>0){var T=e.dns1.split(":");n.set1x(T[0]),n.set1x(T[1]),n.set1x(T[2]),n.set1x(T[3])}if(n.position=116,e.dns2&&e.dns2.length>0){var E=e.dns2.split(":");n.set1x(E[0]),n.set1x(E[1]),n.set1x(E[2]),n.set1x(E[3])}n.position=120,e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){a.log.e(l,"wifiConfig",e)}},r.prototype.getDeviceInfo=function(e){try{e.frameType=u.a.Request,e.msgType=2;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},s=new ArrayBuffer(14),c=new DataView(s),u=0;u<14;u++)c.set1x(n.get1x());for(var f=new ArrayBuffer(14),l=new DataView(f),p=0;p<14;p++)l.set1x(n.get1x());a.deviceId=i.default.ab2str(c.buffer.slice(0,13)),a.deviceName=i.default.ab2str(l.buffer.slice(0,13)),a.firmwareVersion=parseFloat(n.getUint16(28,!0)/100),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){a.log.i(l,"getDeviceInfo",e)}},r.prototype.getWifiList=function(e){try{e.frameType=u.a.Request,e.msgType=4;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a=n.get1x(),s=new Array,c=0;c<a;c++){for(var u={},f=new ArrayBuffer(32),l=new DataView(f),p=0;p<32;p++)l.set1x(n.get1x());u.ssid=i.default.ab2str(l.buffer.slice(0,32)),u.signalIntensity=n.get1x(),s[c]=u}e.handler&&e.handler(t,s)}else e.handler&&e.handler(t)})}catch(e){a.log.i(l,"getWifiList",e)}},r.prototype.getDeviceNetInfo=function(e){try{e.frameType=u.a.Request,e.msgType=6;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){for(var a={},s=new ArrayBuffer(32),c=new DataView(s),u=0,l=0;l<32;l++){var p=n.get1x();if(0==p)break;u++,c.set1x(p)}n.position=32,a.serverAddress=i.default.ab2str(c.buffer.slice(0,u)),a.port=n.getUint16(32,!0),a.mac=[n.getUint8(34),n.getUint8(35),n.getUint8(36),n.getUint8(37),n.getUint8(38),n.getUint8(39)].map(function(e){return Object(f.padStart)(e.toString(16))}).join(":"),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){a.log.i(l,"getDeviceInfo",e)}},r.prototype.setServerAddress=function(e){try{e.frameType=u.a.Request,e.msgType=5;for(var t=new ArrayBuffer(34),n=new DataView(t),r=i.default.str2ab(e.address),s=new DataView(r),c=0;c<s.byteLength;c++)n.set1x(s.get1x());n.position=32,n.setInt16(n.position,e.port,!0),this.position+=2,e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){a.log.i(l,"setServerAddress",e)}},r.prototype.configFinish=function(){try{var e={};e.frameType=u.a.ACK,e.msgType=4;var t=new ArrayBuffer(1),n=new DataView(t);n.set1x(0),e.content=n.buffer,this.sendMsg(e,e.content,function(e,t,n){})}catch(e){a.log.i(l,"setServerAddress",e)}},r.prototype.sendMsg=function(e,t,n){a.log.i(l,"sendMsg-start",e,i.default.buffer2Arr(t),this);try{this.socketClient.sendPacket({frameType:e.frameType,msgType:e.msgType,content:t,timeout:e.timeout||o.a.timeout,handler:function(t,r,i){if(a.log.i(l,"tcp back ----",t,r,i),t===o.a.RET.Succeed){var s=new DataView(r);a.log.i(l,"sendPacket_status",status,"msgType:",e.msgType),n(o.a.RET.Succeed,s,i)}else a.log.i(l,"sendPacket_status","msgType:",e.msgType),n(o.a.RET.Timeout,void 0)}})}catch(e){a.log.e(l,"sendMsg",e)}}},function(e,t,n){"use strict";function r(){this.callStatusMap=new s.Map,this.respDv=new DataView(new ArrayBuffer(3072)),this.respBufIndex=0,this.buildMsg=function(e){try{var t="ProtocolNoxAp:"+e.msgType,n=e.content||new ArrayBuffer(0),r=new DataView(new ArrayBuffer(7+n.byteLength));r.set1x(i.b.code1),r.set1x(i.b.code2),r.set1x(e.frameType),r.setUint16(r.position,1+n.byteLength,!0),r.position+=2,r.set1x(e.msgType);for(var a=new DataView(n),o=0;o<a.byteLength;o++)r.set1x(a.get1x());var s=Object(c.crc8buf)(r.buffer.slice(0,r.byteLength-1));return r.set1x(s),{key:t,buffer:r.buffer}}catch(e){u.log.e(f,"MedicaNoxAPProtocol.buildMsg",e)}},this.handleResp=function(e,t){var n=new a.a,r=n.appendData(e);if(r&&r.length>0)for(var s=0;s<r.length;s++){var c="ProtocolNoxAp:"+r[s].messageType,u=void 0;r[s].frameType==i.a.Request&&(u=o.a.FrameType.Request),r[s].frameType==i.a.POST&&(u=o.a.FrameType.POST),r[s].frameType==i.a.ACK&&(u=o.a.FrameType.ACK),r[s].frameType==i.a.Response&&(u=o.a.FrameType.Response),t({key:c,buffer:r[s].content,dataObj:r[s],frameType:u})}},this.buildKeepAlive=function(e){},this.buildACK=function(e){}}t.a=r;var a=n(77),i=n(26),o=n(3),s=n(6),c=n(15),u=n(2),f="noxAPProtocol";r.isEndMsg=function(e,t,n){}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(){var e=new ArrayBuffer(0),t=[],n=function(t){e=t},a=function(t){n(e.append(t))},s=function(){var t=c(e),r=t.left,a=t.bufferAry;return n(r),a},c=function(e){if(e.byteLength<7)return{left:e,bufferAry:[]};for(var t=[],n=0,r=new DataView(e),a=0;a<e.byteLength;)if(r.getUint8(a)==i.b.code1&&r.getUint8(a+1)==i.b.code2){a+=2;var s=(r.getUint8(a++),r.getUint16(a,!0));a+=2;var c=r.getUint8(a);if(6==c&&(s=41),e.byteLength<7+s-1)break;var u=7+s-1,f=e.slice(n,u);t.push(f),a=n+u,n=a}else o.log.i("_cutArrayBufferWithSeparator 找不到前导码，消息丢弃"),a++,n=a;return{left:e.slice(n,e.byteLength-n),bufferAry:t}},u=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=Object(i.c)(r);a&&t.push(a)}return t};this.appendData=function(e){a(e);var n=s(),i=u(n);if(i&&i.length>0){var o;(o=t).push.apply(o,r(i))}return t},this.empty=function(){e=new ArrayBuffer(0),t=[]}}t.a=a;var i=n(26),o=n(2)},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(u[t]){var n=u[t];return n.socketClient=e,n}u[t]=this,this.socketClient=e}Object.defineProperty(t,"__esModule",{value:!0}),t.DotTcpApi=r;var a=n(5),i=n(3),o=n(1),s=n(4),c="NoxAromaTcpApi",u={};r.prototype=new a.SocketClientApi2,r.prototype.setMonitorTime=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=770,e.subVersion=1;var t=e.autoStartClock,n=new ArrayBuffer(19),r=new DataView(n);r.setStr(e.deviceId,14),r.set1x(t.hour),r.set1x(t.minute),r.set2x(t.duration),r.set1x(t.weekday),e.content=r.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler&&e.handler(t)})}catch(e){log.e(c,"set milky time",e)}},r.prototype.getPower=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=1025,e.deviceType=e.deviceType,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=o.default.str2ab(e.deviceId),a=new DataView(r),s=0;s<14;s++)s<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==i.a.RET.Succeed){for(var a={},s=new ArrayBuffer(14),c=new DataView(s),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.battery=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.e(c,"getPower",e)}},r.prototype.getDeviceCollectStatus=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=1026,e.deviceType=e.deviceType,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=o.default.str2ab(e.deviceId),a=new DataView(r),s=0;s<14;s++)s<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==i.a.RET.Succeed){for(var a={},s=new ArrayBuffer(14),c=new DataView(s),u=0;u<14;u++)c.set1x(n.get1x());a.deviceId=o.default.ab2str(c.buffer.slice(0,13)),a.collectStatus=n.get1x(),a.timestamp=n.get4x(),a.duration=n.get2x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.i(c,"getDeviceOnlineStatus",e)}},r.prototype.getMacAddres=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=4099,e.deviceType=e.deviceType||DEVICE_TYPE.DEVICE_TYPE_BLE_BRIGE,e.subVersion=1;for(var t=new ArrayBuffer(14),n=new DataView(t),r=o.default.str2ab(e.deviceId),a=new DataView(r),u=0;u<14;u++)u<r.byteLength?n.set1x(a.get1x()):n.set1x(0);e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==i.a.RET.Succeed){for(var a={},c=new ArrayBuffer(14),u=new DataView(c),f=0;f<14;f++)u.set1x(n.get1x());a.deviceId=o.default.ab2str(u.buffer.slice(0,13)),a.bleMac=[n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1)].map(function(e){return Object(s.padStart)(e.toString(16))}).join(":"),a.wifiMac=[n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1),n.get1x(1)].map(function(e){return Object(s.padStart)(e.toString(16))}).join(":"),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){log.i(c,"getMacAddres",e)}},r.prototype.setBirthDay=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=4102,e.deviceType=e.deviceType||DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;for(var t=new ArrayBuffer(18),n=new DataView(t),r=o.default.str2ab(e.deviceId),a=new DataView(r),s=0;s<14;s++)s<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.year),n.set1x(e.month),n.set1x(e.day),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){i.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(c,"setBirthDay",e)}},r.prototype.stopCollect=function(e){try{e.frameType=i.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||DEVICE_TYPE.DEVICE_TYPE_GP300,e.subVersion=1;var t=new ArrayBuffer(24),n=new DataView(t);n.set2x(3),n.setStr(e.deviceId,14),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){i.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){log.i(c,"stopCollect",e)}},r.prototype.registerExceptionStatusCallback=function(e){return this.onPostMsg(256,function(t,n){var r=new DataView(t);if(4==r.get2x()){for(var a={},i=new ArrayBuffer(14),s=new DataView(i),c=0;c<14;c++)s.set1x(r.get1x());a.deviceId=o.default.ab2str(s.buffer.slice(0,13)),a.power=r.get1x(),e&&e(a)}})},r.prototype.unregisterExceptionStatusCallback=function(e){this.removePostMsgListener(256,e)}},function(e,t,n){"use strict";function r(e){e.url&&(e.conf={ip:e.url.substring(0,e.url.indexOf(":")),port:e.url.substring(e.url.indexOf(":")+1)});var t=e.conf.ip+"_"+e.conf.port;if(i[t]){var n=i[t];return n.socketClient=e,n}i[t]=this,this.socketClient=e}Object.defineProperty(t,"__esModule",{value:!0}),t.PillowTcpApi=r;var a=n(5),i={};r.prototype=new a.SocketClientApi2},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.DEVICE_TYPE.DEVICE_TYPE_RESONT_Z4TWP;e.url&&(e.conf={ip:e.url.substring(0,e.url.indexOf(":")),port:e.url.substring(e.url.indexOf(":")+1)});var n=e.conf.ip+"_"+e.conf.port+"_"+t;if(h[n]){var r=h[n];return r.socketClient=e,r}h[n]=this,this.socketClient=e,this.protocol=new d.b,e.setProtocol(this.protocol),this.deviceType=t}function a(e){var t={},n=e.get1x(),r=e.get1x();return t.temperature=n,t.humidity=r,t}function i(e){var t={};t.deviceId=l.default.buf2string(e.buffer.slice(0,13)),e.position=14,t.deviceType=e.get2x(),t.num=e.get1x(),t.count=e.get1x(),t.realDataList=[];for(var n=0;n<t.count;n++){var r={};r.timestamp=e.get4x(),r.heartRate=e.get1x(DataView.NO_SIGNED),r.breathRate=e.get1x(DataView.NO_SIGNED),r.status=e.get1x(DataView.NO_SIGNED),r.statusValue=e.get2x(DataView.NO_SIGNED),r.sleepFlag=e.get1x(),r.awakeFlag=e.get1x(),r.eTemp=e.get1x(),r.eWet=e.get1x(),t.realDataList.push(r)}return t}function o(e){for(var t={},n=new ArrayBuffer(14),r=new DataView(n),a=0;a<14;a++)r.set1x(e.get1x());return t.deviceId=l.default.ab2str(r.buffer.slice(0,13)),t.deviceType=e.get2x(),t.num=e.get1x(),t.collectStatus=e.get1x(),t.timestamp=e.get4x(1),t}Object.defineProperty(t,"__esModule",{value:!0}),t.Z400TWPTcpApi=r;var s=n(5),c=n(3),u=n(0),f=n(2),l=n(1),p=n(4),d=n(10),g="z400twpTcpApi",h={};r.prototype=new s.SocketClientApi2,r.prototype.getDeviceMAC=function(e){e.frameType=c.a.FrameType.Request,e.msgType=935,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a=n.buffer.slice(2),i=Array.from(new Uint8Array(a.slice(0,6)));i=i.map(function(e){return Object(p.padStart)(e.toString(16))}).join(":").toUpperCase(),e.handler&&e.handler(t,{macAddr:i})}else e.handler&&e.handler(t,n)})},r.prototype.setServerAddress=function(e){e.frameType=c.a.FrameType.Request,e.msgType=930;var t=new ArrayBuffer(162),n=new DataView(t),r=new Int8Array(t),a=l.default.str2ab(e.address);if(r.set(new Int8Array(a)),n.position=32,n.set2x(e.port,1),e.httpUrl){var i=l.default.str2ab(e.httpUrl);r.set(new Int8Array(i))}e.content=n.buffer,this.sendMsg(e,e.content)},r.prototype.wifiConfig=function(e){var t=e.ssid,n=e.password,r=e.ipAllocType,a=e.staticIp,i=e.subnetMask,o=e.gateway,s=e.dns1,u=e.dns2,f=e.ssidRaw;e.frameType=c.a.FrameType.Request,e.msgType=928;var p=new ArrayBuffer(120),d=new Int8Array(p),g=new DataView(p),h=null;if(f){var y=null;y=f.constructor==Array?f:JSON.parse(f),h=l.default.arr2Buffer(y)}else h=l.default.str2ab(t);d.set(new Int8Array(h)),g.position=33,n&&n.length>0?g.set1x(1):g.set1x(0);var v=l.default.str2ab(n);if(d.set(new Int8Array(v),g.position),g.position=99,g.set1x(r),a&&a.length>0){var T=a.split(":");p.set(new Uint8Array(T),g.position)}if(g.position=104,i&&i.length>0){var E=i.split(":");p.set(new Uint8Array(E),g.position)}if(g.position=108,o&&o.length>0){var _=o.split(":");p.set(new Uint8Array(_),g.position)}if(g.position=112,s&&s.length>0){s.split(":");p.set(new Uint8Array(ips),g.position)}if(g.position=116,u&&u.length>0){u.split(":");p.set(new Uint8Array(ips),g.position)}g.position=120,e.content=g.buffer,this.sendMsg(e,e.content)},r.prototype.getTemperatureAndHumidity=function(e){e.frameType=c.a.FrameType.Request,e.msgType=1031,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(16),n=new DataView(t);n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var i=a(n);e.handler&&e.handler(t,i)}else e.handler&&e.handler(t)})},r.prototype.startRealData=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(19),n=new DataView(t);n.set2x(7),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(g,"startRawData",e)}},r.prototype.stopRealData=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.subVersion=0;var t=new ArrayBuffer(19),n=new DataView(t);n.set2x(8),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.serialNumber),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(g,"stopRealData",e)}},r.prototype.registerRealDataCallback=function(e){return this.socketClient.onPostMsg(1536,function(t,n,r){var a=new DataView(t),o=i(a);e&&e(o,r)})},r.prototype.unregisterRealDataCallback=function(e){this.socketClient.removePostMsgListener(1536,e)},r.prototype.getDeviceCollectStatus=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=1026,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;for(var t=new ArrayBuffer(17),n=new DataView(t),r=l.default.str2ab(e.deviceId),a=new DataView(r),i=0;i<14;i++)i<r.byteLength?n.set1x(a.get1x()):n.set1x(0);n.set2x(e.deviceType),n.set1x(e.num),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a=o(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){f.log.i(g,"getDeviceOnlineStatus",e)}},r.prototype.startCollect=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(27),n=new DataView(t);n.set2x(9),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.num),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(g,"startCollect",e)}},r.prototype.stopCollect=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(27),n=new DataView(t);n.set2x(10),n.setStr(e.deviceId,14),n.set2x(e.deviceType),n.set1x(e.num),n.set4x(e.userId),n.set4x(e.timestamp),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(g,"stopCollect",e)}},r.prototype.registerCollectStatusCallback=function(e){return this.socketClient.onPostMsg(1026,function(t,n,r){var a=new DataView(t),i=o(a);e&&e(i,r)})}},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(d[t]){var n=d[t];return n.socketClient=e,n}d[t]=this,this.socketClient=e}function a(e,t){var n={};if(n.mode=e.get1x(),n.sceneCount=e.get1x(),n.scenes=[],n.sceneCount>0)for(var r=0;r<n.sceneCount;r++){var a={};a.sceneId=e.get8x(),a.sceneType=e.get1x(),n.scenes.push(a)}n.sleepAidStatus=e.get1x(),n.sleepAidLeave=e.get1x(),n.alarmStatus=e.get1x(),n.alarmId=e.get8x();var i=e.get1x(),o=e.get1x();n.light=f.a.lightConfigParse(e),n.light.lightStatus=i,n.light.lightBrightness=o,n.aromatherapySpeed=e.get1x();var s=e.get1x(),c=e.get1x();return n.music=f.a.musicConfigParse(e),n.music.musicStatus=s,n.music.volume=c,n.music.soundLightFlag=e.get1x(),n}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255,t=arguments[1],n=t.singleType,r=void 0===n?0:n,a=t.loop,i=void 0===a?0:a,o=new ArrayBuffer(1024),s=new DataView(o),c=arguments[1];switch(s.set1x(e),void 0!=c.circleMode&&(i=c.circleMode),isNaN(c.playMode)&&(c.playMode=i?2:0),e){case u.MUSIC_TYPE.LOCAL:case u.MUSIC_TYPE.OUTSITE:s.set2x(c.musicId);break;case u.MUSIC_TYPE.SLEEPACE_ALBUM:s.set1x(r).set4x(c.musicId);break;case u.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case u.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:s.set4x(c.albumId).set4x(c.musicId).set2x(c.currentIndex).set1x(c.playMode)}return s.set1x(i),o.slice(0,s.position)}function o(e){e=e||{};var t=null==e.musicType?255:e.musicType,n=null==e.loop?0:e.loop,r=new ArrayBuffer(1024),a=new DataView(r);switch(a.set1x(t),t){case u.MUSIC_TYPE.LOCAL:case u.MUSIC_TYPE.OUTSITE:a.set2x(e.musicId);break;case u.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case u.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:a.set4x(e.musicId);break;default:a.set2x(65535)}return a.set1x(n),r.slice(0,a.position)}Object.defineProperty(t,"__esModule",{value:!0}),t.NoxAromaTcpApi=r;var s=n(5),c=n(3),u=n(0),f=n(9),l=n(2),p="NoxAromaTcpApi",d={};r.prototype=new s.SocketClientApi2,r.prototype.updateFireware=function(e){s.SocketClientApi2.prototype.updateFirmwareX1000.call(this,e)},r.prototype.aromatherapyOperation=function(e){l.log.i("aromatherapyOperation====",e);try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(4),n=new DataView(t);n.set2x(85);var r=e.operationCode;r|=e.mode<<4,n.set1x(r),n.set1x(e.aromatherapySpeed),e.content=n.buffer,l.log.i("aromatherapyOperation===========",e),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"aromatherapyOperation",e)}},r.prototype.musicOperation=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.subVersion=1;var t=e.operationCode,n=e.volume,r=e.musicType,a=e.music;a.circleMode=isNaN(a.circleMode)?0:a.circleMode;var o=new ArrayBuffer(3),s=new DataView(o),u=t;u|=e.mode<<4,s.set2x(84).set1x(u);var f=new ArrayBuffer(1);if(new DataView(f).set1x(n),0!=e.operationCode&&2!=e.operationCode){var d=i(void 0!=r?r:0,a);o=o.mergeBuffer(f,d)}e.content=o,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"musicOperation",e)}},r.prototype.sceneOperation=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=o(e.musicData),n=new ArrayBuffer(11);new DataView(n).set2x(81).set1x(e.operationCode).set8x(e.sceneId);var r=new ArrayBuffer(3);new DataView(r).set1x(void 0==e.lightFlag?255:e.lightFlag).set1x(void 0==e.musicFlag?255:e.musicFlag).set1x(void 0==e.aromaFlag?255:e.aromaFlag),e.content=n.mergeBuffer(t,r),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"sceneOperation",e)}},r.prototype.getWorkMode=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=1044,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a=f.a.workModeParse(n,e.deviceType);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){l.log.i(p,"getWorkMode",e)}},r.prototype.startRealData=function(e){l.log.i(p,"startRealData");try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(7),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,e.deviceType=u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"startRealData",e)}},r.prototype.stopRealData=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=0;var t=new ArrayBuffer(18),n=new DataView(t);n.set2x(8),n.setStr(e.deviceId,14),n.set2x(e.deviceType),e.content=n.buffer,e.deviceType=u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"stopRealData",e)}},r.prototype.sleepAidOperation=function(e){l.log.i(p,"sleepAidOperation",e);try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(6),n=new DataView(t);n.set2x(55),n.set1x(e.operationType),n.set1x(e.lightFlag),n.set1x(e.musicFlag),n.set1x(e.aromaFlag),e.content=n.buffer,this.sendMsg(e,e.content,function(t,n,r){l.log.i(p,"sleepAidOperation back"),c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"sleepAidOperation",e)}},r.prototype.startConfig=function(e){e.subVersion=1,s.SocketClientApi2.prototype.startConfig.call(this,e)},r.prototype.stopConfig=function(e){e.subVersion=1,s.SocketClientApi2.prototype.stopConfig.call(this,e)},r.prototype.alarmOperation=function(e){try{e.frameType=c.a.FrameType.POST,e.msgType=256,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_NOX_PRO,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);n.set2x(83),n.set1x(e.operationCode),n.set8x(e.alarmId),3==e.operationCode&&(n.set1x(e.volume),n.set1x(e.lightBrightness),n.set1x(e.aromatherapySpeed),n.set1x(0),n.set2x(e.musicId)),e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"alarmOperation",e)}},r.prototype.albumMusicConfig=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=815,e.subVersion=1;var t=new ArrayBuffer(20),n=void 0,r=new DataView(t),a=e.albumList||[];r.set1x(e.albumType||u.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM).set1x(a.length),n=t.slice(0,r.position).toArray(),a.forEach(function(e){var a=e.musicList;r.position=0,r.set1x(e.type|(e.isMusicLight?128:0)).set4x(e.seqId).set2x(a.length),n=n.concat(t.slice(0,r.position).toArray()),a&&a.length&&a.forEach(function(e){var t=o(e);n=n.concat(t.slice(1,t.byteLength-1).toArray())})}),e.content=ArrayBuffer.prototype.fromArray(n),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){l.log.i(p,"albumMusicConfig",e)}},r.prototype.registerWorkModeCallback=function(e){return this.socketClient.onPostMsg(1044,function(t,n){var r=new DataView(t),i=a(r,n.deviceType);e&&e(i)})},r.prototype.unregisterWorkModeCallback=function(e){this.socketClient.removePostMsgListener(1044,e)}},function(e,t,n){"use strict";function r(e){var t=e.conf.ip+"_"+e.conf.port;if(u[t]){var n=u[t];return n.socketClient=e,n}this.socketClient=e,u[t]=this}Object.defineProperty(t,"__esModule",{value:!0}),t.AromaLanApi=r;var a=n(41),i=n(3),o=n(0),s=n(9),c=n(2),u={};r.prototype=new a.SocketClientApi1,r.prototype.alarmOperation=function(e){try{e.frameType=i.a.FrameType.Request,e.msgType=52,e.deviceType=e.deviceType||o.DEVICE_TYPE.DEVICE_TYPE_NOX_SA1001,e.subVersion=1;var t=new ArrayBuffer(1024),n=new DataView(t);if(n.set1x(e.operationCode),n.set8x(e.alarmId),3==e.operationCode){n.set1x(e.volume),n.set1x(e.lightBrightness),n.set1x(e.aromatherapySpeed);var r=e.music;s.a.musicConfigFill(r,n)}e.content=n.buffer.slice(0,n.position),this.sendMsg(e,e.content,function(t,n,r){i.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){c.log.i(logTip,"centerKeyConfig",e)}}},function(e,t,n){"use strict";function r(e){if(e){var t=e.conf.ip+"_"+e.conf.port;if(f[t]){var n=f[t];return n.socketClient=e,n}f[t]=this,this.socketClient=e}}Object.defineProperty(t,"__esModule",{value:!0}),t.M871WTcpApi=r;var a=n(42),i=n(9),o=n(0),s=n(1),c=n(3),u=(n(5),n(2)),f={};r.prototype=new a.M800TcpApi,r.prototype.getSystemInfo=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=8448,e.subVersion=0;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n,r){if(u.log.i("M871WTcpApi","getSystemInfo code:"+t,n,r),t==c.a.RET.Succeed){var a=void 0,i=void 0,o=void 0,f=void 0,l=void 0,p=void 0,d=void 0,g=void 0,h=void 0,y=void 0;a=s.default.ab2string(n.buffer.slice(2,16)),i=s.default.ab2string(n.buffer.slice(16,30)),n.position=30,o=n.get2x(1),f=n.get2x(1),l=n.get2x(1),p=n.get4x(1),d=n.get2x(1),g=n.get2x(1),h=n.get2x(1),y=n.get1x(1),e.handler&&e.handler(t,{deviceName:a,deviceId:i,deviceType:o,currVersion:f,facVersion:l,facTime:p,manufacCode:d,cooperateCode:g,pcbVersion:h,mattressType:y})}else e.handler&&e.handler(t)})}catch(e){u.log.i("M871WTcpApi","getSystemInfo",e)}},r.prototype.unregisteSensorStateCallback=function(e){this.socketClient.removePostMsgListener(1187,e)},r.prototype.registeSensorStateCallback=function(e,t){return this.socketClient.onPostMsg(1187,function(n,r,a){var o=new DataView(n),s=i.a.sensorParse(o,t);e&&e(s,a)})},r.prototype.querySensorState=function(e){e.frameType=o.FRAME_TYPE.Request,e.msgType=1187,e.deviceType=e.deviceType||o.DEVICE_TYPE.DEVICE_TYPE_M871W,e.subVersion=0;for(var t=new DataView(new ArrayBuffer(17)),n=s.default.str2ab(e.deviceId),r=new DataView(n),a=0;a<14;a++)a<n.byteLength?t.set1x(r.get1x()):t.set1x(0);t.set2x(e.deviceType),t.set1x(e.num),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){for(var a={},i=new ArrayBuffer(14),o=new DataView(i),u=0;u<14;u++)o.set1x(n.get1x());a.deviceId=s.default.ab2str(o.buffer.slice(0,13)),a.deviceType=n.get2x(),a.num=n.get1x(),a.connectState=n.get1x(),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.registerRealDataCallback=function(e){return this.socketClient.onPostMsg(1280,function(t,n,r){var a=new DataView(t),o=i.a.m8701wRealDataParse(a);e&&e(o,r)})},r.prototype.unregisterRealDataCallback=function(e){this.socketClient.removePostMsgListener(1280,e)}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.DEVICE_TYPE.DEVICE_TYPE_SN913,n=e.conf.ip+"_"+e.conf.port+"_"+t;if(p[n]){var r=p[n];return r.socketClient=e,r}p[n]=this,this.socketClient=e,this.protocol=new l.b,e.setProtocol(this.protocol),this.deviceType=t,this.deviceId=null}function a(e,t){for(var n=e.get1x(1),r=[],a=0;a<n;a++){var i=e.buffer.slice(e.position,e.position+=26),o=new DataView(i),s={seqid:o.get8x(1),isOpen:o.get1x(1),smartFlag:o.get1x(1),smartOffset:o.get1x(1),hour:o.get1x(1),minute:o.get1x(1),weekday:o.get1x(1),cycle:o.get1x(1),lazy:o.get1x(1),volum:o.get1x(1),lightIntensity:o.get1x(1),musicSeqid:o.get2x(1),updateTimeStamp:o.get4x(1),duration:o.get2x(1)};s.isNeedLightAwake=s.lightIntensity>0?1:0,r.push(s)}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.SN913TcpApi=r;var i=n(5),o=n(3),s=n(0),c=n(9),u=n(1),f=n(4),l=n(10),p={};r.prototype=new i.SocketClientApi2,r.prototype.sendMsg=function(e,t,n){e.deviceType=e.deviceType||this.deviceType,e.networkDeviceId=e.networkDeviceId||this.deviceId,e.subVersion=null==e.subVersion?1:e.subVersion,i.SocketClientApi2.prototype.sendMsg.call(this,e,t,n)},r.prototype.wifiConfig=function(e){var t=e.ssid,n=e.password,r=e.ipAllocType,a=e.staticIp,i=e.subnetMask,s=e.gateway,c=e.dns1,f=e.dns2,l=e.ssidRaw;e.frameType=o.a.FrameType.Request,e.msgType=5120;var p=new ArrayBuffer(120),d=new Int8Array(p),g=new DataView(p),h=null;if(l){var y=null;y=l.constructor==Array?l:JSON.parse(l),h=u.default.arr2Buffer(y)}else h=u.default.str2ab(t);d.set(new Int8Array(h)),g.position=33,n.length>0?g.set1x(1):g.set1x(0);var v=u.default.str2ab(n);if(d.set(new Int8Array(v),g.position),g.position=99,g.set1x(r),a&&a.length>0){var T=a.split(":");p.set(new Uint8Array(T),g.position)}if(g.position=104,i&&i.length>0){var E=i.split(":");p.set(new Uint8Array(E),g.position)}if(g.position=108,s&&s.length>0){var _=s.split(":");p.set(new Uint8Array(_),g.position)}if(g.position=112,c&&c.length>0){c.split(":");p.set(new Uint8Array(ips),g.position)}if(g.position=116,f&&f.length>0){f.split(":");p.set(new Uint8Array(ips),g.position)}g.position=120,e.content=g.buffer,this.sendMsg(e,e.content)},r.prototype.getWifiConfig=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5121,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=void 0,i=void 0,s=void 0,c=void 0,f=void 0,l=void 0,p=void 0,d=void 0,g=n.buffer.slice(2);n=new DataView(g),a=u.default.ab2string(g.slice(0,33)),n.position=33,i=null,0!==n.get1x()&&(i=u.default.ab2string(g.slice(n.position,65))),n.position=99,s=n.get1x(),c=new Uint8Array(g.slice(n.position,4)).join(":"),n.position=104,f=new Uint8Array(g.slice(n.position,4)).join(":"),n.position=108,l=new Uint8Array(g.slice(n.position,4)).join(":"),n.position=112,p=new Uint8Array(g.slice(n.position,4)).join(":"),n.position=116,d=new Uint8Array(g.slice(n.position,4)).join(":"),e.handler&&e.handler(t,{ssid:a,password:i,ipAllocType:s,staticIp:c,subnetMask:f,gateway:l,dns1:p,dns2:d})}else e.handler&&e.handler(t,n)})},r.prototype.setServerAddress=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5122;var t=new ArrayBuffer(34),n=new DataView(t),r=new Int8Array(t),a=u.default.str2ab(e.address);r.set(new Int8Array(a)),n.position=32,n.set2x(e.port,1),e.content=n.buffer,this.sendMsg(e,e.content)},r.prototype.getServerAddress=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5123,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=void 0,i=void 0,s=n.buffer;a=u.default.ab2string(s.slice(2,34)),n.position=34,i=n.get2x(e.port,1),e.handler&&e.handler(t,{address:a,port:i})}else e.handler&&e.handler(t,n)})},r.prototype.getDeviceMAC=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5124,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=n.buffer.slice(2),i=Array.from(new Uint8Array(a.slice(0,6)));i=i.map(function(e){return Object(f.padStart)(e.toString(16))}).join(":").toUpperCase(),e.handler&&e.handler(t,{macAddr:i})}else e.handler&&e.handler(t,n)})},r.prototype.sleepAidOperation=function(e){var t=e.operationCode,n=e.musicFlag,r=e.lightFlag,a=e.updateDuration,i=e.musicId,s=e.volume,c=e.brightness,u=e.r,f=e.g,l=e.b,p=e.w,d=e.smartFlag,g=e.duration;e.frameType=o.a.FrameType.Request,e.msgType=5125;var h=new ArrayBuffer(15);new DataView(h).set1x(t).set1x(n).set1x(r).set1x(a).set2x(i).set1x(s).set1x(c).set1x(u).set1x(f).set1x(l).set1x(p).set1x(d).set2x(g),e.content=h,this.sendMsg(e,e.content)},r.prototype.getSleepAid=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5126,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){o.a.RET.Succeed,e.handler&&e.handler(t)})},r.prototype.lightOperation=function(e){var t=e.light,n=t.operationCode,r=t.brightness,a=t.colorId,i=t.r,s=t.g,c=t.b,u=t.w,f=t.duration;e.frameType=o.a.FrameType.Request,e.msgType=5127;var l=new ArrayBuffer(9);new DataView(l).set1x(n).set1x(r).set1x(a).set1x(i).set1x(s).set1x(c).set1x(u).set2x(f),e.content=l,this.sendMsg(e,e.content)},r.prototype.lightBlinkOperate=function(e){var t=e.light,n=t.operationCode,r=t.colorMode,a=t.r,i=t.g,s=t.b,c=t.w,u=t.upBRIStart,f=t.upBRIEnd,l=t.upDuration,p=t.downR,d=t.downG,g=t.downB,h=t.downW,y=t.downBRIStart,v=t.downBRIEnd,T=t.downDuration,E=t.hWaitingTime,_=t.lWaitingTime,m=t.duration,w=e.music||{},x=w.musicFlag,D=w.musicId,b=w.volume;e.frameType=o.a.FrameType.Request,e.msgType=5128;var A=new ArrayBuffer(28);new DataView(A).set1x(n).set1x(r).set1x(x).set2x(D).set1x(b).set1x(a).set1x(i).set1x(s).set1x(c).set1x(u).set1x(f).set2x(l).set1x(p).set1x(d).set1x(g).set1x(h).set1x(y).set1x(v).set2x(T).set2x(_).set2x(E).set2x(m),e.content=A,this.sendMsg(e,e.content)},r.prototype.lightBlink2Operate=function(e){var t=e.params,n=t.operationCode,r=t.mode,a=t.volume;e.frameType=o.a.FrameType.Request,e.msgType=5172;var i=new ArrayBuffer(4);new DataView(i).set1x(n).set1x(r).set1x(a).set1x(0),e.content=i,this.sendMsg(e,e.content)},r.prototype.smallNightConfig=function(e){var t=e.light,n=t.operationCode,r=t.enabled,a=t.BRI,i=t.r,s=t.g,c=t.b,u=t.w,f=t.startHour,l=t.startMinute,p=t.duration;e.frameType=o.a.FrameType.Request,e.msgType=5129;var d=new ArrayBuffer(11);new DataView(d).set1x(n).set1x(r).set1x(a).set1x(i).set1x(s).set1x(c).set1x(u).set1x(f).set1x(l).set2x(p),e.content=d,this.sendMsg(e,e.content)},r.prototype.smallNightPreview=function(e){var t=e.light,n=t.operationCode,r=t.BRI,a=t.r,i=t.g,s=t.b,c=t.w;e.frameType=o.a.FrameType.Request,e.msgType=5137;var u=new ArrayBuffer(6);new DataView(u).set1x(n).set1x(r).set1x(a).set1x(i).set1x(s).set1x(c),e.content=u,this.sendMsg(e,e.content)},r.prototype.alarmConfig=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5130;var t=e.alarms,n=t?t.length:0,r=new ArrayBuffer(26*n+1),a=new DataView(r);a.set1x(n);for(var i=0;i<n;i++){var s=t[i],c=s.isNeedLightAwake?s.lightIntensity:0;a.set8x(s.seqid).set1x(s.isOpen).set1x(s.smartFlag).set1x(s.smartOffset).set1x(s.hour).set1x(s.minute).set1x(s.weekday).set1x(s.cycle).set1x(s.lazy).set1x(s.volum).set1x(c).set2x(s.musicSeqid).set4x(s.updateTimeStamp||parseInt((new Date).valueOf()/1e3)).set2x(s.duration)}e.content=r,this.sendMsg(e,e.content)},r.prototype.getAlarmConfig=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5131,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var i=a(n,e.deviceType);e.handler&&e.handler(t,i)}else e.handler&&e.handler(t)})},r.prototype.getWorkMode=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5132,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==o.a.RET.Succeed){var a=c.a.workModeParse(n,e.deviceType);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.setCenterBtnConfig=function(e){var t=e.operationCode;e.frameType=o.a.FrameType.Request,e.msgType=5133;var n=new ArrayBuffer(1);new DataView(n).set1x(t),e.content=n,this.sendMsg(e,e.content)},r.prototype.getCenterBtnConfig=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5134,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n){if(t==o.a.RET.Succeed){var r=n.get1x();e.handler&&e.handler(t,{mode:r})}else e.handler&&e.handler(t,n)})},r.prototype.alarmPreview=function(e){var t=e.operationCode,n=e.BRI,r=e.musicId,a=e.volume;e.frameType=o.a.FrameType.Request,e.msgType=5135;var i=new ArrayBuffer(5);new DataView(i).set1x(t).set1x(n).set2x(r).set1x(a),e.content=i,this.sendMsg(e,e.content)},r.prototype.restoreFactorySetting=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5156,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content)},r.prototype.setSystemSwitch=function(e){var t=e.wifi,n=e.timeMode,r=e.timeSync;e.frameType=o.a.FrameType.Request,e.msgType=5159;var a=new ArrayBuffer(10);new DataView(a).set1x().set1x(t).set1x(n).set1x(r),e.content=a,this.sendMsg(e,e.content)},r.prototype.getSystemSwitch=function(e){e.frameType=o.a.FrameType.Request,e.msgType=5160;var t=new ArrayBuffer(0);e.content=t,this.sendMsg(e,e.content,function(t,n){if(t==o.a.RET.Succeed){n.get1x();var r=n.get1x(),a=n.get1x(),i=n.get1x();e.handler&&e.handler(t,{wifi:r,timeMode:a,timeSync:i})}else e.handler&&e.handler(t,n)})},r.prototype.musicPreview=function(e){var t=e.operationCode,n=e.musicId,r=e.volume;e.frameType=o.a.FrameType.Request,e.msgType=5170;var a=new ArrayBuffer(4);new DataView(a).set1x(t).set2x(n).set1x(r),e.content=a,this.sendMsg(e,e.content)},r.prototype.registerWorkModeCallback=function(e,t,n){return t=void 0==t?this.deviceType:t,this.socketClient.onPostMsg(5132,function(r,a,i){var o=new DataView(r),s=c.a.workModeParse(o,t);n&&Object(l.c)(n)!==i||e&&e(s,i)})},r.prototype.unregisterWorkModeCallback=function(e){this.socketClient.removePostMsgListener(5132,e)}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.DEVICE_TYPE.DEVICE_TYPE_EW202W,n=e.conf.ip+"_"+e.conf.port+"_"+t;if(g[n]){var r=g[n];return r.socketClient=e,r}g[n]=this,this.socketClient=e,this.protocol=new l.b,e.setProtocol(this.protocol),this.deviceType=t,this.deviceId=null}function a(e){var t=new DataView(new ArrayBuffer(18));return t.set1x(e.alarmId),t.set1x(e.alarmFlag),t.set1x(e.smartFlag),t.set1x(e.smartOffset),t.set1x(e.hour),t.set1x(e.minute),t.set1x(e.week),t.set1x(e.lazyCount),t.set1x(e.lazyTime),t.set1x(e.volume),t.set1x(e.brightness),t.set2x(e.musicId),t.set4x(e.timestamp),t.set1x(e.isValid),t.buffer}function i(e,t){for(var n=e.get1x(1),r=[],a=0;a<n;a++){var i=e.buffer.slice(e.position,e.position+=18),o=new DataView(i),s={alarmId:o.get1x(1),alarmFlag:o.get1x(1),smartFlag:o.get1x(1),smartOffset:o.get1x(1),hour:o.get1x(1),minute:o.get1x(1),week:o.get1x(1),lazyCount:o.get1x(1),lazyTime:o.get1x(1),volume:o.get1x(1),brightness:o.get1x(1),musicId:o.get2x(1),timestamp:o.get4x(1),isValid:o.get1x(1)};(s.isValid||0==s.alarmId)&&r.push(s)}return r}function o(e){var t={};return t.configMode=e.get1x(1),t.lightStatus=e.get1x(1),t.lightBrightness=e.get1x(1),t.colorId=e.get1x(1),t.colorR=e.get1x(1),t.colorG=e.get1x(1),t.colorB=e.get1x(1),t.colorW=e.get1x(1),t.alarmStatus=e.get1x(1),t.alarmFlag=e.get1x(1),t.timeMode=e.get1x(1),t.pincode=e.get1x(1),t.systemBluetooth=e.get1x(1),t.syncTimeFlag=e.get1x(1),t.sleepAidStatus=e.get1x(1),t.sleepAidLightStatus=e.get1x(1),t.sleepAidMusicStatus=e.get1x(1),t.sleepAidMusicID=e.get2x(1),t.sleepAidLeftTime=e.get1x(1),t.channelId=e.get4x(1),t}Object.defineProperty(t,"__esModule",{value:!0}),t.EW202WTcpApi=r;var s=n(5),c=n(3),u=n(0),f=n(2),l=n(10),p=n(1),d="EW202WTcpApi",g={};r.prototype=new s.SocketClientApi2,r.prototype.sendMsg=function(e,t,n){e.deviceType=e.deviceType||this.deviceType,e.networkDeviceId=e.networkDeviceId||this.deviceId,e.subVersion=null==e.subVersion?0:e.subVersion,s.SocketClientApi2.prototype.sendMsg.call(this,e,t,n)},r.prototype.retSystemInfo=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=5399,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(d,"retSystemInfo",e)}},r.prototype.setSystemConfigInfo=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=5400;var t=new DataView(new ArrayBuffer(20));t.set1x(e.timeMode),t.set1x(e.syncTimeFlag),t.set1x(e.bleFlag),t.set1x(e.pinCodeFlag),t.setStr(e.pinCode,16),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})}catch(e){f.log.i(d,"setSystemConfigInfo",e)}},r.prototype.getSystemConfigInfo=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=5401;var t=new DataView(new ArrayBuffer(0));e.content=t.buffer,console.log("EW202WTcpApi ----- ",e),this.sendMsg(e,e.content,function(t,n,r){if(console.log("EW202WTcpApi ----- back",t,n),t==c.a.RET.Succeed){var a={};a.timeMode=n.get1x(1),a.syncTimeFlag=n.get1x(1),a.bleFlag=n.get1x(1),a.pinCodeFlag=n.get1x(1);var i=n.buffer;e.pinCode=p.default.ab2string(i.slice(4,19)),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})}catch(e){f.log.i(d,"getSystemConfigInfo",e)}},r.prototype.colockConfig=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5395,e.content=a(e),this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})},r.prototype.getClockConfig=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5396,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a=i(n,e.deviceType);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.configureTimeDormantInfo=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5402;var t=new DataView(new ArrayBuffer(5));t.set1x(e.sleepFlag),t.set1x(e.startHour),t.set1x(e.startMinute),t.set1x(e.endHour),t.set1x(e.endMinute),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){c.a.RET.Succeed,e.handler&&e.handler(t)})},r.prototype.getTimeDormantInfo=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5403,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a={};a.sleepFlag=n.get1x(DataView.NO_SIGNED),a.startHour=n.get1x(DataView.NO_SIGNED),a.startMinute=n.get1x(DataView.NO_SIGNED),a.endHour=n.get1x(DataView.NO_SIGNED),a.endMinute=n.get1x(DataView.NO_SIGNED),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.asistSleepOperation=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5392;var t=new DataView(new ArrayBuffer(14));t.set1x(e.musicSwitch),t.set2x(e.musicId),t.set1x(e.volume),t.set1x(e.circle),t.set1x(e.lightSwitch),t.set1x(e.brightness),t.set1x(e.colorR),t.set1x(e.colorG),t.set1x(e.colorB),t.set1x(e.colorW),t.set1x(e.smartFlag),t.set2x(e.aidingTime),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler(t)})},r.prototype.getAsistConfig=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5393,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a={};a.musicSwitch=n.get1x(DataView.NO_SIGNED),a.musicId=n.get2x(DataView.NO_SIGNED),a.volume=n.get1x(DataView.NO_SIGNED),a.circle=n.get1x(DataView.NO_SIGNED),a.lightSwitch=n.get1x(DataView.NO_SIGNED),a.brightness=n.get1x(DataView.NO_SIGNED),a.colorR=n.get1x(DataView.NO_SIGNED),a.colorG=n.get1x(DataView.NO_SIGNED),a.colorB=n.get1x(DataView.NO_SIGNED),a.colorW=n.get1x(DataView.NO_SIGNED),a.smartFlag=n.get1x(DataView.NO_SIGNED),a.aidingTime=n.get2x(DataView.NO_SIGNED),e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.lightSwitchOpertaion=function(e){try{e.frameType=c.a.FrameType.Request,e.msgType=5394,e.deviceType=e.deviceType||u.DEVICE_TYPE.DEVICE_TYPE_EW202W,e.subVersion=0;var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set1x(Math.min(e.brightness,100)),t.set1x(e.colorId),t.set1x(e.colorR),t.set1x(e.colorG),t.set1x(e.colorB),t.set1x(e.colorW),t.set2x(e.stopTime),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler(t)})}catch(e){}},r.prototype.musicOperation=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5398;var t=new DataView(new ArrayBuffer(4));t.set1x(e.operation),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler(t)})},r.prototype.alarmPreviewOperation=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5397;var t=new DataView(new ArrayBuffer(5));t.set1x(e.operation),t.set1x(e.brightness),t.set2x(e.musicId),t.set1x(e.volume),e.content=t.buffer,this.sendMsg(e,e.content,function(t,n,r){e.handler&&e.handler(t)})},r.prototype.queryWorkMode=function(e){e.frameType=c.a.FrameType.Request,e.msgType=5424,e.content=new ArrayBuffer(0),this.sendMsg(e,e.content,function(t,n,r){if(t==c.a.RET.Succeed){var a=o(n);e.handler&&e.handler(t,a)}else e.handler&&e.handler(t)})},r.prototype.registerWorkModeCallback=function(e,t,n){return t=void 0==t?this.deviceType:t,this.socketClient.onPostMsg(5424,function(t,r,a){var i=new DataView(t),s=o(i);n&&Object(l.c)(n)!==a||e&&e(s,a)})},r.prototype.unregisterWorkModeCallback=function(e){this.socketClient.removePostMsgListener(5424,e)}}])});